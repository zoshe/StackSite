<html>
<head>
<meta charset="UTF-8">
<title>wuiV004</title> 
<!-- Build changes:  building the photo library

-->

<!-- NOTES:
1. wui0259 was the last good build with all the ftns intake.
If a ftn is missing fron here on out, then check the wui0259 build in the floater folders.
2. navigator.userAgent
a. DW4 uses safari: Mozilla/5.0 (Macintosh; U; Intel Mac OS X; en_US) AppleWebKit/522.7 (KHTML, like Gecko) Dreamweaver/10.0.0.4117 Version/3.0 Safari/522.7
b. DW5 uses safari: Mozilla/5.0 (Macintosh; U; Intel Mac OS X; en_US) AppleWebKit/525.27.1 (KHTML, like Gecko) Dreamweaver/11.0.0.4736 Version/3.2.1 Safari/525.27.1
-->

<!-- THINGS TO DO:
1. (OPEN) display: -icab-box there seems to be a blank space between : - on some css, and it will need to be fixed so it writes the css so it does not have this blank space.
2. (OPEN) the dwFileListFolder function needs to be fixed, it should return an blank array if nothing is found, or when the folder does not exist.
3. (OPEN) getZFormSelectElm functions and others like it, should just pass in the object. Then the ftn can test if it's xml or a dom object. A ftn to get the object will be needed so other functions can call it. ie:
function getZFormSelectElm() needs to change to this getZFormSelectElm(element){ basically no more passing in the cat1 and id argarments. Actually, I think it's time to also call "ZForm" "zTool"
4. (OPEN) Maybe getZFormSelectElm() should be called getHtmlElementInE4xStuffForSelect(){}
5. (Done) the getZFormSelectElm and other ftns like it, return the array has logFtn in it. Does it need to be in it, or should they all just return the array all the time. I'm thinking these type of ftns should always return the array.
6. (OPEN) adding a frame buster to prevent click jacking maybe a good thing to add to stacksite framework for sites. It be added as a tool to the window element prop section(WPN) this script of code might work, but may need to research it to see if it really does.  (function( top ){ while( top !== top.top ){ top = top.top; } if (top !== self) top.location.replace( self.location.href ); })( this );
7. (Closed) Truefully, my trim function is already fast, and regEx is slower) on the remove trim function, it maybe faster to use regEx, like this return str.replace(/^\s\s*/, '').replace(/\s\s*$/, ''); More info can be found here at http://blog.stevenlevithan.com/archives/faster-trim-javascript it cover how trimming works.
8. (OPEN) All ftns should use and put an array at the top of ever ftn. this ftn can be past to the log ftn, which creates a dumpfile, of the ftns decriptions and so on. It can still be commented out, but it could pass the comment into it, and run a eval code, to pull it out of there. Then create the HTML files, giving the decription of each ftns.
9. (OPEN) The ftns to get tree info and all other info should use a json markUp or I should break up the call to select like I did for contacts on websites.
10. (OPEN) wdn and other ftns use a flush so it can use e4x if it's ill formed. I was thinking to make it lower cases but this is wrong.
11. (OPEN) on lengths, should try and use >>> . ie var len = array.length >>> 0; // will need testing
12. (OPEN) time to remove the bottom JS on each page. This is the JS loader 2 script. 
13. (OPEN) could be better to create radom numbers this way Math.floor( Math.random() * 0xffffff ).toString( 16 ) );
14. (OPEN) if (arguments.callee.done) return; this seem to tell if a ftn has been called already. Needs checking.
15. (Closed) It did not work, and this seem to only work with some browsers. On setTimeOut functions, all need to check if it can pass the third attribute to the next call, ie setTimeOut("set",20,atrib1,atrib2,atrib3) It maybe able to pass a object this wy too. If that is the case then this could work on the build wui script too. All needs testing.
-->

<!-- ZOSHE CONFIDENTIAL
 ___________________

*  Copyright 2008 Zoshe.net
*  All Rights Reserved.
*
* NOTICE: All information contained herein is, and remains
* the property of Zoshe.net and its suppliers,
* if any. The intellectual and technical concepts contained
* herein are proprietary to Zoshe.net and its
* suppliers and may be covered by U.S. and Foreign Patents,
* patents in process, and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Zoshe.net.
*
* 
* 
*
**************************************************************************
-->
<!--
<style>
body { padding: 0px; border: 0px; margin: 0px}
table{}
td{padding:0px;margin:0px;border:0px;vertical-align:center} 
</style>
-->
<script language="JavaScript">

// isAvailableInCodeView may or may not be needed. Leaving it here, just in case.
//function isAvailableInCodeView(){return true;}// allows floater in both view and design screen

//gobal Elements and vars ########################
XML.prettyPrinting = false;
//XML.ignoreWhitespace = false;
var browserLastCtg = "sdn";
var browserRefreshOn = true;
 // I put controlBrowserOn bc DW seems to crash a lot. This turns the element off, so I can get some work done, and until I can figure out the bug causing it.
var controlBrowserOn = true;
var colsNeedUpdating = false; // this lets current updating function know current tree colmuns need updating
var functionIsRunning = false;
var logChangeOn = true;
var logErrOn = false;
var logErrorReported = false;
var logFileNum = 0;
var logFtnOn = false; //this will be a setting that can be changed from the user
var logUserType = 1; // 1=developer, 2=betaTester, 3=endUser
var upDateValues = [0,0,0,0,0,0];//FliesUpdateNumber // 4=layout,5=snipit,6=menu,7=script,8=art
var firedElm ={id: false,hashVal:false,tagName:false,};
var writeTestingPageIsOn = true;
var writeCompilePageIsOn = true;
var siteNotNewerThenProgram = true; // this should be moved into the function somehow
var siteRoot = false; // this should be called sitePath
var stackRoot = false; // this should be called stackPath
var dwApp = {};
//• changedFiles was creates to keep track of all file URLs being rewritten.
//NOTE : changedFiles not in use anymore, it can be removed from the code everywhere  
// It was necessary because, dreamweaver will not reload any related files
// open in a tab will not unless the file is written into dom, and saved.
// THe changedFiles array does get cleard everytime a function is first runned.
var changedFiles = [];
//var sss;

const wui={
version:1.00,
versionName:"wuiV004",
versionSiteName:"StackSiteV004",
configpath:dw.getUserConfigurationPath(),
path:dw.getUserConfigurationPath()+"Floaters/wuiV004/",
logs:dw.getUserConfigurationPath()+"Floaters/wuiV004/Logs/",
ssFileCode:dw.getUserConfigurationPath()+"Floaters/wuiV004/StackSiteFileCodes/",
};



function add_DN(ctg,useSelNodeId,useTypeNum){
// so far BDN JDN NDN TDN r using this function
if(!catg[ctg.pF]){return logError(new Error());}
var logFtn=LogFtn(new Error(),1,1,1,-1);
var isFtnCalledByItSelf = logFtn.ftnName == logFtn.ftnRunName;
var dn = getTree(ctg,useSelNodeId);
var dnNum= "";
var dnFolder = getPathInSS(ctg.a);
var dnTypeNum = useTypeNum || getZFormSelectElm(ctg.a,ctg.pF+"AddElm").selNodeValue;
var dnLib = getLibNode(ctg,dnTypeNum);

//catch any error, this line is for development and can be removed on final build
if(!dnTypeNum || logErrorReported){return false;}

//jdn scripts: if this selNode uses any js, then add and update those nodes too.
for each(var uScript in dnLib.uScripts){//for3
add_DN(catg.jdn,"jdn"+uScript,uScript);
}//for3

// if the Jdn Node being added already exist , then raise it's in use qty up one and return true
if(ctg.pF == "jdn" && useSelNodeId && useTypeNum && dn.hasSelNode && dn.selNode){
var dnAddNodeInUseQty = parseInt(dn.selNode.@in_use_qty);
dn.selNode.@in_use_qty = (dnAddNodeInUseQty)? dnAddNodeInUseQty + 1 : 1;
return treeColNeedsUpdate() && updateTree("jdn") && LogFtnReturn(logFtn);
}

//if this node has no desendants or no more scripts to add, then start the process of adding this node  

// off bc I don't want it to over write any changes I make to the script in the current stacksite folder
// for now, it only adds to the inuseqty if the node exist
// this is only here to help with coding
// this prevent js file from being added or overwritten in the j folder
// and other nodes too.
if(ctg.pF=="jdn"){
return true;
}

// set and find a avalible folder number and set the dnNum
if(ctg.a=="j"){//jdn folder number uses the unique dnTypeNum
dnNum = dnTypeNum;
}
else{//if1 everything else
var dnFolders = dwFileExist(dnFolder) && dwFileListFolder(dnFolder,"directorys");
var dnFoldersLength = dnFolders && dnFolders.length+1 || 1;
dnNum= 1;
for(var i=1;i<=dnFoldersLength;i++){//for1
if(!dwFileExist(dnFolder+i)){
dnNum = i;
break;
}
}//ENDfor1
}


//set nLink
var dnLink = dnLib.nLink && "stacksite/"+ctg.a+"/"+ dnNum+"/"+dnLib.nLink || "";

// add a new node
var newNode = createTreeNode();
newNode.@id = (ctg.a=="j")? ctg.pF+ dnTypeNum : ctg.pF+ dnNum;
newNode.@n_num = dnNum;
newNode.@n_link = dnLink;
//0191 newNode.nSearch=dnTypeNum+".1a"+dnNum+"b0c&";
newNode.@n_name = dnLib.dName + dnNum;
newNode.@n_version = .01;
newNode.@n_type_name = notBlank(dnLib.tyNme) || "";//NN
newNode.@n_type_description =  notBlank(dnLib.tyDes) || "" ;//NN
newNode.@n_type_num = dnTypeNum;
newNode.@in_use_qty = useTypeNum && 1 || 0;
newNode.@hash_val = dnLib.hashVal;
//0199* newNode.value = newNode.@n_name+"|"+newNode.@n_type_name +": "+newNode.in_use_qty;

//if node being added is in a tree, which is currently visible in the toolpanel
// then set the selected treenode to the newly added treenode
// this "if" may need to test for !isFtnCalledByItSelf or isFtnCalledByItSelf not sure
if(ctg.a == getVformMmSelectElm().value){
(dn.hasSelNode)? delete dn.selNode.@selected : null;
newNode.@selected = true;
}

//if tree has no treenode then append the newNode
if(!dn.hasNodes){//if1
dn.control.appendChild(newNode);
}//if1
// else it has nodes then then find the place to insert it
else if(dn.hasNodes){//else2
for each(var node in dn.control.zztreenode){//for2
// insert before node
if(node.@n_name > newNode.@n_name){
dn.control.insertChildBefore(node,newNode);
break;
}
// insert after node
else if(node.@n_name <= newNode.@n_name){
dn.control.insertChildAfter(node,newNode);
break;
}
}//for1
}//else2

var runFns = save_DN(ctg,newNode.@id) && treeColNeedsUpdate() && updateTree(ctg.pF);
return runFns && LogFtnReturn(logFtn);
}

function addBDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns= add_DN(ctg) && setBLN() && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function addBLN(ctg){
// needs work
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = false;
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function addJDN(ctg){
// this is off until I get the scripts being added r correct I do not want to over write the scripts until they r ready
// I believe I'm working, changing and improving jdn scripts from the stacksite folder , not the stacksite code file
// not the code files, but I could be wrong
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
return true;
var runFns=add_DN(ctg)&&dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function addNDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns= add_DN(ctg) && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function addTDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns= add_DN(ctg) && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function addWDN(ctg){
// adds a item to the selected node sub top
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var dn = getTree(ctg);
// var de = getZFormElms(ctg);
dn.addNodeLib = getLibNode(ctg,getZFormSelectElm(ctg.a,ctg.pF+"AddElm").selNodeValue);
var isNewPage = dn.addNodeLib.itemCatagory == "page";
var isNewLink = dn.addNodeLib.itemCatagory  == "link";
var putItHere = getZFormTagNameById(ctg.a,"wdnTd4","td");

// if it's changing the addmenu to something else and it exist, remove it
var dnAddWizTable = putItHere.table.length()>0&& putItHere.table(@id == "wdnAddWizTable")[0] || false;
if(!dnAddWizTable){
delete dnAddWizTable;
}

//close the following trees
if(isNewPage){//ifX
changeZFormElmCSS("w","table","wlnTable1",0,"display","none");
changeZFormElmCSS("w","table","wlnTable2",0,"display","none");
changeZFormElmCSS("w","table","wpnTable1",0,"display","none");
changeZFormElmCSS("w","table","wpnTable2",0,"display","none");
}//ifX

//build tree to display what folder to put it in 
if(isNewPage){//ifX

var newTree = createTreeControl();
newTree.@id = "wdfTreeElm";
newTree.@style = "width:375px;height:200px";
// newTree.@onChange = "wdfOnChange()"; // not using //
// newTree.@onChange = "runFnctn(this,'wdn','wdfOnChange')"; // not using //
newTree.@noheaders = "noheaders";
newTree.@n_name = "";

newColumn = createTreeColumn();
newColumn.@id = "wdfColumn1";
newColumn.@state = "visible";
newColumn.@value = zLang. _PleaseSelectAFolderToPlaceNewPageIn;
newTree.appendChild(newColumn);
newTree.appendChild(getTreeNodeFileList(siteRoot,"directorys","Site"));
}//ifX

//create the new file field // this should be called newInputFolderPageName
if(isNewPage || isNewDupOfPage){//ifX
var newInputFileName = createInp();
newInputFileName.@type = "text";
newInputFileName.@id = "wdnAddFolderNameElm";
newInputFileName.@size = "25px";
newInputFileName.@value = " ";
}//ifX

//create a file type select menu
//MAYBE NEEDED might want to make it so dup can change the file type
if(isNewPage){//ifX //new page
//NOTE SURE WHAT I"LL BE DOING HERE
var newSelectFileType = createSel();
newSelectFileType.@id = "wdnAddFileTypeElm";
//newSelectFileType.setAttribute("onChange","runFnctn(this,'"+eTag.eFN+")");
//create the Options
var newOption = createOptn();
newOption.@selected = true;
newOption.@value = dn.addNodeLib.nLink; 
newOption.text()[0] = dn.addNodeLib.nLink;
newSelectFileType.appendChild(newOption);
}//if1

//create a input field for menuName
if(isNewPage || isNewDupOfPage){//ifX
var newInputMenuName = createInp();
newInputMenuName.@type = "text";
newInputMenuName.@id = "wdnAddMenuNameElm";
newInputMenuName.@size = "25px";
newInputMenuName.@value = dn.addNodeLib.dName;
}//ifX
if(isNewPage || isNewDupOfPage){//ifX
//create a input button for cancel
var newInputCancelBtn = createInp();
newInputCancelBtn.@type = "button";
newInputCancelBtn.@id = "addWDNCancelBtnElm";
newInputCancelBtn.@onClick = "runFnctn(this,'wdn','addWDNCancelBtn')";
newInputCancelBtn.@value = zLang._Cancel;

//create a input button for Ok
var newInputOkBtn = createInp();
newInputOkBtn.@type = "button";
newInputOkBtn.@id = "addWDNOkBtnElm";
//newInputOkBtn.@onClick = "addWDNOkBtn('wdn')";
newInputOkBtn.@onClick = "runFnctn(this,'wdn','addWDNOkBtn')";
newInputOkBtn.@value = zLang._Ok;
}//ifX

if(isNewPage || isNewDupOfPage){//ifNewOfifDup "Put new Page in selected Folder"
var treeTop = (isNewPage)? "1. Select a Location for the New Page" : "1. Selected a Location for New Duplicate Page";

//create the new page input table 
var treeTop = "1. Select a Location for the New Page";
var text2 = "2. "+zLang._FolderName+":";
var text3 = "3. "+zLang._MenuName+":";

//create the new page input table 
var tdSty1 = "white-space:nowrap;text-align:left;vertical-align:center;width:100%";
var tdSty2 = "white-space:nowrap;text-align:left;vertical-align:center;width:1%";
var tdSty3 = "white-space:nowrap;text-align:left;vertical-align:center;width:99%";

var pgTable = <table id="wdnAddWizTable" style="width:100px"></table>;
pgTable.appendChild(<tr><td id="wdnAddWizTd1" colspan="2" style={tdSty1}>{treeTop}</td></tr>);
pgTable.appendChild(<tr><td id="wdnAddWizTd2" colspan="2" style={tdSty1}>{newTree}</td></tr>);
pgTable.appendChild(<tr><td id="wdnAddWizTd3" colspan="0" style={tdSty2}>{text2}</td><td id="wdnAddWizTd4" style={tdSty3}>{newInputFileName}/{newSelectFileType}</td></tr>);
pgTable.appendChild(<tr><td id="wdnAddWizTd5" colspan="0" style={tdSty2}>{text3}</td><td id="wdnAddWizTd6" style={tdSty3}>{newInputMenuName}</td></tr>);
pgTable.appendChild(<tr><td id="wdnAddWizTd7" colspan="2" style={tdSty1}>{newInputCancelBtn + newInputOkBtn}</td></tr>);
putItHere.appendChild(pgTable);
}// ifNew
var runFns = setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function addWDNCancelBtn(ctg){ // cancel wdn add
ctg = catg[ctg] || logError(new Error());
optMnuWDN(ctg.pF);
}

function addWDNOkBtn(ctg){
// Adds a new Page to the website
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wdn = getTree(ctg);

// new webpage file stuff needed
var wdfMenuName = "";
var wdfFolderURL = ""; // this is the folders path inbetween the site folder and the new page folder ie XX/XXX
var wdfFolderName = ""; // the name of the new folder which will hold the new page ie XXX
var wdfURL = ""; // the site folder to  the new file name file://XXX/XX/XXX/XXX/index.html
var wdfRelativeLinks = ""; // relative link // used for the javascript links ../ or blank or ../../and as many as it will need
var wdfRelativeURL = ""; // the relative link use in the menu files and also when opening it in a browsers hh/index.html or ../hh/index.html
var tdnNum = "";
var tdnName = " ";
var folderUrl = "";
// the add type
//var addTypeElm =  getZFormSelectElm(ctg.a,ctg.pF+"AddElm");

var wdnTypeNum = getZFormSelectElm(ctg.a,ctg.pF+"AddElm").selNodeValue;
wdn.addNodeLib = getLibNode(ctg,wdnTypeNum);
var isNewPage = wdn.addNodeLib.itemCatagory == "page";
var isNewLink = wdn.addNodeLib.itemCatagory  == "link";

// set file link info
if(isNewPage){
var wdfFolderNameElm = getZFormInputTextElm(ctg.a,"wdnAddFolderNameElm");
wdfFolderName = !wdfFolderNameElm.nodeValueIsBlank && removeBlankSpaces(wdfFolderNameElm.nodeValue);
var wdfMenuNameElm = getZFormInputTextElm(ctg.a,"wdnAddMenuNameElm");
wdfMenuName = !wdfMenuNameElm.nodeValueIsBlank && wdfMenuNameElm.nodeValue || wdn.addNodeLib.dName;
var wdf = {};
wdf.control=zForm[ctg.a]..zztreecontrol.(@id=="wdfTreeElm")[0] || false;//works
wdf.hasNodes = wdf.control.zztreenode[0] && true || false;
wdf.selNode = wdf.hasNodes && getEx4ElmByAttribName(wdf.control..zztreenode,"selected");
var getUrl = parseLocalFolderURL(wdf.selNode && wdf.selNode.@url || siteRoot);
wdfFolderURL =  (wdfFolderName)? getUrl.filePath +"/" + wdfFolderName : getUrl.filePath;
wdfURL =  wdfFolderURL + "/" + wdn.addNodeLib.nLink;
wdfRelativeURL=(wdfFolderName)?getUrl.relativeLinkAll+wdfFolderName+"/"+wdn.addNodeLib.nLink: wdn.addNodeLib.nLink;
wdfRelativeLinks= (wdfFolderName)? "../" + getUrl.relativeLinkAll : "";
}
else{//newLink

}

// check selected folder is not blank and if it's URL is already taken
if(isNewPage || isNewLink){//ifX
if(!wdfFolderName){//ifX1
alert("On line 2. The Folder name field is blank. Please enter a folder name.");
return LogFtnReturn(logFtn) && setVForm("wdn",0);
}//ifX1
else if(dwFileExist(wdfFolderURL)){//ifX1
alert("On line 2. The folder name " +wdfFolderName+ " already exist. Please change the folder name to something else");
return LogFtnReturn(logFtn) && setVForm("wdn",0);
}//ifX1
}//ifX

// find an avalible folder number
if(isNewPage || isNewLink){//ifX
var dnFolder = getPathInSS(ctg.a);
var dnFolders = dwFileExist(dnFolder) && dwFileListFolder(dnFolder,"directorys");
var dnFoldersLength = dnFolders && dnFolders.length+1 || 1;
var dnNum= 1;
for(var i=1;i<=dnFoldersLength;i++){//for1
if(!dwFileExist(dnFolder+i)){
dnNum = i;
break;
}
}//for1
}//ifX

// add a new node
if(isNewPage || isNewLink){//if1
var newNode = createTreeNode();
newNode.@id = ctg.pF+ dnNum;
newNode.@n_num = dnNum;
newNode.@n_link = (isBlank(wdn.addNodeLib.nLink))? "" :  wdfRelativeURL;
//0191 newNode.nSearch=dnTypeNum+".1a"+dnNum+"b0c&";
newNode.@n_name=(wdfMenuName!=wdn.addNodeLib.dName)?wdfMenuName:wdfMenuName+""+dnNum;
newNode.@n_version = .01;
newNode.@n_type_name = wdn.addNodeLib.tyNme;//NN
newNode.@n_type_description =  wdn.addNodeLib.tyDes || "";//NN
newNode.@n_type_num = wdnTypeNum;
newNode.@n_type_num_sub = " ";// sub type not in use yet.
newNode.@tdn_num = notBlank(tdnNum) || " ";//must have a space for the later
newNode.@tdn_name = notBlank(tdnNum) && notBlank(tdnName) || " "; // most have a space
newNode.@state = "collapsed";
newNode.@hash_val = wdn.addNodeLib.hashVal;
//newNode.@value = newNode.@n_name+"|"+ newNode.@n_type_name +": "+newNode.@n_type_description;
//newNode.inUseQty = 0;
}//if1

//set script node inuseQty up one if it exist, if script is missing and doesn't exist then it will be added it.
for each(var uScript in wdn.addNodeLib.uScripts){//for3
add_DN(catg.jdn,"jdn"+uScript,uScript);
}//for3

//set layouts and it's inUseQty
if(notBlank(tdnNum)){//if1
var tdnNums = getStringArraySplit(tdnNum,"-");
for each(var layout in tdnNums){//for3
add_DN(catg.tdn,"tdn"+layout,layout);
}//for3
}//if1

var dnFilesWritten = true;

//Write newPage
if(isNewPage){//if1 
var codeFolder = wui.ssFileCode;
var kFile = DWfile.read(codeFolder+ctg.pF+"q"+wdnTypeNum+"/"+"k.js");
dnFilesWritten = DWfile.write(wdfURL,eval(kFile)) || false;
}//if1
// add node to tree and set selected on treenode
if(!logErrorReported && dnFilesWritten){//if1
(wdn.hasSelNode)? delete wdn.selNode.@selected : null;
newNode.@selected = true;
(wdn.hasSelNode)?wdn.selNode.parent().insertChildAfter(wdn.selNode,newNode) : wdn.control.appendChild(newNode);
var runFns=treeColNeedsUpdate()&&updateTree(ctg.pF)&&save_DN(ctg)&&saveMDNforWDN()&&setWLN();
// i think the optmenu can do this and the up date and reSetVForm01 too// maybe better to keep it here
if(runFns){//if2
changeZFormElmCSS("w","table","wlnTable1",0,"display","block");
changeZFormElmCSS("w","table","wlnTable2",0,"display","block");
changeZFormElmCSS("w","table","wpnTable1",0,"display","block");
changeZFormElmCSS("w","table","wpnTable2",0,"display","block");
return dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1) && LogFtnReturn(logFtn);
}//if2
else{
//NEEDs reason why it was cancel
alert(zLang._alert0001); // ("This operation has been canceled. Please try again.");
(dwFileExist(dnFolder+dnNum))? DWfile.remove(dnFolder+dnNum) : null;
(dwFileExist(wdfURL))? DWfile.remove(wdfURL) : null;
return setVForm(ctg.pF,1) && logError(new Error());
}
}//if1
else{// if it failed to add, then delete pages it created
//NEEDs reason why it was cancel
alert(zLang._alert0001); // ("This operation has been canceled. Please try again.");
(dwFileExist(dnFolder+dnNum))? DWfile.remove(dnFolder+dnNum) : null;
(dwFileExist(wdfFolderURL))? DWfile.remove(wdfFolderURL) : null;
return setVForm(ctg.pF,1) && logError(new Error());
}
}


function addWLN(ctg,useSelNodeId,useTypeNum){
// add a node to the layout
// note this ftn has a lot of code that will allow a item's useSelNodeId to be added from another ftn
// I'm not sure this will be needed, and the code can be taken out for it
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var isFtnCalledByItSelf = logFtn.ftnName == logFtn.ftnRunName;
var wln = getTree(ctg,useSelNodeId);
var wlnTypeNum = notBlank(useTypeNum) || getZFormSelectElm(ctg.a,ctg.pF+"AddElm").selNodeValue;
var wlnSubTypeNum = 0;
var wlnLib = getLibNode(ctg,wlnTypeNum); // may want to call it dn.addNodeLib
if(!wlnTypeNum || logErrorReported){return false;}

// create a new node
var newNode = createTreeNode();

//set the wgt selector attributes on the node being created
var i = 0;
for each(var wgtSelectorName in wlnLib.wgtSelectorNames){
newNode.@[wgtSelectorName] = wlnLib.wgtDefault0[i];
i++;
}

//set the css selector attributes on the node being created and add any default value for the item
i = 0;
for each(var cssSelectorName in wlnLib.cssSelectorNames){
newNode.@["q"+cssSelectorName] = wlnLib.cssDefault0 && notBlank(wlnLib.cssDefault0[i]) || "";
i++;
}

//JS add any js needed to run this page item
for each(var uScript in wlnLib.uScripts){//for1
add_DN(catg.jdn,"jdn"+uScript,uScript);
}//for1

//Set other attributes needed
newNode.@css_selector_number = "new"; // will get set on the saving ftn below
newNode.@id= ctg.pF+Math.random().toString().replace(".","");
newNode.@elm_num= "new";
newNode.@state= "expanded";//only set to expanded bc it help me with testing// needs to go back to collapsed
newNode.@hash_val = wlnLib.hashVal;
newNode.@wpn_set_elm = wlnLib.wpnSetElm;
newNode.@n_name = wlnLib.vV;
newNode.@n_type_num = wlnTypeNum;
newNode.@sub_type_child_name=(notBlank(wlnLib.subTypeChildNames[wlnSubTypeNum]))?wlnLib.subTypeChildNames[wlnSubTypeNum]+" ": "";
newNode.@sub_type_name=(notBlank(wlnLib.subTypeNames[wlnSubTypeNum]))? wlnLib.subTypeNames[wlnSubTypeNum] : "";
// alert(wlnLib.subTypeChildNames[wlnSubTypeNum] +" ||| "+ newNode.@sub_type_child_name.toString().length);
//alert(wlnLib.subTypeNames[wlnSubTypeNum] +" ||| "+ newNode.@sub_type_name.toString().length);
// alert(wlnLib.subTypeNames[wlnSubTypeNum] +" ||| "+ wlnLib.subTypeNames[wlnSubTypeNum].length);
///////////////newNode.nOnOff = 1;

// if node being added is in a tree, which is currently visible in the toolpanel
// then set the selected treenode to the newly added treenode
if(ctg.a == getVformMmSelectElm().value){
newNode.@selected = true;
(wln.hasSelNode)? delete wln.selNode.@selected : null;
(wln.hasSelNode)? wln.selNode.@state="expanded" : null;
}

// if tree has no treenode then append the newNode to the treecontrol
if(!wln.hasNodes){//if1
wln.control.appendChild(newNode);
}//if1
// or if selected node has no children then append the newNode to the seleceted node 
else if(!!!wln.selNode.zztreenode[0]){//else1a
wln.selNode.appendChild(newNode);
}//else1a
// or if selected node has children then find the place to insert it
else{//else2
var newNodeSiblingIndex = parseInt( wlnLib.siblingIndex);
for each(var node in wln.selNode.zztreenode){//for2
var nodeLib = getLibNode(catg.wln,"",node.@hash_val);
var nodeIndexNumber = parseInt(nodeLib.siblingIndex);
var nextNode = wln.selNode*[node.childIndex( )+1] || false;
// continue loop
if(nextNode && newNodeSiblingIndex > nodeIndexNumber){
continue;
}
//or if newNodeSiblingIndex less <= newNodeSiblingIndex then insert newNode before node
else if(newNodeSiblingIndex <= nodeIndexNumber){
wln.selNode.insertChildBefore(node,newNode);
break;
}
//or if it has no next node then appendChild it to the end
else if(!nextNode){
wln.selNode.appendChild(newNode);
}
}//for1
}//else2

var runFns = saveWLN(ctg) && treeColNeedsUpdate() && updateTree(ctg.pF) && setWPN("wpn") && dwChangeFileInTab("wdn",false,false,true,false) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}


function delete_DN(ctg,useSelNodeId,ifInUseQtyIs0DeleteIt){
//Note needs to have Permanently|To Archive put in // I think it should just delete it all together when not in use
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
// find out if this ftn is being called by itself
var isFtnCalledByItSelf = logFtn.ftnName == logFtn.ftnRunName;
ifInUseQtyIs0DeleteIt = notBlank(ifInUseQtyIs0DeleteIt);
// if useSelNodeId has a value, then switch the dn.selNode to the useSelNodeId above
var dn = getTree(ctg,useSelNodeId);


//If this node does not exist, then stop here and return true
if(!dn.hasSelNode){//node 
alert(ctg.pF +":" +"dn.selNode" +" is Blank (this is for testing only)");
return LogFtnReturn(logFtn);
}

// if the selected treenode has any desendant treenodes, than delete them too
for each(var node in dn.selNode.zztreenode){
delete_DN(ctg.pF,node.@id);
}

//if this node has no desendants or no more to delete, then start the process of deleting this node  
var dnLib = getLibNode(ctg,dn.selNode.@n_type_num);
var dnFolder = getPathInSS(ctg.a);
var dnNum = dn.selNode.@n_num;
var hasBrowserUpDated = 0;
var noErrors = true;
//var dnInUse= (dn.inUseQty != 0)?confirm("Currently, this Item is being used in your site. Do U still want to delete it?") : true;

//alert("dn.selNode-0: " +dn.selNode.toXMLString());
var getInUseQty = parseInt(dn.selNode.@in_use_qty) || 0;
dn.selNode.@in_use_qty = getInUseQty =  (getInUseQty)? getInUseQty-1: 0;
//alert("dn.selNode-1: " +dn.selNode.toXMLString());

//if the item's in use qty is greater than 0, or the user is not asking to delete it
// don't delete it files below and return true
if(ctg.pF != "wdn"){
//alert("ifInUseQtyIs0DeleteIt: "+ ifInUseQtyIs0DeleteIt);
if(getInUseQty>0 || !ifInUseQtyIs0DeleteIt){
//alert("getInUseQty: "+ getInUseQty);
return LogFtnReturn(logFtn);
}
}

//MAYBE NEEDED
// if it's a wdn node check if any other menuItems R sharing the same page or link or etc
// if it is shared, just delete the menu Item and leave the rest in tack
//if(cat1 == "w"){
//}


//if it tdn and it uses any snipits, then delete and update those nodes too.
if(ctg.pF=="tdn"){
var ndns = getStringArraySplit(dn.selNode.@n_snipits,"-");
for each(var ndnNum in ndns){//for1
delete_DN("ndn","ndn"+ndnNum);
}//for1
}
//if wdn uses any layout, then delete and update those nodes too.
else if(ctg.pF=="wdn" && dn.selNode.@tdn_num){
delete_DN("tdn","tdn"+dn.selNode.@tdn_num);
treeColNeedsUpdate();
updateTree("tdn");
}

//jdn scripts: if this selNode uses any js, then delete and update those nodes too.
// off bc I don't want it removing any changes I make to the script in the current stacksite folder
// for now, it only subtracts from the inuseqty and does not updateTree
for each(var uScript in dnLib.uScripts){//for3
delete_DN("jdn","jdn"+uScript);
//OFF delete_DN("jdn","jdn"+uScript);treeColNeedsUpdate();updateTree("jdn");
}//for3

// this is only here to help with coding
// this prevent js file from being deleted from the j folder
// and other nodes too.
if(ctg.pF=="jdn"){
return true;
}

// deletes the node and any accosiated files that need to be deleted
// find any file and folder URLs which need to be deleted
var delURLs = [];
//NOTE jdn IS OUT so I don't lose the work, need to go in on final build
// usally files in the stacksite folder
if(ctg.pF=="bdn"||ctg.pF=="mdn"||ctg.pF=="ndn"||ctg.pF=="ndn"||ctg.pF=="tdn"||ctg.pF=="wdn"){
var folderFiles = dnFolder+dnNum && getFileListShifted(dnFolder+dnNum) || false;
(folderFiles && folderFiles.length>0)? delURLs = delURLs.concat(folderFiles) : null;
// (dnFolder+dnNum)? delURLs.push(getFileListShifted(dnFolder+dnNum)) : null;
}
// usally for the content page
if(ctg.pF=="wdn"){
var docURL= notBlank(dn.selNode.@n_link) && changeRelURLtoFileURL(dn.selNode.@n_link) || false;
(docURL && dwFileExist(docURL))? delURLs.push(docURL) : null;
var folderUrl = docURL && docURL.substring(siteRoot.length);
var slashIndex = folderUrl && folderUrl.indexOf("/index.");
folderUrl = (slashIndex && slashIndex>=0)? siteRoot+ folderUrl.substring(0,slashIndex+1)  : false;
(folderUrl && dwFileExist(folderUrl))? delURLs.push(folderUrl) : null;
}
// stacksite_snipit pages
if(ctg.pF=="ndn"){
var docURL= notBlank(dn.selNode.@n_link) && siteRoot+dn.selNode.@n_link || false;
(docURL && dwFileExist(docURL))? delURLs.push(docURL) : null;
}

// if a file to be deleted is opened in a tab, then save and close it. Then open what's needed in a tab
// if file or folder is something that should not be deleted, don't delete it, otherwise delete it
// NEEDED not sure if it needs to change the last_file will be needed here
for each(var delURL in delURLs){//for3
//alert("1. delURL:"+delURL);
if(isUrlOfUrlRoot(delURL)){continue;}
//alert("2. delURL:"+delURL);
for each(var doc in dreamweaver.getDocumentList()){//for4
//alert("1. doc.URL:"+doc.URL);
if(doc.URL == delURL){//if1SS
browserLastCtg = ctg.pF;
dn.control.@last_file= delURL;
dn.control.@last_search = "";
dn.control.@last_location ="";
dwChangeFileInTab(ctg.pF,false,"_messagePleaseWait",false,true);
hasBrowserUpDated++;
break; // i think this will end up needing to be continue
}//if1SS
}//for4
DWfile.remove(delURL);
}//for3

//if this node is the currently selected treenode do the following
if(dn.hasSelNode && !isFtnCalledByItSelf){//if1
dn = getTreeSelNodeSiblingsAndParent(ctg,dn);

delete dn.selNode.@selected;
// if a previous child exist, delete selected node and select the previous node
if(dn.selNodePreviousSibling && dn.selNodePreviousSibling.name() != "zztreecolumn"){
dn.selNodePreviousSibling.@selected = true;
}
// else if no previous child, but it has a next child, then delete selected node and select the next child node
else if(dn.selNodeNextSibling){
dn.selNodeNextSibling.@selected = true;
}
// else if it's the only child, then delete selected node and select the parent node if it's not a treecontrol
// this else if is not needed for snipit, I keep it here if I start to combine function with other trees
else if(dn.selNode.parent().name() != "zztreecontrol"){
dn.selNode.parent().@selected = true;
}
// else it has no nodes
else{
null;
}
}//if1

if(noErrors){//if1
// delete needs to be done the following way to work
delete dn.selNode.parent().*[dn.selNode.childIndex( )];
if(hasBrowserUpDated < 1){// not used, may use this if later
// not using the dwChangeFileInTab(ctg.pF,false,true) here no more. But might go back to using it some day. Needs thinking.
}
// set and update node maybe needed here
return LogFtnReturn(logFtn);
}//if1
return false;
}// end delete function

function deleteBDN(ctg,useSelNodeId){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = delete_DN(ctg.pF,false,true) && updateTree(ctg.pF) && setBLN() && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function deleteBLN(ctg,useSelNodeId){
//NEEDS WORK it has never been done
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = true;
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function deleteNDN(ctg,useSelNodeId){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = delete_DN(ctg.pF,false,true) && updateTree(ctg.pF) && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function deleteTDN(ctg,useSelNodeId){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = delete_DN(ctg.pF,false,true) && updateTree(ctg.pF) && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function deleteWDN(ctg,useSelNodeId){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns=delete_DN(ctg.pF)&&treeColNeedsUpdate()&&updateTree(ctg.pF)&&saveMDNforWDN()&&setWLN() && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function deleteWLN(ctg,useSelNodeId){ // delete a object from the layout 

var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wln = getTree(ctg,useSelNodeId);

// find out if this ftn is being called by itself
var isFtnCalledByItSelf = logFtn.ftnName == logFtn.ftnRunName;

//If this node does not exist, then stop here and return true
if(!wln.selNode){//node 
alert(ctg.pF +":" +"wln.selNode" +" is Blank (this is for testing only) the ftn's useSelNodeId is:"+useSelNodeId);
return LogFtnReturn(logFtn);
}

// if the selected treenode has any desendant treenodes, than delete them too
for each(var node in wln.selNode.zztreenode){
deleteWLN(ctg.pF,node.@id);
} 


//if this treenode has no desendants or no more to delete, then start the process of deleting this treenode  
var wlnLib = getLibNode(ctg,wln.selNode.@n_type_num);
var hasBrowserUpDated = 0;
var noErrors = true;

//jdn scripts: if this selNode uses any js, then delete and update those nodes too.
for each(var uScript in wlnLib.uScripts){//for3
delete_DN("jdn","jdn"+uScript,true);
}//for3


//if this node is the currently selected treenode do the following
if(wln.hasSelNode && !isFtnCalledByItSelf){//if1
wln = getTreeSelNodeSiblingsAndParent(ctg,wln);

delete wln.selNode.@selected;
// if a previous child exist, delete the selected node and select the previous node
if(wln.selNodePreviousSibling && wln.selNodePreviousSibling.name() != "zztreecolumn"){
wln.selNodePreviousSibling.@selected = true;
}
// else if no previous child, but it has a next child, then delete the selected node and select the next child node
else if(wln.selNodeNextSibling){
wln.selNodeNextSibling.@selected = true;
}
// else if it's the only child, then delete the selected node and select the parent node if it's not a treecontrol
else if(wln.selNodeParent.name() != "zztreecontrol"){
wln.selNodeParent.@selected = true;
}
// else it has no nodes
else{
null;
}
}//if1

// delete needs to be done the following way to work
wln = getTreeSelNodeSiblingsAndParent(ctg,wln);
delete wln.selNodeParent.*[wln.selNodeChildIndex];
if(noErrors && isFtnCalledByItSelf){//if1
var runFns = true;
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}
else if(noErrors){
var runFns = saveWLN(ctg) && treeColNeedsUpdate() && updateTree(ctg.pF) && setWPN("wpn") && dwChangeFileInTab("wdn",false,false,true,false) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}
return false;
}


function layoutWDN(ctg){
// NOTE maybe adding and deleting should be done by using the delete and add ftns which sends the node id 
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wdn = getTree(ctg);
var wdnLayoutSelect= getZFormSelectElm("w","wdnLayoutElm");
var tdn = getTree(catg.tdn,notBlank("tdn"+wdn.selNode.@tdn_num));

// subtrack the pervious tdn inUseQty if needed
if(tdn.hasSelNode){
var tdnSelNodeInUseQty = parseInt(tdn.selNode.@in_use_qty);
tdn.selNode.@in_use_qty = (tdnSelNodeInUseQty && tdnSelNodeInUseQty>0)?  tdnSelNodeInUseQty - 1 : 0;
}

// set layout attributes back to none
wdn.selNode.@tdn_num = " ";
wdn.selNode.@tdn_name = " ";

// add to the selected tdn inUseQty if needed
tdn = getTree(catg.tdn,"tdn"+wdnLayoutSelect.selNodeValue);

if(tdn.hasSelNode){
var tdnSelNodeInUseQty = parseInt(tdn.selNode.@in_use_qty);
tdn.selNode.@in_use_qty = (tdnSelNodeInUseQty && tdnSelNodeInUseQty>0)? tdnSelNodeInUseQty + 1 : 1;
wdn.selNode.@tdn_num = wdnLayoutSelect.selNodeValue;
wdn.selNode.@tdn_name = wdnLayoutSelect.selNodeText || " ";
}

var runFns = treeColNeedsUpdate() && updateTree("tdn") && treeColNeedsUpdate() && updateTree(ctg.pF) && save_DN(ctg) && setWLN() &&  dwChangeFileInTab(ctg.pF,false,false,true,true) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function loadProgram(){
logErrOn = logErrOn || getVformElmById("LogErrOverRideBtn").checked;
logFtnOn = logFtnOn || getVformElmById("LogFtnOverRideBtn").checked;

//logFtn must go here. Do not move it above the lines of code above in this ftn.
var logFtn=LogFtn(new Error(),1,1,1,-1,"loadProgram");

// Dreamweaver has a gobal varible called "app.". It works like its gobal varible "dreamweaver" and "dw", but this
// varible has some additional info. Basically, it holds info about DW version and other stuff. It seems now, "app."
// holds the same info as the "dw." and "dreamweaver." gobal varible.

//App Version Information
var dwAppVersion = dw.appVersion.split(" ");
dwApp.isWin = dw.versionPlatform == "Win32";
dwApp.isMac = !dwApp.isWin && dw.isOSX();
dwApp.lang = dwAppVersion[1].substring(1,dwAppVersion[1].lastIndexOf("]"));
dwApp.version = dwAppVersion[0];
dwApp.versionInt = parseInt(dwAppVersion[0]);
dwApp.versionName = dw.appName; // I don't think this will be needed but keeping it just in case.
dwApp.versionPlatform = dwAppVersion[2].substring(1,dwAppVersion[2].lastIndexOf(")"));
dwApp.systemScript = dw.systemScript;
   
//set attributes needed on the treecontrol elements
var zFormChars = ["b","i","j","m","n","p","s","t","w","z"];
var zFormNames = zHash.navNames;
for each(var char in zFormChars){//for1
var x = zForm[char];
x.@cat1 = char;
for each(var treeControl in x..zztreecontrol){//control
var  catId= treeControl.@cat_id;
treeControl.@onChange="runFnctn(this,'"+catId+"','onChange"+catId.toUpperCase()+"')";
treeControl.@n_type_num ="00"; // I don't think this is needed // but I'll keep it to keep logic. 
treeControl.@o_sel="0";// most be closed so it can show false
treeControl.@unclicked="0";
//treeControl.setName("mm:treecontrol"); // it works, but a nightmare, bc dw has limited XML ftns to mm namespace
}//control

//set attributes needed on the treecolumn elements
for each(var treecolumn in x..zztreecolumn){//column
treecolumn.@state ="visible";
treecolumn.@z="z";
}//column
//set attributes needed on the table elements
for each(var table in x..table){//table
table.@border ="0px";
table.@cellSpacing = "0px";
table.@cellPadding="0px";
}//table
}//for1

//set the menu bar option elements
// NOTE THIS WILL Probally get set in the updateTree() ftn when I get option elements built into the element libs
for each(var sel in zHash.nav){
var navSel = <select id={sel[1]+"mbOptMnuElm"}></select>;
navSel.@ctg_pf = sel[1]+"dn";
navSel.@onChange="runFnctn(this,'"+sel[1]+"dn','updateMM')";
for each(var opt in zHash.nav){
var newOpt = <option value={opt[1]}>{opt[0]}</option>;
if(sel[1] == opt[1]){
newOpt.@selected = true;
}
navSel.appendChild(newOpt);
}
zForm[sel[1]].*.(@id==sel[1]+"mbTable0")[0].tr.td[0].setChildren(navSel);
}

var runFns= setProgram();

if(runFns){
//alert(catg.sdn.a);
//could open something in a browser here. User may not like this but could make it a pref setting
setVForm("sdn",1);
//dwChangeFileInTab();
LogFtnReturn(logFtn);
}
else{
// could put up some message that the program failed to load and could
// present a button to refresh and a few other options like a help button
logError(new Error());
}
}

function moveWDNdown(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wdn = getTree(ctg);
wdn = getTreeSelNodeSiblingsAndParent(ctg,wdn);

// if treenode is not at the bottom, then move it down one
if(wdn.selNodeNextSibling){
wdn.selNodeParent.insertChildAfter(wdn.selNodeNextSibling,wdn.selNode.copy());
delete wdn.selNode.parent().*[wdn.selNodeChildIndex];
var runFns = saveMDNforWDN() && dwChangeFileInTab(ctg.pF,false,false,true,true) &&  setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}
return setVForm(ctg.pF,1) && LogFtnReturn(logFtn) || logError(new Error());

//writeTestingPage(true,"moveWDNdown.js","var x ="+wdn.control.toXMLString());
}

function moveWDNleft(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wdn = getTree(ctg);
wdn = getTreeSelNodeSiblingsAndParent(ctg,wdn);

// if selNode parent is not the treecontrol node move selected treeNode on top of it's parent node
if(wdn.selNodeParent.name()=="zztreenode"){
wdn.selNodeParent.parent().insertChildBefore(wdn.selNodeParent,wdn.selNode.copy());
// if selNode's parent is left with no treenodes and no blank space, then add
// a blank child text node to the parent to force the parent to have a end tag
(wdn.selNodeParent.*.length()>1)? null : wdn.selNodeParent.appendChild(" ");
delete wdn.selNodeParent.*[wdn.selNodeChildIndex];
var runFns = saveMDNforWDN() && dwChangeFileInTab(ctg.pF,false,false,true,true) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}
return setVForm(ctg.pF,1) && LogFtnReturn(logFtn) || logError(new Error());
}

function moveWDNright(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wdn = getTree(ctg);
wdn = getTreeSelNodeSiblingsAndParent(ctg,wdn);

// if next sibling treenode exist move selected node into it as the top child treenode
if(wdn.selNodeNextSibling){//if1
wdn.selNodeNextSibling.@state="expanded";
if(wdn.selNodeNextSibling.zztreenode[0]){
wdn.selNodeNextSibling.insertChildBefore(wdn.selNodeNextSibling.zztreenode[0],wdn.selNode.copy());
}
else{
wdn.selNodeNextSibling.appendChild(wdn.selNode.copy());
}
delete wdn.selNodeParent.*[wdn.selNodeChildIndex];
var runFns = saveMDNforWDN() && dwChangeFileInTab(ctg.pF,false,false,true,true) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}//if1
return setVForm(ctg.pF,1) && LogFtnReturn(logFtn) || logError(new Error());
}

function moveWDNup(ctg,useSelNodeId){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wdn = getTree(ctg,useSelNodeId);
wdn = getTreeSelNodeSiblingsAndParent(ctg,wdn);

// if selected node is not at the top, move it up one
if(wdn.selNodePreviousSibling&&wdn.selNodePreviousSibling.name()!="zztreecolumn"){
wdn.selNodeParent.insertChildBefore(wdn.selNodePreviousSibling,wdn.selNode.copy());
delete wdn.selNodeParent.*[wdn.selNodeChildIndex+1];
var runFns = saveMDNforWDN() && dwChangeFileInTab(ctg.pF,false,false,true,true) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}
return setVForm(ctg.pF,1) && LogFtnReturn(logFtn) || logError(new Error());
}

function moveWLNdown(ctg,useSelNodeId){
// moves object down one sibling in the layout
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wln = getTree(ctg,useSelNodeId);
wln = getTreeSelNodeSiblingsAndParent(ctg,wln);

//If this node does not exist, then stop here and return true
if(!wln.selNode){//node 
alert(ctg.pF +":" +"wln.selNode" +" is Blank (this is for testing only) the ftn's useSelNodeId is:"+useSelNodeId);
return LogFtnReturn(logFtn);
}
var wlnLib = getLibNode(ctg,wln.selNode.@n_type_num);
var wlnMoveValue = wlnLib.mvValue; // this gets the move value for the object

// if treenode is not at the bottom, then move it down one
if(wln.selNodeNextSibling && wlnMoveValue > 0){
wln.selNodeParent.insertChildAfter(wln.selNodeNextSibling,wln.selNode.copy());
delete wln.selNodeParent.*[wln.selNodeChildIndex];
var runFns = saveWLN(ctg) && dwChangeFileInTab("wdn",false,false,true,true) &&  setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}
return setVForm(ctg.pF,1) && LogFtnReturn(logFtn) || logError(new Error());
}

function moveWLNleft(ctg,useSelNodeId){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wln = getTree(ctg,useSelNodeId);
wln = getTreeSelNodeSiblingsAndParent(ctg,wln);

//If this node does not exist, then stop here and return true
if(!wln.selNode){//node 
alert(ctg.pF +":" +"wln.selNode" +" is Blank (this is for testing only) the ftn's useSelNodeId is:"+useSelNodeId);
return LogFtnReturn(logFtn);
}
var wlnLib = getLibNode(ctg,wln.selNode.@n_type_num);
var wlnMoveValue = wlnLib.mvValue; // this gets the move value for the object

// if selNode parent is not the treecontrol node move selected treeNode on top of it's parent node
if(wln.selNodeParent.name()=="zztreenode" && wlnMoveValue > 0 && wlnMoveValue != 3){  // if-1
var wlnSelParentLib = getLibNode(ctg,wln.selNodeParent.@n_type_num);
var wlnParentMoveValue = wlnSelParentLib.mvValue;
if(wlnParentMoveValue == 1){ // if-2
wln.selNodeParent.parent().insertChildBefore(wln.selNodeParent,wln.selNode.copy());
// if selNode's parent is left with no treenodes and no blank space, then add
// a blank child text node to the parent to force the parent to have a end tag
(wln.selNodeParent.*.length()>1)? null : wln.selNodeParent.appendChild(" ");
delete wln.selNodeParent.*[wln.selNodeChildIndex];
var runFns = saveWLN(ctg) && dwChangeFileInTab("wdn",false,false,true,true) &&  setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
} // if-2
} // if-1
return setVForm(ctg.pF,1) && LogFtnReturn(logFtn) || logError(new Error());
}

function moveWLNright(ctg,useSelNodeId){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wln = getTree(ctg,useSelNodeId);
wln = getTreeSelNodeSiblingsAndParent(ctg,wln);

//If this node does not exist, then stop here and return true
if(!wln.selNode){//node 
alert(ctg.pF +":" +"wln.selNode" +" is Blank (this is for testing only) the ftn's useSelNodeId is:"+useSelNodeId);
return LogFtnReturn(logFtn);
}
var wlnLib = getLibNode(ctg,wln.selNode.@n_type_num);
var wlnMoveValue = wlnLib.mvValue; // this gets the move value for the object

if(wlnMoveValue > 0 && wlnMoveValue != 3){ // if-1
var nextwlnLib = wln.selNodeNextSibling && getLibNode(ctg,wln.selNodeNextSibling.@n_type_num);
var nextwlnMoveValue = nextwlnLib && nextwlnLib.mvValue; // this gets the move value for the object

// if next sibling treenode exist move selected node into it as the top child treenode
if(nextwlnMoveValue == 1){//if2
wln.selNodeNextSibling.@state="expanded";
if(wln.selNodeNextSibling.zztreenode[0]){
wln.selNodeNextSibling.insertChildBefore(wln.selNodeNextSibling.zztreenode[0],wln.selNode.copy());
}
else{
wln.selNodeNextSibling.appendChild(wln.selNode.copy());
}
delete wln.selNodeParent.*[wln.selNodeChildIndex];
var runFns = saveWLN(ctg) && dwChangeFileInTab("wdn",false,false,true,true) &&  setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}//if2
} // if-1
return setVForm(ctg.pF,1) && LogFtnReturn(logFtn) || logError(new Error());
}

function moveWLNup(ctg,useSelNodeId){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wln = getTree(ctg,useSelNodeId);
wln = getTreeSelNodeSiblingsAndParent(ctg,wln);

//If this node does not exist, then stop here and return true
if(!wln.selNode){//node 
alert(ctg.pF +":" +"wln.selNode" +" is Blank (this is for testing only) the ftn's useSelNodeId is:"+useSelNodeId);
return LogFtnReturn(logFtn);
}
var wlnLib = getLibNode(ctg,wln.selNode.@n_type_num);
var wlnMoveValue = wlnLib.mvValue; // this gets the move value for the object

// Move the Object if it's a moveable object
if(wlnMoveValue > 0){ // if-1
// if selected node is not at the top, move it up one
if(wln.selNodePreviousSibling&&wln.selNodePreviousSibling.name()!="zztreecolumn"){
wln.selNodeParent.insertChildBefore(wln.selNodePreviousSibling,wln.selNode.copy());
delete wln.selNodeParent.*[wln.selNodeChildIndex+1];
var runFns = saveWLN(ctg) && dwChangeFileInTab("wdn",false,false,true,true) &&  setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}
} // end if-1

return setVForm(ctg.pF,1) && LogFtnReturn(logFtn) || logError(new Error());
}

function nameBDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = name_DN(ctg.pF) && treeColNeedsUpdate() && updateTree(ctg.pF) && save_DN(ctg) && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function nameNDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = name_DN(ctg.pF) && treeColNeedsUpdate() && updateTree(ctg.pF) && save_DN(ctg) && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function nameTDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = name_DN(ctg.pF) && treeColNeedsUpdate() && updateTree(ctg.pF) && save_DN(ctg) && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function nameWDN(ctg){
// NOTE**this may need to check for illegal chars maybe ie "</a> or </div>" needs more thinking 
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var dn = getTree(ctg);
var dnNameField = getZFormInputTextElm(ctg.a,ctg.pF+"NameField");

// if new name is blank, alert user: You forgot to put in a Name
if(dnNameField.nodeValueIsBlank){//if1
alert(zLang._alert0002);
}//if1
// change name if user has changed the name
else if(dn.selNode.@n_type_num == 2 && dnNameField.nodeValue != dn.selNode.@n_name){
dn.selNode.@n_name = dnNameField.nodeValue;
}
var runFns = saveMDNforWDN() && treeColNeedsUpdate() && updateTree(ctg.pF) && save_DN(ctg) &&dwChangeFileInTab(ctg.pF,false,false,true,true) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function name_DN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var dn = getTree(ctg);
var dnNameField = getZFormTagNameById(ctg.a,ctg.pF+"NameField","input");
var newName = dnNameField && dnNameField.@value;

// if new name is blank
// alert user: You forgot to put in a Name
if(isBlank(newName)){//if1
alert(zLang._alert0002);
//return false;
}//if1
// check for any illegal characters, and only allow a-z, underscores, 0-9 characters,
// if it finds any illegal characters, alert user with the following message:
// illegal Characters! Please Try Again, and use only Letters(a-Z), Numbers(0-9), or Underscores(_) for characters
else if(newName.search(/\W/) > -1){//else2
alert(zLang._alert0003);
//return false;
}//else2
// else check if the new name is already taken, If not ,replace it
else{//else3
var nameTaken = false;
for each(var node in dn.control.zztreenode){//for1
if(node.@n_name==newName && node.@n_num != dn.selNode.@n_num){nameTaken = true;break;}
//(dns[ii].nName.toLocaleLowerCase()==newName.toLocaleLowerCase())? nameTaken = 1:null;
}//ENDfor1
// if name is already taken,  alert user with the following message:
// This name is currently being used Please retry using a different Name
if(nameTaken){//if2
alert(zLang._alert0004);
//return false;
}//if2
// change name if user has changed the name
else if(newName != dn.selNode.@n_name){//else4
dn.selNode.@n_name = newName;
////getVformElmById("wdLink").focus();
}//else4
}//else3
return LogFtnReturn(logFtn);
}

function onChangeBDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = updateTree(ctg.pF) && setBLN() && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function onChangeBLN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = updateTree(ctg.pF) && setBPN() && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function onChangeJDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns =  updateTree(ctg.pF) && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function onChangeMDN(ctg){
//NEEDSWORK
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = updateTree(ctg.pF) && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function onChangeNDN(ctg){
//NEEDED PAGE COULD NOT BE FOUND
// a option to create one should be offered to the user and etc Maybe
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns =  updateTree(ctg.pF) && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function onChangeSDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var sdn = getTree(ctg);
var sdnSite = sdn.selNode.@n_name || false;
var sdnCurrentSite = site.getCurrentSite();
siteRoot = site.getLocalRootURL(sdnSite) || false;
stackRoot = siteRoot && sdn.hasSelNode && sdn.selNode.@n_type_num==3 && dwFileExist(siteRoot+"stacksite",true);
//alert("sdnSite: "+sdnSite);

// set DW's site menus to the correct site if it exist
// these R dreamweaver's menus, not ones in stacksite floating window
if(siteRoot){//if1
var dwSiteFileVisibility = dw.getFloaterVisibility("site files");
var setSiteFileVisibility = (notBlank(sdnCurrentSite) && sdnCurrentSite == sdnSite) || site.setCurrentSite(sdnSite);
dreamweaver.setFloaterVisibility(wui.versionName,true);
var dwSiteFileVisibilityTest2 = dw.getFloaterVisibility("site files");
//alert("dwSiteFileVisibility: "+dwSiteFileVisibility +" dwSiteFileVisibilityTest2: "+dwSiteFileVisibilityTest2);

// If the site file panel was not closed, then close it. I think dreamweaver could add a second Argument
// option to keep the site file panel closed
// if it was open already, then do nothing
if((dwSiteFileVisibility&&dwSiteFileVisibilityTest2)|| (!dwSiteFileVisibility&&!dwSiteFileVisibilityTest2)){
null;
}
//else if it was closed, but dw opened it. Now it needs to be closed. This was basically a BugFix, bc dreamweaver opens the site files floater when it should not, this is here to close it when it does
else if(!dwSiteFileVisibility&&dwSiteFileVisibilityTest2){
dw.toggleFloater("site files");
//dreamweaver.setFloaterVisibility("site files",false);// buggy
}

}//if1
/*
////$$$$NEEDSWORK
// check version, and if the statesite version is valid with the version the site was built with. 
// if both the site and stack folder can be found make sure anything that needs updating is done here too.
if(version){
}
// if the site folder can not be found
else if(!siteRoot){
//alert("This site does not exist.");
//mmnSitesRefresh();
}//siteRoot
*/

// set the trees in this order is impotant
var forms = ["J","B","M","N","T","W"];
for each(var form in forms){
if(!eval("set"+form+"DN()")||logErrorReported){break;}
}

// update the trees in this order is impotant, otherwise inuseQtys will be messed up.
var forms = ["s","j","b","m","n","t","w"];
for each(var form in forms){
treeColNeedsUpdate();
if(!updateTree(form+"dn")||logErrorReported){return logError(new Error("form:"+form));break;}
//if(!eval("update"+form+"DN()")||logErrorReported){break;}
}

var runFns = dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function onChangeTDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = updateTree(ctg.pF) && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function onChangeWDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
changeZFormElmCSS("w","table","wlnTable1",0,"display","block");
changeZFormElmCSS("w","table","wlnTable2",0,"display","block");
changeZFormElmCSS("w","table","wpnTable1",0,"display","block");
changeZFormElmCSS("w","table","wpnTable2",0,"display","block");
var runFns = updateTree(ctg.pF) && setWLN() && dwChangeFileInTab(ctg.pF) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function onChangeWLN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = updateTree(ctg.pF) && setWPN("wpn") && dwChangeFileInTab("wdn") && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function onChangeWPN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var runFns = updateTree(ctg.pF) && dwChangeFileInTab("wdn") && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function onOffWLN(){
//needs work, I think this should be something put into version 2, or its just not an important feature
var logFtn=LogFtn(new Error(),1,1,1,-1);
var wln = getTree("wln");
wln.selNode.@n_on_off  =  (wln.selNode && wln.selNode.@n_on_off == 1)? 0 : 1;
var runFns = saveWLN() && updateWLN() && dwChangeFileInTab();
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function optMnuBDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
getTree(ctg).control.@o_sel = getZFormSelectElm(ctg.a,ctg.pF+"OptMnuElm").selNodeValue;
var runFns = treeColNeedsUpdate() && updateTree(ctg.pF)  && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function optMnuBLN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
getTree(ctg).control.@o_sel = getZFormSelectElm(ctg.a,ctg.pF+"OptMnuElm").selNodeValue;
var runFns = treeColNeedsUpdate() && updateTree(ctg.pF)  && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function optMnuJDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
getTree(ctg).control.@o_sel = getZFormSelectElm(ctg.a,ctg.pF+"OptMnuElm").selNodeValue;
var runFns = treeColNeedsUpdate() && updateTree(ctg.pF)  && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function optMnuMDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
getTree(ctg).control.@o_sel = getZFormSelectElm(ctg.a,ctg.pF+"OptMnuElm").selNodeValue;
var runFns = treeColNeedsUpdate() && updateTree(ctg.pF)  && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function optMnuNDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
getTree(ctg).control.@o_sel = getZFormSelectElm(ctg.a,ctg.pF+"OptMnuElm").selNodeValue;
var runFns = treeColNeedsUpdate() && updateTree(ctg.pF)  && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function optMnuSDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
getTree(ctg).control.@o_sel = getZFormSelectElm(ctg.a,ctg.pF+"OptMnuElm").selNodeValue;
var runFns = treeColNeedsUpdate() && updateTree(ctg.pF)  && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function optMnuTDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
getTree(ctg).control.@o_sel = getZFormSelectElm(ctg.a,ctg.pF+"OptMnuElm").selNodeValue;
var runFns = treeColNeedsUpdate() && updateTree(ctg.pF)  && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}


function optMnuWDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wlnTable1 = getZFormTableElm("w","wlnTable1");

//display tree tables if they r not showing
if(wlnTable1.node && wlnTable1.style && wlnTable1.style.indexOf("display:none") > -1){
changeZFormElmCSS("w","table","wlnTable1",wlnTable1.node,"display","block");
changeZFormElmCSS("w","table","wlnTable2",0,"display","block");
changeZFormElmCSS("w","table","wpnTable1",0,"display","block");
changeZFormElmCSS("w","table","wpnTable2",0,"display","block");
}

getTree(ctg).control.@o_sel = getZFormSelectElm(ctg.a,ctg.pF+"OptMnuElm").selNodeValue;
var runFns = treeColNeedsUpdate() && updateTree(ctg.pF)  && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function optMnuWLN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
getTree(ctg).control.@o_sel = getZFormSelectElm(ctg.a,ctg.pF+"OptMnuElm").selNodeValue;
var runFns = treeColNeedsUpdate() && updateTree(ctg.pF)  && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function optMnuWPN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
getTree(ctg).control.@o_sel = getZFormSelectElm(ctg.a,ctg.pF+"OptMnuElm").selNodeValue;
var runFns = treeColNeedsUpdate() && updateTree(ctg.pF)  && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function refreshNDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
//var ndnSave = saveNDN();
var runFns = dwChangeFileInTab(ctg.pF,false,false,true,true) && saveNDN() && setVForm(ctg.pF,0);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function refreshSDN(){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var runFns= setProgram() && dwChangeFileInTab("sdn") && setVForm("sdn",1);
return runFns&& LogFtnReturn(logFtn);
}

function save_DN(ctg,useSelNodeId){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var dn = getTree(ctg,useSelNodeId);
var dnLib = getLibNode(ctg,dn.selNode.@n_type_num);
var dnNum= dn.selNode.@n_num;
var dnTypeNum=dn.selNode.@n_type_num;
var dnFolder = getPathInSS(ctg.a);
var dnLink = dn.selNode.@n_link || ""; 
var dnName = notBlank(dn.selNode.@n_name) || "";
var dnFilesWritten = true;
var codeFolder = wui.ssFileCode;

// write and save each file needed
for(var ii = 0; ii< dnLib.fileNames.length;ii++){//for1
var fileNameType = dnLib.fileNameTypes[ii];
var filePath = dnLib.fileNames[ii];
var fileLink = dnNum+"/"+filePath; // may want to test for false and use continue
var fileCode ="";
//alert("codeFolder::"+codeFolder+"|||"+"ctg.pF::"+ctg.pF+"|||"+"dnTypeNum::"+dnTypeNum+"|||"+"filePath::"+filePath);

// rvw=read, eval and write using the config file mostly for saving the u files
if(fileNameType =="rvw"){
fileCode=DWfile.read(codeFolder+ctg.pF+"q"+dnTypeNum+"/"+filePath);
fileCode = eval(fileCode);
//alert(dnFolder+fileLink +" |||| "+ dnName +" |||| "+ fileCode);
(dwFileWriteAndReloadDom(dnFolder+fileLink,fileCode))? changedFiles.push(dnFolder+fileLink) : dnFilesWritten = false;
}
// cft=Copy File Too . | If file is missing copy this  config to a new file
// NOT USED YET. I'm going to use it on jDN files and others
else if(fileNameType=="cft"){
if(!dwFileExist(dnFolder+fileLink)){
//DWfile.copy();
//fileCode=DWfile.read(codeFolder+ctg.pF+"q"+dnTypeNum+"/"+filePath);
//(DWfile.write(dnFolder+fileLink,fileCode))? null : dnFilesWritten = false;
}
}
// rwm=Read & Write Missing file by coping the config file mostly for saving missing files
else if(fileNameType=="rwm"){
if(!dwFileExist(dnFolder+fileLink)){
fileCode=DWfile.read(codeFolder+ctg.pF+"q"+dnTypeNum+"/"+filePath);
(dwFileWriteAndReloadDom(dnFolder+fileLink,fileCode))? changedFiles.push(dnFolder+fileLink) : dnFilesWritten = false;
}
}
// Snipit & Get and replace code from the snFile, then Eval the sFile
else if(fileNameType=="sge"){
var iFileURL = notBlank(dnLink) && siteRoot + dnLink;
var iFileCode = iFileURL && dwFileExist(iFileURL) && DWfile.read(iFileURL) || "";
iFileCode = iFileCode.replace(/..\/..\/b/g,"stacksite/b"); // any relative likes pointing to the image file
iFileCode = iFileCode.replace(/..\/..\/..\//g,""); // any relative likes pointing to other files in the site
iFileCode = iFileCode.replace(/\//g,"\\/");
iFileCode = iFileCode.replace(/'/g,"\\'");
iFileCode = iFileCode.replace(/"/g,'\\"');
fileCode=DWfile.read(codeFolder+ctg.pF+"q"+dnTypeNum+"/"+filePath);
fileCode = eval(fileCode);
fileCode.substring(1,fileCode.length-1);
(dwFileWriteAndReloadDom(dnFolder+fileLink,fileCode))? changedFiles.push(dnFolder+fileLink) : dnFilesWritten = false;
}
// Site mFile which is the array menu file
else if(fileNameType=="mfi"){
var wdn = getTree(catg.wdn); // this maynot be needed in all cases, dn may be the tree too
// Loop each wdn and save changes to the mFile
// Home page(homePg could// NOTE might want to handles this some other way, but this is pretty darn good
// coping the treenodes, and adding and deleting attibutes, and changing the tagname maybe faster.
var mFileNodes = <b id="qdir" home_pg="1"> </b>;
var i = 0;
for each(var node in wdn.control..zztreenode){//forM
var bElm = <b> </b>;
bElm.@dcnu = node.@n_num+"|" + node.@n_name;
bElm.@zx = node.@n_link;
//alert(wdn.control);
//alert(mFileNodes.toXMLString());
//NOTE there is a bug in mac osx, after looping a few times it 
// sees node.parent().name()=="zztreecontrol" wrong, when it loops the the first few time and
// the node.parent().name() is zztreecontrol, but after a few loops node.parent().name() becomes
// null when it should be zztreecontrol, the fix is to first test if node.parent() is null and then the
// node.parent().name() when the node.parent() will be outside the node's name list
(node.parent()==null || node.parent().name()=="zztreecontrol")?mFileNodes.appendChild(bElm): mFileNodes..b[parseInt(node.parent().@elm_num)].appendChild(bElm);
node.@elm_num = i++;
}//forM
//alert("dnLib.toSource(): "+dnLib.toSource());
//alert("codeFolder: "+ codeFolder+ctg.pF+"q"+dnTypeNum+"/"+filePath);
fileCode=DWfile.read(codeFolder+ctg.pF+"q"+dnTypeNum+"/"+filePath);
fileCode = eval(fileCode);
//alert("fileCode: "+ fileCode);
//return false;
(dwFileWriteAndReloadDom(dnFolder+fileLink,fileCode))? changedFiles.push(dnFolder+fileLink) : dnFilesWritten = false;
}
else if(fileNameType == "dn"){ // do & nothing
}
}//ENDfor1
// when adding a file the saveUfileLoader will be done twice but this is ok with me
// on a futures build maybe I can put it in and maybe get ride of some ftns.
return LogFtnReturn(logFtn); //may need to return the typeNum here
//return saveUfileLoader(dn.pF) && LogFtnReturn(logFtn); //may need to return the typeNum here
}

function saveNDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var runFns = saveUfileLoader("ndn") && save_DN(catg.ndn);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function saveUfileLoader(preFix){
//return true;
//Maybe the page should supply  the type and subtype in in the js classname 2_1 
//Update the loader u.js file in the _ folder
//NOTE a for loop could be used to have multi preFix if needed
//Note this could just use and array, but older browser which don't support array may bug out, but split may not work in old one too.
// Actually this could use the array, and for loop it or use xml which the pages can use innerHTML to grab the info. I like splilt but using html needs more thinking
// ie array: qPageStackSite({type:3,subtype:1,jdn:2,mdn:2,ndn:2,tdn:2})
// or
// html/xml : qPageStackSite("<type>3</type><subtype>1</subtype><jdn>2</jdn><mdn>2</mdn><ndn>2</ndn><tdn>2</tdn>")
// 6 is for art files
var logFtn=LogFtn(new Error(),1,1,1,-1);
var uFiles= getFileSubStrArray("/j/3/u.js","Page",'"',"_");
(!uFiles)? uFiles = [3,1,2,2,2,2,2] : null;
var indexNum = 0;
if(preFix == "tdn"){//layout change
indexNum = 2;
//alert(uFiles[indexNum]);
}
else if(preFix == "ndn"){//snipit change
indexNum = 3;
}
else if(preFix == "mdn"){//menu change
indexNum = 4;
}
else if(preFix == "jdn"){//javascript change
indexNum = 5;
}
else{
return logError(new Error("preFix is not recognized"));
}

var refreshNum = parseInt(uFiles[indexNum]);
uFiles[indexNum] = (refreshNum &&refreshNum<10000)? refreshNum + 1: 1;
var runFns = dwFileWriteAndReloadDom(stackRoot + "/j/3/u.js","qPageStackSite(\""+uFiles[0]+"_"+uFiles[1]+"_"+uFiles[2]+"_"+uFiles[3]+"_"+uFiles[4]+"_"+uFiles[5]+"_"+uFiles[6]+"\")");
//100031 var runFns = writeFileToStackSite("/j/3/u.js","qPageStackSite(\""+uFiles[0]+"_"+uFiles[1]+"_"+uFiles[2]+"_"+uFiles[3]+"_"+uFiles[4]+"_"+uFiles[5]+"_"+uFiles[6]+"\")");
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function saveMDNforWDN(){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var sdn = getTree(catg.sdn);
var mdnMenuPgNum = sdn.hasSelNode && sdn.selNode.@n_menu_pg_num || false;
var runFns = (mdnMenuPgNum)? saveUfileLoader("mdn") && save_DN(catg.mdn,"mdn"+mdnMenuPgNum) : true;
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function saveWLN(ctg){
//NOTE may want to create templete if  tdn.selNode is false
var logFtn=LogFtn(new Error(),1,1,1,-1);
var wdn = getTree(catg.wdn);
var wln = getTree(catg.wln);
var tdnNum = wdn.selNode.@tdn_num;
var tdn = getTree(catg.tdn, "tdn"+ tdnNum);
if(logErrorReported || !tdn.hasSelNode){return logError(new Error());}

// maybe this can be here in newCSS too "html,body{border:0px;padding:0;margin:0;height:100%}"
var newCssCode = ["\/*"+"StackSite:"+wui.version+"*\/"];
var newCssGlobalSelectors = [];
var newSnipits = [];
var newMenuArrays = [];
var newScripts = [];
var newCssCodeInUse = []; //var is currently not being used

var isTherePopMenus = -1;
var isTherePopMenuScrlBtn = -1;
var newWssHolder = <z></z>;


// build the code for the newCss file and newWss files 
var wlnCount = 0;
for each(var wlnNode in wln.control..zztreenode){//for1
var wlnTypeNum = wlnNode.@n_type_num; // n_sub_type
var wlnSubTypeNum = parseInt(wlnNode.@n_sub_type) || 0;
var wlnLib = getLibNode(ctg,"",wlnNode.@hash_val);
var wgtDefaults = wlnLib["wgtDefault"+wlnSubTypeNum];
var bElm = <b> </b>;
// I could start using a lifetime number some how for css_selector_number, which is random, but random is not that random
wlnNode.@css_selector_number = wlnCount;
//Window element and try to right the Errors too.
// if any errors have been added to this element it will place the error message to
// an attribute which the web page loader will catch and display in the webpage.
// this also triggers the script loading the page to halt the loading and to only display 
// the error meassages.
if(wlnCount==0 || wlnTypeNum=="101"){
bElm.@errormsgs = notBlank(wlnNode.@error_msgs)||"false";
//alert("wlnCount:"+wlnCount);
}
//SNIPITS update the list of snipits being used
if(wlnTypeNum=="61" && notBlank(wlnNode.@uni_use_2)){//ifsnip
var snipProp = wlnNode.@uni_use_2; // this is where it holds the snipit number // this is no longer in uni_use_1
for each(var snip in newSnipits){if(snip==snipProp){snipProp=false;break;}}
(snipProp)? newSnipits.push(snipProp): null;
}//ifsnip
//MENUS update the list of menuArrays being used
 // menuItem || breadCrumbMenuItem
if((wlnTypeNum=="5" || wlnTypeNum=="55") && notBlank(wlnNode.@n_nav_dir)){//ifmenu
var menuProp = wlnNode.@n_nav_dir; // this is where it holds the menu number
for each(var menu in newMenuArrays){if(menu==menuProp){menuProp=false;break;}}
(menuProp)? newMenuArrays.push(menuProp): null;
}//ifmenu

//SCRIPTS update the list of scripts being used
if(notBlank(wlnLib.uScripts)){//ifScripts
for each(var uScript in wlnLib.uScripts){
//alert("1 wlnLib.uScripts: "+wlnLib.uScripts.toSource());
var scriptProp = uScript+""; // this is where it holds the script number
for each(var script in newScripts){if(script==scriptProp){scriptProp=false;break;}}
(scriptProp)? newScripts.push(scriptProp): null;
}
}//ifScripts


//CSS
// the wgtCssSelector var will be use below with building the wgtRules
var wgtCssSelector = [];
//should it use the element number or one of the parent's element number elm_num
var cssSelectorNumber =
(wlnLib.cssSelectorType=="0")?0:
(wlnLib.cssSelectorType=="namElmNum")?wlnNode.@css_selector_number:
(wlnLib.cssSelectorType=="namElmParNum")?wlnNode.parent().@css_selector_number:
(wlnLib.cssSelectorType=="namElmParNum+1")?parseInt(wlnNode.parent().@css_selector_number) + 1:
"";
//(wlnNode.@css_selector_number=="8")? alert("cssSelectorNumber:"+cssSelectorNumber) : null; // wlnNode
//(wlnNode.@css_selector_number=="8")? alert("wlnNode:"+wlnNode.toXMLString()) : null; // wlnNode

if(wlnLib.cssSelectorNames){//if49
for each(var cssSelectorName in wlnLib.cssSelectorNames){//for3
var useFirstSelectorChar = cssSelectorName.charAt(0);
var cssRules = wlnNode.@["q"+cssSelectorName] || false;
if(!cssRules || isBlank(cssRules)){//if1
continue;
}//if1
// tagName
else if(wlnLib.cssSelectorType == "tagNam"){//if2
newCssCode.push(cssSelectorName+"{"+ cssRules + "}");
}//if2
// namElmNum or, namElmParNum or, namElmParNum+1 with ":" .  The ":" is for css with ":" like c5:hover and etc, mostly menu items
else if(cssSelectorName.indexOf(":") > -1){//if3
var cssSelectorNameSplit = cssSelectorName.split(":");
newCssCode.push("*[zs*=q"+cssSelectorNumber + cssSelectorNameSplit[0] +"]:" + cssSelectorNameSplit[1] +"{"+ cssRules + "}");
(wgtCssSelector.length == 0)? wgtCssSelector.push("q" + cssSelectorNumber+ useFirstSelectorChar +".") : null;
}//if3
// namElmNum, or namElmParNum, or namElmParNum+1 with "c." or "x." or etc
else if(wlnLib.cssSelectorType){//if4
newCssCode.push("*[zs*=q"+cssSelectorNumber + cssSelectorName +"]{"+ cssRules + "}");
(wgtCssSelector.length == 0)? wgtCssSelector.push("q" + cssSelectorNumber+ useFirstSelectorChar + ".") : null;
//wgtCssSelector.push((cssSelectorName == "c")? "q" + cssSelectorNumber+ "c" :  "q" + cssSelectorNumber+ "c.");
//wgtCssSelector.push((cssSelectorName == "c")? "q" + cssSelectorNumber+ "c" :  cssSelectorName.substring(1));
}//if4
}//for3
}//if49
// this will be use below with building the wgtRules
wlnNode.@css_selector = wgtCssSelector.join("");


//update any item's attributes which need to come from the lib and r not found in it's wgtSelectorNames
wlnNode.@sub_type_child_name=(notBlank(wlnLib.subTypeChildNames[wlnSubTypeNum]))?wlnLib.subTypeChildNames[wlnSubTypeNum] + " " : "";
wlnNode.@sub_type_name=(notBlank(wlnLib.subTypeNames[wlnSubTypeNum]))? wlnLib.subTypeNames[wlnSubTypeNum] : "";
//100034 wlnNode.@sub_type_name=(notBlank(wlnLib.subTypeNames[wlnSubTypeNum]))? wlnLib.subTypeNames[wlnSubTypeNum] : "";
//alert(wlnLib.subTypeChildNames +" ||||| "+ wlnLib.subTypeChildNames[wlnSubTypeNum]);


//WGT
var newWgtRuleSet = []; // might be better to name this var wgtValues or wgtRule
var wgtRuleSetCount = -1;
for each(var wgtSelectorName in wlnLib.wgtSelectorNames){//455_for1
wgtRuleSetCount++;
// wgtRuleType  1= it uses and requires the default wgtRule | 0= 
var wgtRuleType = wlnLib.wgtRuleTypes[wgtRuleSetCount];
// var wgtRule = "";

//Type 0 and it's not blank, use the value, otherwise it's value will and should be blank
if(wgtRuleType==0){
newWgtRuleSet.push(notBlank(wlnNode.@[wgtSelectorName])? wlnNode.@[wgtSelectorName] : "");
}
//Type 1 && if it's not the subtype wgtRule: then use it's required default wgtRule
else if(wgtRuleType==1 && wgtRuleSetCount !=3){
newWgtRuleSet.push(wgtDefaults[wgtRuleSetCount]);
}
// var wgtDefault = wgtDefaults[wgtRuleSetCount];
//   var wgtRuleType = (wlnLib.wgtRuleTypes[wgtRuleSetCount]=="1")? wgtDefaults[wgtRuleSetCount] : wlnNode.@[wgtSelectorName];
//10009 var wgtRule = (wlnLib.wgtRuleTypes[wgtRuleSetCount]=="1")? wgtDefaults[wgtRuleSetCount] : wlnNode.@[wgtSelectorName];
// newWgtRuleSet.push(wgtRule);

//Type 1 is the subType with css. Adds the required default wgtRule for subtype and any required css
else if(wgtRuleSetCount==3){//if455if2
var wgtRule = wgtDefaults[wgtRuleSetCount];
//(wlnTypeNum==7)? alert(wgtRule) : null;
newWgtRuleSet.push(wgtRule);
wgtRule = wgtRule.indexOf("_")>-1 && wgtRule.split("_") || [wgtRule];
for each(var wgtCssSelector in wgtRule){//455_for2
//alert("cssRuleSets:"+cssRuleSets);
var cssRuleSet = cssRuleSets[wgtCssSelector] || false;
// if this cssRuleSet does not exist in the cssRuleSets const, then stop here and continue on to the next one.
if(!cssRuleSet){continue;}//455_if3_if3
// check in the newCssGlobalSelectors arary if this wgtCssSelector exist. If not, then include it, and add it's cssRuleSet to newCssCode.
var inCludeThisCssRuleSet = true;
for each(var newCssGlobalSelector in newCssGlobalSelectors){//455_for3
if(wgtCssSelector == newCssGlobalSelector){inCludeThisCssRuleSet=false;break;}//455_if4_if4
}//455_for3
if(inCludeThisCssRuleSet){//if5
newCssGlobalSelectors.push(wgtCssSelector);
newCssCode.push(cssRuleSet);
}//if5
}//455_for2
}//if455if2

}//455_for1

// upDate the newWssHolder
bElm.@zs = newWgtRuleSet.join("$");
//NOTE there is a bug in mac osx, after looping a few times it 
// sees wlnNode.parent().name()=="zztreecontrol" wrong, when it loops the the first few time and
// the wlnNode.parent().name() is zztreecontrol, but after a few loops wlnNode.parent().name() becomes
// null when it should be zztreecontrol, the fix is to first test if wlnNode.parent() is null and then the
// wlnNode.parent().name() when the wlnNode.parent() will be outside the node's name list
(wlnNode.parent()==null || wlnNode.parent().name()=="zztreecontrol")?newWssHolder.appendChild(bElm): newWssHolder..b[parseInt(wlnNode.parent().@elm_num)].appendChild(bElm);
wlnNode.@elm_num = wlnCount++; // this helps find the parent node later on in the code when updating the tree nodes

//Drop Menus
(wlnTypeNum == "30")? isTherePopMenus = 1: null;
(wlnTypeNum == "34")? isTherePopMenuScrlBtn = 1: null;
}//for1

// Build the new css code file for the templete
// NOTE: test if more css code can be move from the js loader

/////NOTE the className is not being used, but I'll leave it here just in case it's needed for something else.
// qBodyreSizer height needs to go and maybe use to set the vertical align to bot to fix sa offset ht on td cells  
// newCssCode += ".qBodyreSizer .qreSizer{height:auto !important}";
// newCssCode += ".qBodyreSizer .qreSizerTrAlign{vertical-align:top !important}";
if(isTherePopMenus){
// (isTherePopMenuScrlBtn)?
// I think a curser is not needed the normal arrow is fine
//100015 newCssCode.push(".noneMB .holder{overflow: hidden}");
//100018 newCssCode.push(".qDmnuSizer{border:none !important}.qDmnuSizer .qholderSizer{padding:0px !important}");
// The following two line R here for testing only. Can be removed on final build or sooner
newCssCode.push(cssRuleSets.boOrHo);// box-orient: horizontal
newCssCode.push(cssRuleSets.boOrVe);// box-orient: vertical
newCssCode.push(cssRuleSets.poAb);// position:absolute
newCssCode.push(cssRuleSets.poRe);// position:relative cuPo
newCssCode.push(cssRuleSets.cuPo);// curser:pointer
newCssCode.push(cssRuleSets.cuDe);// curser:default
newCssCode.push(cssRuleSets.allSizesAuto);// all the min and max and with and heights will = auto
newCssCode.push(cssRuleSets.LeRiBo0px);// left:0px;right:0px;bottom:0px
newCssCode.push(cssRuleSets.LeRiTo0px);// left:0px;right:0px;top:0px
newCssCode.push(cssRuleSets.diNo);// display:none
newCssCode.push(cssRuleSets.ovHi);// overflow:hidden
newCssCode.push(cssRuleSets.Le0TopNeg10000);// left:0px;top:-10000
// allSizesAuto min-height:auto; height:auto; max-height:auto; min-width:auto;width:auto; max-width:auto
// newCssCode.push(".qDmnuSizer {left:0 !important;top:-10000 !important}"); not used
}

var tdnCssURL= stackRoot+"/t/"+tdnNum+"/g.css";
var tdnWssURL= stackRoot+"/t/"+tdnNum+"/c.js";
var tdnCssWrite = dwFileWriteAndReloadDom(tdnCssURL, newCssCode.join(""));
(tdnCssWrite)? changedFiles.push(tdnCssURL) : null;
var tdnWssWrite = dwFileWriteAndReloadDom(tdnWssURL, "qssSetLayout('"+ newWssHolder.children().toXMLString()+"');");
(tdnWssWrite)? changedFiles.push(tdnWssURL) : null;

//nSnipits property update on the tdnNode
//newSnipits = newSnipits.replace(/[^\d,]/,"");// replace anything that is not a num 0r "," maybe needed for win
newSnipits = newSnipits.join("-");

if(tdn.selNode.@n_snipits != newSnipits){//ifnsl1
tdn.selNode.@n_snipits = newSnipits;
saveUfileLoader("ndn");
}//ifnsl1

//nMenus property update on the tdnNode
//newMenuArrays = newMenuArrays.replace(/[^\d,]/,"");// replace anything that is not a num 0r "," maybe needed for win
newMenuArrays = newMenuArrays.join("-");
//NOTE needs a compare to old value here so it decide to update the log file or not
if(tdn.selNode.@n_menus != newMenuArrays){//ifyt55j1
tdn.selNode.@n_menus = newMenuArrays;
saveUfileLoader("mdn");
}//ifyt55j1

//nScripts property update on the tdnNode
//newScripts = newScripts.replace(/[^\d,]/,"");// replace anything that is not a num 0r "," maybe needed for win
newScripts = newScripts.join("-");
if(tdn.selNode.@n_scripts != newScripts){//ifnsl1
tdn.selNode.@n_scripts = newScripts;
saveUfileLoader("jdn");// this one is not needed // it could be best not to use it to make things more greener
//also maybe this can load the loader script needed to build
}//ifnsl1

writeTestingPage(true,"saveWlnTree.txt",wln.control.toXMLString());
var runFns = treeColNeedsUpdate() && updateTree("wln") && saveUfileLoader("tdn") && save_DN(catg.tdn,tdn.selNode.@id);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function saveWpn(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wpn = getTree(ctg);
var wpnLib = getLibNode(ctg,wpn.selNode.@n_type_num);
var thsId = firedElm.id;
var eCat = {a:ctg.a, b:ctg.b, c:"e", pF:ctg.pE};
var thsLib = getLibNode(eCat,"",firedElm.hashVal);
var fVals = thsLib.eFN[2] && thsLib.eFN[2].split(",") || false;
var tof =  parseInt(fVals[0]);// type of function it will do

var wpeTd2 = getZFormTagNameById("w","wpnTd4","td");
var wpe = {};

for  each(var elm in wpeTd2..*){
//ids start with selMenu+(the number) ie. selMenu0
if(elm.name()=="select"){
wpe[elm.@id] = getZFormSelectElm("w",elm.@id,elm);
}
//ids start with textfield+(the number)  ie. textfield0
else if(elm.name()=="input" && elm.@type=="text"){
wpe[elm.@id] = getZFormInputTextElm("w",elm.@id,elm);
}
//ids start with colorswatch+(the number)  ie. colorswatch0
else if(elm.name()=="input" && elm.@type=="mmcolorbutton"){
wpe[elm.@id] = getZFormInputColorButtonElm("w",elm.@id,elm);
}
}

//CSSdirection|CSStext-align|CSStext-decoration|CSSvertical-align|CSSwhite-space
if(tof==1){
wpn.selNode.@css_value = wpe.selMenu0.selNodeValue || "";
wpn.selNode.@viewable_value = wpe.selMenu0.selNodeValueNotBlank && wpe.selMenu0.selNodeText || " ";
saveWpnCssRule(ctg);
}
// id3 borderType|subtype|align| alignButtons| wgt subType | some others too
else if(tof==2){
wpn.selNode.@viewable_value = wpe.selMenu0.selNodeText;
wpn.selNode.@wgt_value = wpe.selMenu0.selNodeValue;
saveWpnWgtRule(ctg,wpe.selMenu0.selNodeValue);
}
//CSSbackGroundColor|CSSFontColor
else if(tof==3){
var newCSS = [];
if(thsId != "btn0"){
var xColorGet=(thsId.indexOf("swatch")>-1)? wpe.colorswatch0.nodeValue : wpe.textfield0.nodeValue;
newCSS.push(removeBlankSpaces(xColorGet)||"");
}
wpn.selNode.@css_value = wpn.selNode.@viewable_value = newCSS.join(" ");
saveWpnCssRule(ctg);
}
 //CSSFonts
else if(tof==4){
var xFont =  (firedElm.tagName=="select")? wpe.selMenu0.selNodeValue : wpe.textfield0.nodeValue;
wpn.selNode.@css_value=wpn.selNode.@viewable_value=(isBlank(xFont)||thsId=="btn0")?"":removeBlankSpaces(xFont);
saveWpnCssRule(ctg);
}

//cssSizeWithAuto//CSSFontSize|CSSMargin|CSSPadding
else if(tof==5){//tof5
var newCSS = [];
if(thsId != "btn0" && wpe.selMenu0.selNodeValue == "auto"){//ifauto
newCSS.push("auto");
}//ifauto
else if(thsId != "btn0"){//elsenum
var sizeX = getNumber(wpe.textfield0.nodeValue);
if(!sizeX.isNum && !sizeX.isBlank){//if2//invaidnumber
alert(zLang._NonNumbersAreNotAllowInSizeField);
}//if2
newCSS.push((sizeX.isNum)? sizeX.val+wpe.selMenu0.selNodeValue : "");
}//elsenum
wpn.selNode.@css_value = wpn.selNode.@viewable_value =  newCSS.join("");
saveWpnCssRule(ctg);
}//tof5

// id7 border Image Folder // Snipit file // menu File
else if(tof==7){ 
wpn.selNode.@viewable_value = (wpe.selMenu0.selNodeValue!="0")? wpe.selMenu0.selNodeText : "";
wpn.selNode.@wgt_value = wpe.selMenu0.selNodeValue;
saveWpnWgtRule(ctg,(wpe.selMenu0.selNodeValue!="0")? wpe.selMenu0.selNodeValue: "");
}

 //CSSborders
else if(tof==8){//tof8
var newCSS = [];
if(thsId != "btn0"){ //setBorder
var xColor=(thsId.indexOf("swatch")>-1)?wpe.colorswatch0.nodeValue:wpe.textfield0.nodeValue;
var sizeX = getNumber(wpe.textfield1.nodeValue);
if(!sizeX.isNum && !sizeX.isBlank){//if2 invaid number
alert(zLang._NonNumbersAreNotAllowInSizeField);//  textfield0.@label_name
}//if2
newCSS.push((isBlank(xColor))? "transparent" : removeBlankSpaces(xColor));
newCSS.push(wpe.selMenu0.selNodeValue);
newCSS.push((sizeX.isNum)? sizeX.val + wpe.selMenu1.selNodeValue : 0+wpe.selMenu1.selNodeValue);
}//setBorder
wpn.selNode.@css_value = wpn.selNode.@viewable_value = newCSS.join(" ");
saveWpnCssRule(ctg);
}//tof8

// 09-padding and margins shorthand ie: 0px 0px 0px 0px //ver 1 will probally not use it
// padding and margin does not in use here.
// 10-border corner radius ie: 0px 0px the first value is the hort and the second is vert
else if(tof==9 || tof==10){//tof10
var newCSS = [];
var cssIsBlank = true;
var useLength =  (tof==9)? thsId != "btn0" && 4 || 0 : thsId != "btn0" && 2 || 0;
var  firedElmIsSelectElm = firedElm.tagName=="select";
for(var i=0; i<useLength;i++){//for1
//alert(wpe.toSource());
var sizeX = getNumber(wpe["textfield"+i].nodeValue);
//alert("sizeX:"+sizeX.toSource());
if(!sizeX.isNum && !sizeX.isBlank){//if2 invaid number
alert(zLang._NonNumbersAreNotAllowInSizeField +" "+wpe["textfield"+i].@label_name+".");
}//if2
(sizeX.isBlank && !firedElmIsSelectElm)? null : cssIsBlank = false;
newCSS.push((sizeX.isNum && sizeX.val || 0) + (notBlank(wpe["selMenu"+i].selNodeValue) || "px"));
}//ENDfor1
wpn.selNode.@css_value = wpn.selNode.@viewable_value = !cssIsBlank && newCSS.join(" ") || "";
saveWpnCssRule(ctg);
}//tof10

// Background Borders (this will probally be not needed, since google plugin)
else if(tof==12){ 
wpn.selNode.@viewable_value = (wpe.selMenu0.selNodeValue!="0")? wpe.selMenu0.selNodeText : "";
wpn.selNode.@wgt_value = wpe.selMenu0.selNodeValue;
saveWpnWgtRule(ctg,wpe.selMenu0.selNodeValue);
}//END  tof==12

 // css breadCrumb seperator Divider // css before breadcrumbs content
// do not  change the order of these lines of code, they must be in this order in tof 14
else if(tof==14){//tof14
//alert(selIndexNum +"|||"+ wpe.selMenu0.selNodeValue +"|||" +selMenu0.edittext +"|||"+ selMenu0.outerHTML);
// note this following line will also work for a editable select menu
//var newCSS=(firedElm.tagName=="select")? wpe.selMenu0.selNodeValue : (selMenu0.selectedIndex<0)?selMenu0.edittext : "";
var newCSS =  "";
var newViewableValue = "";
if(thsId != "btn0"){ //setBorder
newCSS = notBlank((firedElm.tagName=="select")? wpe.selMenu0.selNodeValue : wpe.textfield0.nodeValue);
newViewableValue = newCSS;
newCSS = newCSS && "\"" + newCSS + "\"";
}
wpn.selNode.@viewable_value = newViewableValue || "";
wpn.selNode.@css_value = newCSS || "";
saveWpnCssRule(ctg);
}//tof14

//change misc lang that the users may see as a ViewableValue
//this also is used to replace pipe char("|") to a lowercase(L) "l" so the treenode column can accept it.
//Basically, TreeNodes use pipes in values to make colums in a treenode// so it needs to replace pipes(|)s with a small L char.
if(wpnLib.wordReplace && notBlank(wpn.selNode.@viewable_value)){//wordReplace
for each(var word in wpnLib.wordReplace){
var re = new RegExp(word[1],"g");
wpn.selNode.@viewable_value.replace(re,word[0]);
}
}//wordReplace


var runFns= saveWLN(catg.wln) && treeColNeedsUpdate() && updateTree("wpn") && dwChangeFileInTab("wdn",false,false,"style",true) && setVForm(ctg.pF,1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}



function saveWpnCssRule(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var wpn = getTree(ctg);
var wln = getTree(catg.wln);
var wlnLib = getLibNode(catg.wln,"",wln.selNode.@hash_val);

//Clear all the wln.selNode cssSelector values
for each(var cssSelectorName in wlnLib.cssSelectorNames){//for1
wln.selNode.@["q"+cssSelectorName] = "";
}//for1

//Reset all the wln.selNode cssSelector values
for each(var wpnX in wpn.control..zztreenode){//for1
var wpnXLib = getLibNode(ctg,"",wpnX.@hash_val);
var cssValue = notBlank(wpnX.@css_value) || wpnXLib.cssRequiredDefault;

if(cssValue){//if1
var cssDeclarations = [];
//#note a for loop could add more then one runInclude
//#var newWlnCssIncludes = [];
//#for each(var refTagInclude in wpnXLib.refTagIncludes){//for2
//#var newWlnCssInclude = eval("saveWpnCssRule"+wpnXLib.refTagIncludes+"(ctg,wpnX,wpnXLib)");
//#(!newWlnCssInclude || isBlank(newWlnCssInclude))? null : newWlnCssIncludes.push(newWlnCssInclude);
//#}//for2
// The following must go in this order:
// extraDeclaration adds any extra cssDeclarations required for this type of cssProperty. ie -webkit and etc.. 
var extraDeclaration = wpnXLib.refTagIncludes&&eval("saveWpnCssRule"+wpnXLib.refTagIncludes+"(ctg,wpnX,wpnXLib)");
// if this cssSelectorName has any prior cssDeclarations, than include them.
(isBlank(wln.selNode.@["q"+wpnXLib.cssSelectorName]))? null : cssDeclarations.push(wln.selNode.@["q"+wpnXLib.cssSelectorName]);
// if this cssProperty has any extra cssDeclarations, than include them.
(!extraDeclaration || isBlank(extraDeclaration))? null : cssDeclarations.push(extraDeclaration);
//if it has a cssProperty, than add the cssDeclaration.
(!wpnXLib.cssProperty)? null : cssDeclarations.push(wpnXLib.cssProperty+":"+cssValue);
// join and add all the cssDeclarations to the wln.selNode cssSelector
wln.selNode.@["q"+wpnXLib.cssSelectorName] = cssDeclarations.join(";");
}//if1
}//for1

return LogFtnReturn(logFtn) || logError(new Error());
//alert(wpnX.toXMLString());
//alert("1: "+cssDeclarations.toSource());

}


function saveWpnCssRuleBorderRadius(ctg,wpnX,wpnXLib){
// returns additional declarations to account for browsers which require them for css border radius
// if no BorderRadius is set it returns blank. 
var logFtn=LogFtn(new Error(),1,1,1,-1);
var preFixPropertys = ["-webkit-","-moz-"];
var cssDeclarations = [];

//if it has a css value, return all the additional declarations. 
if(notBlank(wpnX.@css_value)){//if1
for each(var preFixProperty in preFixPropertys){//for1
cssDeclarations.push(preFixProperty +  wpnXLib.cssProperty + ":" +wpnX.@css_value);
}//for1
LogFtnReturn(logFtn);
return cssDeclarations.join(";");
}//if1
//or if it's blank, return blank.
else{
LogFtnReturn(logFtn);
return "";
}
//# the following works too but I choose to return the value. Make no differents. I just wanted to build it both ways
//# var wln = getTree("wln");
//# if(notBlank(wpnX.@css_value)){
//# cssDeclarations.push(wln.selNode.@["q"+wpnXLib.cssSelectorName]);
//# var preFixPropertys = ["-webkit-","-moz-"];
//# for each(var preFixProperty in preFixPropertys){
//# cssDeclarations.push(preFixProperty +  wpnXLib.cssProperty + ":" +wpnX.@css_value);
//# }
//# LogFtnReturn(logFtn);
//# wln.selNode.@["q"+wpnXLib.cssSelectorName] = cssDeclarations.join(";");
//# return "";
//# }
//# else{
//# LogFtnReturn(logFtn);
//# return "";
//# }
}

function saveWpnCssRuleMarginAlignHV(ctg,wpnX,wpnXLib){//
//NOTE I don't think this will be needed, I believe it will only work on tables cells, so I will not update or fix it to work unless it is needed.
// NOT in use
// this is used on Snipit items, and always return blank because it gets set directly to the wln.selNode
var logFtn=LogFtn(new Error(),1,1,1,-1);

var matchItem = vOPT=[['','','',''],['_TopLeft','0px auto 0px 0px',0,'vertical-align:top;text-align:left'],['_TopCenter','0px auto 0px auto',1,'vertical-align:top;text-align:center'],['_TopRight','0px 0px 0px auto',2,'vertical-align:top;text-align:right'],['_MiddleLeft','auto auto auto 0px',3,'vertical-align:middle;text-align:left'],['_MiddleCenter','auto auto auto auto',4,'vertical-align:middle;text-align:center'],['_MiddleRight','auto 0px auto auto',5,'vertical-align:middle;text-align:right'],['_BottomLeft','auto auto 0px 0px',6,'vertical-align:bottom;text-align:left'],['_BottomCenter','auto auto 0px auto',7,'vertical-align:bottom;text-align:center'],['_BottomRight','auto 0px 0px auto',8,'vertical-align:bottom;text-align:right']];

for each(var itm in matchItem){
if(itm[2] == wpnX.@css_value){
var wln = getTree(catg.wln);
var cssDeclarations = [];
(notBlank(wln.selNode["q"+wpnXLib.refSelectorPropName]))?cssDeclarations.push(wln.selNode["q"+wpnXLib.refSelectorPropName]):null;
(notBlank(vOPT[3]))? cssDeclarations.push(vOPT[3]) : null;
wln.selNode.@["q"+wpnXLib.refSelectorPropName] = cssDeclarations.join(";");
}
}

LogFtnReturn(logFtn);
return "";
}


function saveWpnCssRuleMarginAlignPageHV2(ctg,wpnX,wpnXLib){//
//NOTE I don't think this type of Align is or will ever be needed, I believe it will only work with the use of tables cells, so I will not update or fix it. It's is only here in case I would need some of it's code to build something from it. 
// NOT in use, but I will keep it around so I can use some of the code to caculate rows and etc width sizes, which is currently not being done

// it helps set the classes for the extra td cells needed , so the page object can be vertically aligned
// Basically it set the margins of the table width, and the heights of the top and bottom td cells. It may also include textAlign to fix ie quirkmode which does not understand margins auto
// text align will be needed to support quirk mode in ie if I decide to support it? Another option is to put tds on the side, and set their widths. I think the tds is better because it would not require using a ton of extra classes to use textAlign
///var useCssTextAlignOpts = ["","text-align:left","text-align:center","text-align:right","text-align:left","text-align:center","text-align:right","text-align:left","text-align:center","text-align:right"];

var logFtn=LogFtn(new Error(),1,1,1,-1);
var wln = getTree(catg.wln);
var wpn = getTree(catg.wpn);
var wpnAlign = wpnX;
var wpnAlignLib = wpnXLib;
var wpnAlignLibCssRefSelectorProp  =  "q"+wpnAlignLib.refSelectorPropName;
//alert("wpnAlignLibCssRefSelectorProp:"+wpnAlignLibCssRefSelectorProp);
var wpnAlignPropNum = 0;

for(var i = 0; i< wpnAlignLib.vOPTprop.length; i++){
if(wpnAlignLib.vOPTprop[i] == wpnAlign.@viewable_value){
wpnAlignPropNum = i;
break;
}
}
if(wpnAlignPropNum){//if1
// top margin // it sets a height in a blank td space.
var td0Heights = [0,0,0,0,50,50,50,100,100,100];
// bottom margin // it sets a height in a blank td space.
var td2Heights = [0,100,100,100,50,50,50,0,0,0];

var td0Height = td0Heights[wpnAlignPropNum];
var td2Height = td2Heights[wpnAlignPropNum];

// wpnHeightNum is the page height value. It's needed to figureout what % will be needed for the top and bottom cell spaces to set the align node. The height info needs to come from the height wpn treenode, because the selected wln has been clear, so the selected wln node can accept new values. This is the height node, not the liquid height node.
var wpnHeightNum = parseInt(wpn.control..zztreenode.(@id.indexOf("ctd1")>-1)[0].@viewable_value);
//alert(wpn.control..zztreenode.(@id.indexOf("ctd1")>-1)[0].toXMLString());
//alert(wpnAlignPropNum+"|||"+wpnHeightNum+"|||"+td0Height +"|||"+ td2Height+"|||");
//if auto or blank or 0 use defaults
if(!wpnHeightNum){//if2 
//alert("align to defaults");
wln.selNode.@[wpnAlignLibCssRefSelectorProp+0] = (td0Height)?"height:"+td0Height+"%":"";//top
wln.selNode.@[wpnAlignLibCssRefSelectorProp+2] = (td2Height)?"height:"+td2Height+"%":"";//bottom
}//if2
// or the height is greater than 100%
else if(wpnHeightNum>=100){//if3 
//alert(" height greater or higher than 100%");
wln.selNode.@[wpnAlignLibCssRefSelectorProp+0] = "";//top
wln.selNode.@[wpnAlignLibCssRefSelectorProp+2] = "";//bottom
}//if3
// or align it to the top
else if(td2Height==100){//if4 
//alert("align to the top");
wln.selNode.@[wpnAlignLibCssRefSelectorProp+0] = "";//top
wln.selNode.@[wpnAlignLibCssRefSelectorProp+2] = "height:"+(100 - wpnHeightNum)+"%";//bottom
}//if4
// or align it to the bottom
else if(td0Height==100){//if5
//alert("align to the bottom");
wln.selNode.@[wpnAlignLibCssRefSelectorProp+0] = "height:"+(100 - wpnHeightNum)+"%";//top
wln.selNode.@[wpnAlignLibCssRefSelectorProp+2] = "";//bottom
}//if5
// or align it to the middle
// maybe allowing it to have a floating point(ie 12.5%) will work, but needs testing
else if(td0Height==50 && td2Height==50){//if6
//alert("align to the middle");
var tdHt = (100 - wpnHeightNum)/2;
var td0Ht = Math.floor(tdHt);
var td2Ht = Math.ceil(tdHt);
wln.selNode.@[wpnAlignLibCssRefSelectorProp+0] = (td0Ht)? "height:"+td0Ht+"%" : "";//top
wln.selNode.@[wpnAlignLibCssRefSelectorProp+2] = (td2Ht)? "height:"+td2Ht+"%" : "";//bottom
//alert("td0Ht:"+td0Ht+"td2Ht:"+td2Ht);
}//if6
else{// can be removed on final build
alert("itMissedChangeError");
}

}//if1
LogFtnReturn(logFtn);
return "";


///var useCssTextAlignOpts = ["","vertical-align:top;text-align:left","vertical-align:top;text-align:center","vertical-align:top;text-align:right","vertical-align:middle;text-align:left","vertical-align:middle;text-align:center","vertical-align:middle;text-align:right","vertical-align:bottom;text-align:left","vertical-align:bottom;text-align:center","vertical-align:bottom;text-align:right"];

//var tdHtTest1 = parseFloat(tdHt); // test if it's a float
//var td1Ht = (tdHtTest1)?  math.tdHt +.5  :tdHt;
//var td2Ht =  (tdHtTest1)?  math.floor(tdHt) :tdHt;
}

function saveWpnCssRuleMozAlign(ctg,wpnX,wpnXLib){
//NOTE I don't think this will be needed, I believe it will only work on tables cells, so I will not update or fix it to work unless it is needed.
// NOT in use, but I will keep it around BC I have not figure out how to create an Align which will work, so I will keep this code around until I do. 

// this sets a different cssSelectorName(qcymoz) so the return needs to be blank
// wpnCssValue=="center"||wpnCssValue=="right"||wpnCssValue=="left"
// float:right is someting else to consider and use.
// Also maybe using one class on one elm, needs looking into as a possibilty
//The only thing we need to take care of is to define the ie property first and then the mozilla property. 
// i.e.: text-align:-moz-right; text-align:right; The other way around it fails in IE

var logFtn=LogFtn(new Error(),1,1,1,-1);
var wln = getTree(catg.wln);
var cssDeclarations = [];
(notBlank(wln.selNode.@["qcymoz"]))? cssDeclarations.push(wln.selNode.@["qcymoz"]) : null;
(notBlank(wpnX.@css_value))? cssDeclarations.push("text-align:moz-"+wpnX.@css_value) : null;
wln.selNode.@["qcymoz"] = cssDeclarations.join(";");
LogFtnReturn(logFtn);
return "";
}

function saveWpnWgtRule(ctg,newValue){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var wpn = getTree(ctg);
var wpnLib = getLibNode(ctg,"",wpn.selNode.@hash_val);
var wln = getTree(catg.wln);
var wlnLib = getLibNode(catg.wln,"",wln.selNode.@hash_val);

var wpnPidanLength = wpnLib.pIDAN && wpnLib.pIDAN.length || 0; //NEEDED (haspIDAN)?
var wlnWgtProp = wln.selNode.@[wpnLib.wgtSelectorName];
var wlnHasSubProps = wpnPidanLength>0 && !isBlank(wlnWgtProp) && wlnWgtProp.indexOf("_") > -1;
var wlnWgtSubProps = (wlnHasSubProps)? wlnWgtProp.split("_") : eval("['"+""+"']");
var wlnWgtSubPropsLength = wlnWgtSubProps.length;
var newWlnWgtProp = [];
//alert(newValue+"|||||"+wpnLib.pIDAN);

//if1 Rule with no subRules // no underscore
if(wpnPidanLength== 1){
wln.selNode.@[wpnLib.wgtSelectorName] = newValue;
}//if1
//else2 subRule with no subsubRules // 1 underscore
else if(wpnPidanLength==2){
for(var i = 0; i< wpnPidanLength || i< wlnWgtSubPropsLength;i++){
var useProp = (wpnLib.pIDAN[1] == i)? newValue : notBlank(wlnWgtSubProps[i]) || "";
newWlnWgtProp.push(useProp);
//alert(newWlnSubRule +"****"+ newValue);
}
wln.selNode.@[wpnLib.wgtSelectorName] = newWlnWgtProp.join("_");
//wlnIdRules[pIDANs[0]] = newWlnSubRule;
}//else2
//else3 subGroupSubChar  change a char of the subGroup // 2 underscores
else if(wpnPidanLength==3){
for(var i = 0; i< wpnPidanLength || i< wlnWgtSubPropsLength;i++){//for1
var wlnWgtSubProp =  (wlnWgtSubProps[i])? wlnWgtSubProps[i] : "";//MAYBENEEDED isBlank
if(wpnLib.pIDAN[1] != i){//if3-1
newWlnWgtProp.push(wlnWgtSubProp);
////var useProp = (wpnLib.pIDAN[1] == i)? newValue : wlnWgtSubProp;
}//if3-1
else if(wpnLib.pIDAN[1] == i){//else3-2
var wlnWgtSubPropLengthX = wlnWgtSubProp.length;
var wpnTagCharsLength = parseInt(wpnLib.pIDAN[2]);
var newSubSubProp = [];
for(var ii = 0; ii< wlnWgtSubPropLengthX || ii<= wpnTagCharsLength;ii++){//for2 char
var getCharX = wlnWgtSubProp.charAt(ii) || 0; // the || 0 fix any missing chars
newSubSubProp.push((ii==wpnTagCharsLength)? newValue : getCharX);
}//for2
/* NEEDS WORK
// removes any 0's at the end
while(newSubSubProp.length && newSubSubProp.length-1 == newSubSubProp.lastIndexOf("0")){
var removeArryEndItem = newSubSubProp.pop();
//0296 newSubSubProp = newSubSubProp.substr(0,newSubSubProp.length-1);
}
*/
newWlnWgtProp.push(newSubSubProp.join(""));
}//else3-2
}//for1 
//alert("newSubSubProp:"+newSubSubProp);
wln.selNode.@[wpnLib.wgtSelectorName] = newWlnWgtProp.join("_");
//alert("newWlnWgtProp:"+wln.selNode.@[wpnLib.wgtSelectorName]);
}//else3
return LogFtnReturn(logFtn) || logError(new Error());
}


function setBDN(ctg){
// creates the PhotoDirectoryNodes in a menu tree.
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg.bdn || logError(new Error());
//The setTree("wdn") is needed so it sets the inuse attributes on other trees first. 
var bdn = getTree(ctg,"clear");
if(logErrorReported){return false;}

buildTreeColumns(bdn.control);
bugFixTreeUnClicked(bdn.control);

if(stackRoot){//if_stackRoot
bdn.selNodeLib = getLibNode(catg.bdn,"00");
var newNodes = new XML(bdn.selNodeLib.node);
var albNode;
// The library xml nodes of the bdn.selNodeLib.node above in the var newNodes will have nodes
// which R Not needed and will require removing these nodes if it is not the "all" node or the "album" .
// Then add all the attribute values it will need for this node.
for each(var node in newNodes..*){
var bdnNum = node.@id +"";
if(bdnNum=="alp"||bdnNum=="alb"){}else{delete node.parent().*[node.childIndex( )];continue}
if(bdnNum=="alb"){albNode=node;}
node.setName("zztreenode");
var bdnLib = getLibNode(ctg,bdnNum,notBlank(node.@hashVal));
if(logErrorReported){return false;}
node.@id = ctg.pF + bdnLib.typeNum;
node.@n_num=bdnLib.typeNum;
node.@n_link="";
node.@n_name=bdnLib.dName;
node.@n_type_num=bdnLib.typeNum;
node.@n_type_num_sub=" ";
node.@n_type_name=bdnLib.tyNme;
node.@n_type_description=bdnLib.tyDes;
node.@in_use_qty=0;
node.@n_version=.01;
node.@hash_val = bdnLib.hashVal;
}

//add all the albums nodes into the album node in the var buildNodes
//list Folders
var dnFolder = getPathInSS(ctg.a +"a");
var dnFolders= stackRoot&&dwFileExist(dnFolder) && dwFileListFolder(dnFolder,"directorys");
var dnFoldersList=[]; // should be called dnFolderArr

//create a array and sort it, of any file that would be part of stacksite
for each(var dnNumX in  dnFolders){//dir
var uFileCode = dnNumX.search(/[^0-9]/) < 0 && dwFileExist(dnFolder+dnNumX+"/u.js");
if(!uFileCode){continue;}
var nFileCode= dwFileExist(dnFolder+dnNumX+"/n.text") && DWfile.read(dnFolder+dnNumX+"/n.text");
var nFileXML= nFileCode && new XML(nFileCode) || false;
var dnNameX = nFileXML && nFileXML.name && notBlank(nFileXML.name);
(dnNameX && dnNameX.search(/\W/) > -1)? dnNameX = "":null; // makes sure it has only letters
var dnVersionX = nFileXML && nFileXML.version && notBlank(nFileXML.version);
(dnVersionX && !parseFloat(dnVersionX))? dnVersionX = "":null; // makes sure it has only a number

//NOTE maybe test for other various files here with a if before adding it to the array and a option to correct any errors
dnFoldersList.push([dnNameX,dnNumX,dnVersionX]);
}//dir

dnFoldersList.sort( sortArray([2,1,0]));

//Build the nodes
for each(var folderArr in  dnFoldersList){//folderArr
var newNode = createTreeNode();
var dnUfileCodes=getFile(dnFolder+folderArr[1]+"/u.js",false);
dnUfileCodes= dnUfileCodes&&dnUfileCodes.indexOf("StackSite") && getSubStringWithIn('"','"',dnUfileCodes);
dnUfileCodes =  dnUfileCodes&&dnUfileCodes.indexOf("_") && dnUfileCodes.split("_");
var dnLib = getLibNode(ctg,dnUfileCodes[0]);
if(logErrorReported){return false;}
var dnId = ctg.pF+folderArr[1];
var dnNum= folderArr[1];
var dnVname = folderArr[0] || dnLib.dName;

var dnTypeNum = dnLib.typeNum;
var dnTypeNumSub = dnUfileCodes[1] || " ";
var dnTypeName = dnLib.tyNme;
var dnTypeDescription =  dnLib.tyDes;
var dnInUseQty = 0;
var dnSelected = "false";
var dnVersion = parseFloat(folderArr[2]) || .01;

// set the page link // this is the page that will show in the browser window
var dnLink = dnLib.nLink && "stacksite/"+ctg.a+"a/"+dnNum+"/"+dnLib.nLink || "";


//set script node inuseQty up one if it exist, if script is missing and doesn't exist then add it.
var jdn = getTree(catg.jdn);
for each(var jdnNum in dnLib.uScripts){//forscr
var jdnNode = jdn.hasNodes && jdn.control.zztreenode.(@id == "jdn"+jdnNum)[0] || false;
if(jdnNode){
jdnNode.@in_use_qty = parseInt(jdnNode.@in_use_qty)+1;
}
else{
// off bc I don't want it over writing any changes I make to the script in the current stacksite folder
//off var runFns=add_DN(catg.jdn,"jdn"+jdnNum,jdnNum);
}
}//forscr


// set node info
newNode.@id=dnId;
newNode.@n_num=dnNum;
newNode.@n_link=dnLink;
newNode.@n_name=dnVname;
newNode.@n_type_num=dnTypeNum;
newNode.@n_type_num_sub=dnTypeNumSub;
newNode.@n_type_name=dnTypeName;
newNode.@n_type_description=dnTypeDescription;
newNode.@in_use_qty=dnInUseQty;
newNode.@n_version=dnVersion;
newNode.@hash_val = dnLib.hashVal;
//newNode.@value= dnVname+"|"+dnTypeName +": ";
albNode.appendChild(newNode);

}//folderArr
//alert(newNodes.toXMLString());
bdn.control.appendChild(newNodes.children());
}//if_stackRoot
var runFns = !logErrorReported && setBLN();
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}


function setBDNXXX(ctg){
// creates the PhotoDirectoryNodes in a menu tree.
//Note I don't think buildTreeColumns() is needed below, I think this gets done in setTree
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg.wdn || logError(new Error());
//The setTree("wdn") is needed so it sets the inuse attributes on other trees first. 
var bdn = setTree("bdn") && getTree(ctg,"clear");
if(logErrorReported){return false;}

buildTreeColumns(bdn.control);
bugFixTreeUnClicked(bdn.control);


bdn.selNodeLib = getLibNode(catg.bdn,"00");
var buildNodes = new XML(bdn.selNodeLib.node);
//alert(newNodes.toXMLString());

// The library xml nodes of the bdn.selNodeLib.node above in the var newNodes will have nodes
// which R Not needed and will require removing these nodes if it is not the "all" node or the "album" .
// Then it will be deleted.
var albNode;
for each(var node in buildNodes..*){
var nodeId = node.@id;
if(nodeId=="alp"||nodeId=="alb"){}else{delete node.parent().*[node.childIndex( )];}
if(nodeId=="alb"){albNode=node;}
}


//add all the albums nodes into the album node in the var buildNodes
// NOTE: On try2 below it needs to put some type of correction here. Usally it needs to separate the attributes from the element's attribute quotes
// it should try to fix it with regEx or a JS method which converts HTML to XML. For now I'm going to flush it in a div using innerHTML,
// because DW has no JS FTN which works and converts HTML to XML, and regEx is just to much of a mess to do and get to work. 
var albNodes = stackRoot && getFileInStackSite("/b/albums/m.html",false);
if(albNodes && albNodes.indexOf("<b")>-1 && albNodes.indexOf(">")){//if1
try{//try1
albNodes = albNodes.substring(albNodes.indexOf("<"),albNodes.lastIndexOf(">")+1);
albNodes = new XML("<div>"+albNodes+"</div>");
albNode.appendChild(albNodes.children());
}//try1
catch(err){//catch1
try{//try2
var flushHolder = getVformElmById("flushHolder");
flushHolder.innerHTML = albNodes;
albNodes = new XML("<div>"+flushHolder.innerHTML+"</div>");
albNode.appendChild(albNodes.children());
flushHolder.innerHTML = "";
}//try2
catch(err){//catch2
//MAYBE NEEDED could try and build the pages from the file system and put them in one long list
albNodes = false;
return logError(err);
}//catch2
}//catch1
}//if1
// Or it's a stacksite and the file is missing

var newNodes = <t></t>;

// if all is well then start building the treemenu  
 //NOTE wdnUfileCodes may needs to test for Dividers and Link types
 //NOTE wdnTextValue may need to filter out anything thats not text and etc

var i_count = 0;
for each(var node in buildNodes){//for1
var bdnNum = node.@id || "e";
var bdnTagName = node.name();
var isUserAlbumNode = bdnTagName=="ua";
var bdnHash = node.@hash || false;
var bdnLib = getLibNode(ctg,bdnNum,bdnHash);
if(logErrorReported){return false;}


// start building the treeNode
var newNode = createTreeNode();
newNode.@id = wdnNum  != "e" && ctg.pF + wdnNum || "e"+Math.random().toString().replace(".","");
newNode.@n_num = wdnNum;
newNode.@n_name = wdnTextValue;
newNode.@n_link =  mFileElm.@["zx"] || mFileElm.@["ZX"] || " ";
newNode.@n_type_num = wdnLib.typeNum;
newNode.@n_type_num_sub = notBlank(wdnUfileCodes[3]) || " ";
newNode.@n_type_name = wdnLib.tyNme;
newNode.@n_type_description =  wdnLib.tyDes;
newNode.@elm_num = i_count;
newNode.@tdn_num =  tdn.hasSelNode && wdnUfileCodes[2] || " "; //1 is error  // most have a space;
newNode.@tdn_name = notBlank(newNode.@tdn_num) && notBlank(tdn.selNode.@n_name) || " "; // most have a space
newNode.@value = wdnTextValue+"|"+ wdnLib.tyNme +": "+wdnLib.tyDes;
newNode.@state = "collapsed";
newNode.@hash_val = wdnLib.hashVal;
////////newNode.nVersion =parseFloat(dnHfileCodeS[3]) || .01;
/////////newNode.nSearch = (newNode.@n_type_num !="e")? dnHfileCodeS[2] : " ";
//////////newNode.@inUseQty = 0;
var placeNum = parseInt(mFileElm.parent().@elmNum);
(placeNum==0)? newNodes.appendChild(newNode) : newNodes.descendants("zztreenode")[placeNum-1].appendChild(newNode);
mFileElm.@elmNum = i_count;
i_count++;
} // end of for1
//writeTestingPage(true,"setWDNXML.js","var x ="+newNodes.toXMLString());
wdn.control.appendChild(newNodes.children());


var runFns = !logErrorReported && setWLN();
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}


function setBDNXX(){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var runFns = setTree("bdn") && setBLN();
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function setBLN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg.bln || logError(new Error());

var bdn = getTree(catg.bdn);
if(logErrorReported){return false;}
var bln = getTree(ctg,"clear");

buildTreeColumns(bln.control);
bugFixTreeUnClicked(bln.control);

var bdnNum = bdn.selNode && bdn.selNode.@n_num || false;
// if  it has a selected bdn node and it is not the "Album" node create a tree list of rhe images.
if(stackRoot && bdnNum && bdnNum!="alb"){// if_1
//NN bdn.selNodeLib = getLibNode(catg.bdn,bdn.selNodeLibId); //NN
//NN if(logErrorReported){return false;}//NN
//alert(bln.toSource());
var bdnFolder = getPathInSS(ctg.a);// folder path in StackSite
var blnTreeContolLib = getLibNode(ctg,"00");
//if(logErrorReported){return false;}

for each(var node in blnTreeContolLib.node.*){//for1
var blnLib = getLibNode(ctg,"",node.@hashVal);
if(logErrorReported){return false;}
// iFile was removed from the lib should use nFile
if(dwFileExist(bdnFolder + bdn.selNode.@n_num +"/"+blnLib.iFile)){//if2 // .iFile was removed and this will change when I make this code for media
var newNode = createTreeNode();
newNode.@id="bln" + node.@id;
newNode.@n_num= bdn.selNode.@n_num;
newNode.@n_name = blnLib.dName;//NN
newNode.@n_version = bdn.selNode.@n_version;//Not being used
newNode.@n_link = blnLib.nLink&&"stacksite/b/"+bdn.selNode.@n_num+"/"+blnLib.nLink || " ";//IMAYBE it can be blank
newNode.@n_type_num = node.@id;
newNode.@n_type_name = blnLib.tyNme;//NN
newNode.@hash_val = blnLib.hashVal;
// size needs work so it can show sizes like a file system
 // .iFile was removed from lib should use nFile and this will change when I make this code for media
newNode.@n_type_size = (DWfile.getSize(bdnFolder + bdn.selNode.@n_num +"/"+blnLib.iFile)/1000)+"kb";
//I believe value should be set in the update, so maybe the following line can be removed 
//0199* newNode.@value= blnLib.dName+"|" + blnLib.tyNme + " :" + newNode.@nTypeSize;
bln.control.appendChild(newNode);
}//if2
}//for1
//alert(bln.control.toXMLString());
}//if_1

var runFns = !logErrorReported && treeColNeedsUpdate() && updateTree("bln") && setBPN();
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function setBPN(){// not in use
var logFtn=LogFtn(new Error(),1,1,1,-1);
return  setBPNbrowser(catg.bpn) && LogFtnReturn(logFtn) || logError(new Error());
}

function setBPNbrowser(ctg){
// need to figure out how to deal with the browsercontrol
var logFtn=LogFtn(new Error(),1,1,1,-1);
if(!controlBrowserOn){return LogFtnReturn(logFtn);}

var bdn= getTree(catg.bdn);
var bln = getTree(catg.bln);
var bdnFolder = getPathInSS(ctg.a);

if(bln.selNode){
var node = bln.selNode;
var nodeLib = getLibNode(catg.bln,"",bln.selNode.@hash_val);
}
else if(bdn.selNode){
var node = bdn.selNode;
var nodeLib = getLibNode(catg.bdn,"",bdn.selNode.@hash_val);
}
else{
var node = bdn.control;
var nodeLib = getLibNode(catg.bdn,"00");
}

var backsPostions = ["top repeat-x","bottom repeat-x","left repeat-y","right top repeat-y","left top no-repeat","right top no-repeat","left bottom no-repeat","right bottom no-repeat"];
var divCode = "";
var divCodeEnds = "";
var pageCode =  "<html><body>";
var pageCodeEnd = "</body></html>";

//create html code to write into the new document being displayed in the browsercontrol
//NOTE math.random may not be needed
for each(var fileDup in nodeLib.fileDups){//for1
var filexRelURL = bdn.selNode.@n_num+"/"+fileDup;// relative to the document 
//NN var filexURL = bdnFolder+bdn.selNode.@n_num+"/"+fileDup; //NN
//alert(fileDup +"|||"+fileDup.indexOf(1));
//alert("filexRelURL:"+filexRelURL);
var usePostion=(fileDup.indexOf(1)>-1)?0:(fileDup.indexOf(2)>-1)?1:(fileDup.indexOf(3)>-1)?2:(fileDup.indexOf(4)>-1)?3:(fileDup.indexOf(5)>-1)?4:(fileDup.indexOf(6)>-1)?5:(fileDup.indexOf(7)>-1)?6:(fileDup.indexOf(8)>-1)?7:0;
divCode=divCode+"<div class='qq"+Math.random().toString().replace(".","")+"' style='width:50px; height:50px; background:url("+filexRelURL+") "+backsPostions[usePostion]+"'>";
divCodeEnds = divCodeEnds + "</div>";
}//for1

var bpnTd2 = zForm[ctg.a].*.(@id==ctg.pF+"Table1")[0].tr.td[1];
var bpnTd2div1 = bpnTd2.child(0);
var bpnBrowser =bpnTd2.child(1);
var bpnBrowserDocUrl  = bdnFolder+"wuiuse.html";

// write the new document and display it in the browsercontrol
//alert("divCode:"+divCode);
//alert("!isBlank(divCode):"+!isBlank(divCode) +" |||||||||||| "+ bdn.selNode.toSource());
if((bln.selNode || bdn.selNode) && !isBlank(divCode)){//if1 display selected border image
//the following order is important and setAttribute is needed. Setting it any other way, will not work
bpnBrowser.parent().@needs_to_open_url= bpnBrowserDocUrl;
delete bpnTd2div1..*;
bpnTd2div1.appendChild(zLang._loadingPreview); // needs to get the lang. 
//alert(pageCode + divCode + divCodeEnds + pageCodeEnd);
var writeBrowserDoc = writeFileToStackSite("/b/wuiuse.html", pageCode + divCode + divCodeEnds + pageCodeEnd);

}//if1
else{//blank out the bpnBrowser // and if the viewpage exist blank it out or delete it
//the following order is important and setAttribute is needed. Setting it any other way will not work.
bpnBrowser.parent().@needs_to_open_url= "about:blank";
//BUG NOTE mac osx will not replace or delete a elm's text node the normal way. Basically it can't do ie xmlelmentnode = "sometext"; It come up as invaid xml . The work around, uses delete and append to get around this limitation.  
delete bpnTd2div1..*;
bpnTd2div1.appendChild(zLang._PreviewCol); 
var writeBrowserDoc = siteRoot && stackRoot && dwFileExist(bdnFolder+"wuiuse.html") && writeFileToStackSite("/b/wuiuse.html", " ");
}
return LogFtnReturn(logFtn);
}

function setJDN(){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var runFns = setTree("jdn");
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function setMDN(){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var runFns = setTree("mdn");
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function setNDN(){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var runFns = setTree("ndn");
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function setProgram(){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var ctg = catg.sdn || logError(new Error());
//var browserEleHform = document.getElementById("hFormHolder");
//browserEleHform.removeEventListener("BrowserControlLoad",setProgram,true);

siteRoot = false;
stackRoot = false;

// set the trees in this order is impotant
var forms = ["S","J","B","M","N","T","W"];
for each(var form in forms){
if(!eval("set"+form+"DN()")||logErrorReported){return logError(new Error());break;}
}

// update the trees in this order is impotant, otherwise inuseQtys will be messed up.
var forms = ["s","j","b","m","n","t","w"];
for each(var form in forms){
treeColNeedsUpdate();
if(!updateTree(form+"dn")||logErrorReported){return logError(new Error("form:"+form));break;}
}

return LogFtnReturn(logFtn);
}

function setSDN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg.sdn || logError(new Error());
var sdn = getTree(ctg,"clear");

if(logErrorReported){return false;}

buildTreeColumns(sdn.control);
bugFixTreeUnClicked(sdn.control);
var sites = site.getSites();

for each(var siteName in sites){// for1
var siteRootURL = site.getLocalRootURL(siteName);
var siteStackURL= dwFileExist(siteRootURL+"stacksite/",true);
var siteSFolderURL= siteStackURL&&dwFileExist(siteStackURL+"s/",true);
var siteUFileURL= siteSFolderURL&&dwFileExist(siteSFolderURL+"1/u.js",true);
var siteUFileCodes= siteUFileURL && DWfile.read(siteUFileURL);
siteUFileCodes=siteUFileCodes&&siteUFileCodes.indexOf("StackSite")&&getSubStringWithIn('"','"',siteUFileCodes);
siteUFileCodes = siteUFileCodes && siteUFileCodes.indexOf("_") && siteUFileCodes.split("_");
var siteNFileCode= siteSFolderURL&&dwFileExist(siteSFolderURL+"1/n.text") && DWfile.read(siteSFolderURL+"1/n.text");
var siteNFileXML= siteNFileCode&& new XML(siteNFileCode) || false;
var hasVersion = siteNFileXML && parseFloat(siteNFileXML.version);
var sdnLibNum = siteUFileCodes && parseInt(siteUFileCodes[0]);

// 2=dreamweaver||3=stacksite
(sdnLibNum==3)? null : (sdnLibNum)? sdnLibNum="e" : sdnLibNum=2;
var sdnLib = getLibNode(ctg,sdnLibNum); // only used to check if it exist
if(logErrorReported){return false;}

var newNode = createTreeNode();
newNode.@id = sdnLibNum!="e" && "n"+ctg.pF+siteName || "e"+Math.random().toString().replace(".","");
//NN newNode.@nNum= 1;//NN
newNode.@n_menu_pg_num = (siteUFileCodes)? siteUFileCodes[2] : "";// most be closed "" so it can report false
//alert("newNode.@n_menu_pg_num:"+newNode.@n_menu_pg_num);
newNode.@n_name=siteName;
newNode.@n_site_root_url = siteRootURL;
newNode.@n_link = ""; //this was siteRootURL, but change to blank to make it work in refresh
newNode.@n_type_num = sdnLibNum;
//NN newNode.@nTypeName = sdnLib.tyNme;//NN
//NN newNode.@nTypeDescription = sdnLib.tyDes;//NN
newNode.@n_sub_type = (sdnLibNum>2&&siteUFileCodes[1]) || 0;
newNode.@n_version = hasVersion && .01 || "";
newNode.@hash_val = sdnLib.hashVal;
//0199* newNode.value= sites[i]+"|"+sdnLib.tyNme +": "+sdnLib.tyDes);
//alert(newNode.toXMLString());
sdn.control.appendChild(newNode);
}// for1
return !logErrorReported && LogFtnReturn(logFtn) || logError(new Error());
}

function setTDN(){ // set templeteDirectoryNodeTree
var logFtn=LogFtn(new Error(),1,1,1,-1);
var runFns = setTree("tdn");
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function setWDN(ctg){
// creates the WuiDirectoryNodes in a menu tree.
//Note maybe change sdnMFile name to mdnMFile
//Note I don't think buildTreeColumns() is needed below, I think this gets done in setTree
//Note I think having a var tdn = getTree(catg.tdn) would be faster. 
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg.wdn || logError(new Error());
//The setTree("wdn") is needed so it sets the inuse attributes on other trees first. 
var wdn = setTree("wdn") && getTree(ctg,"clear");
if(logErrorReported){return false;}

buildTreeColumns(wdn.control);
bugFixTreeUnClicked(wdn.control);

var sdn = getTree(catg.sdn);
var sdnMenuPgNum = sdn.selNode && notBlank(sdn.selNode.@n_menu_pg_num) || false;
var sdnMFile = sdnMenuPgNum && getFileInStackSite("/m/"+sdnMenuPgNum+"/m.html",false);
var newNodes = <t></t>;

if(stackRoot && sdnMFile && sdnMFile.indexOf("<b")>-1 && sdnMFile.indexOf(">")){//if1
try{//try1
sdnMFile = sdnMFile.substring(sdnMFile.indexOf("<"),sdnMFile.lastIndexOf(">")+1);
sdnMFile = new XML("<div>"+sdnMFile+"</div>");
}//try1
catch(err){//catch1
try{//try2
//NEEDED need to put some type of correction here. Usally it needs to separate the attributes from the element's attribute quotes
// it should try to fix it with regEx or a JS method which converts HTML to XML. For now I'm going to flush it in a div using innerHTML,
// because DW has no JS FTN which works and converts HTML to XML, and regEx is just to much of a mess to get to work. 
var flushHolder = getVformElmById("flushHolder");
flushHolder.innerHTML = sdnMFile;
sdnMFile = new XML("<div>"+flushHolder.innerHTML+"</div>");
flushHolder.innerHTML = "";
}//try2
catch(err){//catch2
//MAYBE NEEDED could try building the page information from the file system and put them in one long list
sdnMFile = false;
return logError(err);
}//catch2
}//catch1
}//if1

// if all is well then start building the treemenu  
 //NOTE wdnUfileCodes may needs to test for Dividers and Link types
 //NOTE wdnTextValue may need to filter out anything thats not text and etc
wdn.control.@homePg = "";
if(stackRoot && sdnMFile){//elseif1
var i_count = 0;
for each(var mFileElm in sdnMFile..b){//for1

if(i_count==0){
wdn.control.@homePg = mFileElm.@home_pg && notBlank(mFileElm.@home_pg) || "";
mFileElm.@elmNum = i_count;
i_count++;
continue;
}

var wdnDcNus = mFileElm.@dcnu || mFileElm.@DCNU || false;
wdnDcNus = wdnDcNus && wdnDcNus.indexOf("|") && wdnDcNus.split("|");
var wdnNum = wdnDcNus && notBlank(wdnDcNus[0]) || "e";
var wdnTextValue = wdnDcNus && notBlank(wdnDcNus[1]) ||  "";
var wdnUfileCodes= wdnNum!="e" && getFileSubStrArray("/"+ctg.a+"/"+wdnNum+"/u.js","Layout",'"',"_");
var wdnLibNum = wdnUfileCodes && parseInt(wdnUfileCodes[0]) || "e";
var wdnLib = getLibNode(ctg,wdnLibNum);
if(logErrorReported){return false;}


// templete
//Note could add a primary and secondary Layouts here with _underscores or - minus sign and spliting
var tdn=wdnUfileCodes&& getTree(catg.tdn,"tdn"+wdnUfileCodes[2]);

// start building the treeNode
var newNode = createTreeNode();
newNode.@id = wdnNum  != "e" && ctg.pF + wdnNum || "e"+Math.random().toString().replace(".","");
newNode.@n_num = wdnNum;
newNode.@n_name = wdnTextValue;
newNode.@n_link =  mFileElm.@["zx"] || mFileElm.@["ZX"] || " ";
newNode.@n_type_num = wdnLib.typeNum;
newNode.@n_type_num_sub = notBlank(wdnUfileCodes[3]) || " ";
newNode.@n_type_name = wdnLib.tyNme;
newNode.@n_type_description =  wdnLib.tyDes;
newNode.@elm_num = i_count;
newNode.@tdn_num =  tdn.hasSelNode && wdnUfileCodes[2] || " "; //1 is error  // most have a space;
newNode.@tdn_name = notBlank(newNode.@tdn_num) && notBlank(tdn.selNode.@n_name) || " "; // most have a space
newNode.@value = wdnTextValue+"|"+ wdnLib.tyNme +": "+wdnLib.tyDes;
newNode.@state = "collapsed";
newNode.@hash_val = wdnLib.hashVal;
////////newNode.nVersion =parseFloat(dnHfileCodeS[3]) || .01;
/////////newNode.nSearch = (newNode.@n_type_num !="e")? dnHfileCodeS[2] : " ";
//////////newNode.@inUseQty = 0;
var placeNum = parseInt(mFileElm.parent().@elmNum);
(placeNum==0)? newNodes.appendChild(newNode) : newNodes.descendants("zztreenode")[placeNum-1].appendChild(newNode);
mFileElm.@elmNum = i_count;
i_count++;
} // end of for1
//writeTestingPage(true,"setWDNXML.js","var x ="+newNodes.toXMLString());
wdn.control.appendChild(newNodes.children());
}//if1

//else if there is a stackRoot and no <b> elements found in the mFile
else if(stackRoot){//e1
// NOTE maybe it writes missing file here. Needs more thinking
}//e1
var runFns = !logErrorReported && setWLN();
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function setWLN(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg.wln || logError(new Error());
var newNodes = <t></t>;
var saveChangesOfLayoutRequired = false; // at the end of this ftn, it will run what ever it needs to repair or update
var wdn = getTree(catg.wdn);
var wln = getTree(ctg,"clear");

wln.control.@sub_type_child_name = "";
buildTreeColumns(wln.control);
bugFixTreeUnClicked(wln.control);


// find the selected templete css and wss(wegitStyleSheet) file
// then, try and create and XML obj of the the wss file.
// if it fails to create and xml obj of the wss file, then do the following
// by putting the wss file code into a blank div to Parse it first as Dom
// dw has no createElement or document.implementation.createDocument or new DOMParser()
// so putting the code into a div will clean up the code. It is nessary, because
// putting poorly formed code directly into a new XML object can cause a error and/or crash the program.
// Any returned code from the div will have all it's element attributes names in lower case.
var tdnNum =  wdn.selNode && wdn.selNode.@tdn_num;
var tdnCssCode = tdnNum && getFileInStackSite("/t/"+tdnNum+"/g.css",false);
var tdnWssCode  = tdnNum && getFileInStackSite("/t/"+tdnNum+"/c.js",false);

// if  a wdn page node is selected do the following
if(tdnCssCode && tdnWssCode && tdnWssCode.indexOf("<b")>-1 && tdnWssCode.indexOf(">")){//if_1

try{//try1
tdnWssCode = tdnWssCode.substring(sdnMFile.indexOf("<"),tdnWssCode.lastIndexOf(">")+1);
tdnWssCode = new XML("<div>"+tdnWssCode+"</div>");
}//try1
catch(err){//catch1
try{//try2
//NEEDED need to put some type of correction here. Usally it needs to separate the attributes from the element's attribute quotes
// it should try to fix it with regEx or a JS method which converts HTML to XML. For now I'm going to flush it in a div using innerHTML,
// because DW has no JS FTN which works and converts HTML to XML, and regEx is just to much of a mess to get to work. 
var flushHolder = getVformElmById("flushHolder");
flushHolder.innerHTML = tdnWssCode;
tdnWssCode = new XML("<div>"+flushHolder.innerHTML+"</div>");
flushHolder.innerHTML = "";
}//try2
catch(err){//catch2
//MAYBE NEEDED could try build the pages from the file system and put them in one long list
tdnWssCode = false;
return logError(err);
}//catch2
}//catch1

tdnWssCode.@elmNum = "tree";
var newErrorMsgs = "";
var wgtElementCount = 0;

for each(var wgtElement in tdnWssCode..b){//for_1
var newNode = createTreeNode();
wgtElement.@elmNum = wgtElementCount; // this helps find the parent node ////NN this could be done on the program load
var wgtValues = wgtElement.@zs || false;

// If any of the wgtValues have any blank spaces, repair it, and alert the user it was fixed.
// Also create error messages for the program's log file for the blank space.
if(wgtValues && wgtValues.indexOf(" ")>-1){
alert("blnkV1: "+ "A potential problem with displaying this page was corrected.");
logChange(new Error("blnkV1 found blank spaces in wgtValues:"+wgtValues+" Action taken: removed blank spaces."));
saveChangesOfLayoutRequired = true;
wgtValues = wgtValues.replace(/ /g,"");
}
wgtValues =  wgtValues && wgtValues.split("$") || false;

var wlnLib=wgtValues && getLibNode(catg.wln,wgtValues[2]) || false;
var wgtSelectorNames = wlnLib && wlnLib.wgtSelectorNames;

// clear any error messages which may have been set before on the window element
if(wgtElementCount==0||wgtValues[2]=="101"){
if(notBlank(wgtElement.@errormsgs) && wgtElement.@errormsgs != "false"){
saveChangesOfLayoutRequired = true;
}
}

// If item can not be found in the lib, then convert it to the "e" error item, which can not be repaired and can only be deleted.
// Also create and write a error messages to the newErrorMsgs and the program log.
if(!wlnLib || wlnLib.typeNum=="e"){//if_has_error
// Write error to the newErrorMsgs.
newErrorMsgs += "Error: Document item "+ wgtElementCount +" does not exist. <br />";
// Log the error to the program.
(wlnLib.typeNum=="e")? null : logChange(new Error("failed to find wgtValues[2]):"+wgtValues[2]+" for:"+ctg.pF+ " changed typeNum to:e"));
// Change and convert the item to a error item.
wlnLib = getLibNode(catg.wln,"e");
wgtValues = wlnLib.wgtDefault0;
wgtSelectorNames = wlnLib.wgtSelectorNames;
saveChangesOfLayoutRequired = true;
}//if_has_error

/*
// or if the length is incorrect
else if(wgtSelectorNames && !wgtValues[wlnLib.wgtSelectorNames.length-1]){//if_has_error
// write errors to the wgtWindowElm
// newErrorMsgs += "Error-set-wln-length found on Document item: "+wgtSelectorName+ ", needs repair. <br />";
//newNode.@n_name = "Needs Repair";
// log the error to the program
logChange(new Error("repaired zs attribute was short on wgt values :"+wgtElement.outerHTML));
saveChangesOfLayoutRequired = true;
}//if_has_error
*/
//get the wgtDefault values using the subTypeNum. If it can not be found, use the wgtDefault0.
var wgtDefaults = (wlnLib["wgtDefault"+parseInt(wgtValues[3])])? wlnLib["wgtDefault"+parseInt(wgtValues[3])] : wlnLib["wgtDefault0"];
//set the wgt selector attributes on the node being created
var ii = 0;
for each(var wgtSelectorName in wgtSelectorNames){//for2
//if a wgtValue requires using the default lib value and it does not match, replace it with the correct one.
//alert("wgtValues[ii]:"+wgtValues[ii] +" wgtDefaults[ii]:"+wgtDefaults[ii]);
if(wlnLib.wgtRuleTypes[ii]!=0 && wgtValues[ii] != wgtDefaults[ii]){
logChange(new Error("repaired incorrect Required wgtValue"+ii+":\""+wgtValues[ii]+"\" != wgtDefault"+ii+":\""+wgtDefaults[ii]+"\" for:"+wgtElement.toXMLString()));
newNode.@[wgtSelectorName] = wgtDefaults[ii];
saveChangesOfLayoutRequired = true;
//newNode.@n_name = "Needs Repair";
// newErrorMsgs += "Error-wln-default found on Document item: "+wgtSelectorName+ ", needs repair. <br />";
}
else{
newNode.@[wgtSelectorName] = wgtValues[ii];
}
ii++;
}//for2

// get and test selector if it is using the correct letters and they R in the right order too.
// css_selector is the wgtValues[4])]
var cssSelector = notBlank(newNode.@css_selector);
var cssSelectorNumber = cssSelector && parseInt(cssSelector.substring(1));
(cssSelectorNumber !="NaN")? null : cssSelectorNumber = false;
newNode.@css_selector_number= cssSelectorNumber || "";

// NOTE this could be put on the end of a cssSelector during saving to let this ftn know this item is using another objects css rule with this selector.
// it can only be used on objects with no hover and stuff on it. I think there must be a better way to get object to share rules I'm thinking  
//  var isCssSelectorNative = cssSelector.indexOf("R")>0;


// "" = false, and item has no cssSelectors
// 0 = 0 (i.e. this would be the actually number 0)
// tagName = this is the name of it's tagname, and uses the cssSelectorName which is the items tagname
// namElmNum = uses the cssSelectorName + useCurrentElementNumber
// namElmParNum = useCurrentElementParentNumber
// namElmParNum+1 = useCurrentElementParent + 1
// tagNam = "" (this means it will not have a selector number, and the number will be blank, and use the elements tagname, which is in the cssSelectorNames.


//set the cssSelector Identifiers on the nodes being created
for each (var cssSelectorName in wlnLib.cssSelectorNames){//for3
var cssRule = "";
var cssSelectorX = "false";

// if it's using a colon ":" selector. ie(:hover and etc)
if(cssSelectorName.indexOf(":") > -1 && cssSelectorNumber){//e3
cssSelectorX = "q" + cssSelectorNumber + cssSelectorName.split(":")[0] +"]:" + cssSelectorName.split(":")[1];
}//e3
// if it's using a tagname selector. ie(body and etc)
else if(wlnLib.cssSelectorType == "tagNam"){//e4
cssSelectorX = cssSelectorName;
}//e4
// if it's using a braket search [] selector. ie(*[zs*="q5c"] )
else if(cssSelectorNumber){//e5
cssSelectorX = "q" + cssSelectorNumber + cssSelectorName+"]";
}//e5

if(cssSelectorX){//ifyy
var re = new RegExp(cssSelectorX+ "[\\W]*\\{[^}]+\\}", "i"); //  this is it literially  /.tabs[\W]+\{[^}]+\}/i
cssRule = tdnCssCode.match(re); // matches each css rule based on the class name
cssRule = cssRule && cssRule+"" || " "; // add a space at the end to make it a text string
newNode.@["q" + cssSelectorName] = cssRule && cssRule!=" " && cssRule.slice((cssRule.indexOf("{")+1),-1) || " ";
//alert("newNode.@['q' + cssSelectorName]: "+newNode.@["q" + cssSelectorName]);
}//ifyy
else{//ifZZ
newNode.@["q" + cssSelectorName] = " ";
}//ifZZ
}//for3

//Set the sub_type_child_name : Child Type pre Name
// In the update ftn, some treenodes will grab this info to add to the front of item names.
// For example, Row or Column will be added to the front of the name because it's parent
// node is a page item with rows. This lets all the child nodes know it's a row. The parents
// name would be page w/rows and it's children names would be row w/? Where "?" is what ever
//  it really is, which could be a menu or row or column or content and etc. 
// If the the parent has no pre child name to use, then it will use no pre child name
//alert(wlnLib.subTypeChildNames +" ||||| "+ wlnLib.subTypeChildNames[parseInt(wgtValues[3])]);
newNode.@sub_type_child_name=(notBlank(wlnLib.subTypeChildNames[parseInt(wgtValues[3])]))?wlnLib.subTypeChildNames[parseInt(wgtValues[3])] + " " : "";

//alert(notBlank(wlnLib.subTypeChildNames[parseInt(wgtValues[3])]) +" ||| "+ newNode.@sub_type_child_name.toString().length);
//alert(wlnLib.subTypeNames[wlnSubTypeNum] +" ||| "+ newNode.@sub_type_name.toString().length);
// alert(wlnLib.subTypeNames[wlnSubTypeNum] +" ||| "+ wlnLib.subTypeNames[wlnSubTypeNum].length);


//Set the sub_type_name : the sub type name
// In the update ftn, some treenodes will grab this info to add to the end of item names.
// For example, w/Rows or w/Columns will be added to the end of the item's name because it's a box
// node which can have it's children orientation set as rows or columns.
// If the Items parent has no sub_type_child_name(pre child name) to use, then the item will use
// it's sub_type_name
//alert(wlnLib.subTypeChildNames +" ||||| "+ wlnLib.subTypeChildNames[parseInt(wgtValues[3])]);
newNode.@sub_type_name=(notBlank(wlnLib.subTypeNames[parseInt(wgtValues[3])]))? wlnLib.subTypeNames[parseInt(wgtValues[3])] : "";

newNode.@id= ctg.pF+Math.random().toString().replace(".","");
newNode.@elm_num= wgtElementCount;
newNode.@state= "expanded"; // only set to expanded bc it help me with testing// needs to go back to collapsed.
//newNode.@state= "collapsed";
newNode.@hash_val = wlnLib.hashVal;
newNode.@wpn_set_elm = wlnLib.wpnSetElm;
//0199* newNode.@value= newNode.@n_name "|" +  wgtElementCount;
var placeNum = parseInt(wgtElement.parent().@elmNum);
(isNaN(placeNum))? newNodes.appendChild(newNode) : newNodes.descendants("zztreenode")[placeNum].appendChild(newNode);
wgtElementCount++;
}//for_1
wln.control.appendChild(newNodes.children());
}//if_1

//write any errorMsgs that might exist to the first layoutElm
if(wln.control.zztreenode[0]){
wln.control.zztreenode[0].@error_msgs = notBlank(newErrorMsgs) || "false";
}

//save repaired fixes, updates, and any errors that were found.
if(saveChangesOfLayoutRequired){
var runSaveFixes = (saveWLN(catg.wln));
logChange(new Error((runSaveFixes)? "Sucessfully saved repairs and updates for setWLN" : "FAILED to save repairs and updates for setWLN"));
}

writeTestingPage(true,"setWlnTree.txt",wln.control.toXMLString());
var runFns= !logErrorReported && treeColNeedsUpdate() && updateTree("wln") && setWPN("wpn");
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}


function setWPN(ctg){ // creates the WuiDirectoryNodes in a menu tree.
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wln = getTree(catg.wln);
var wpn = getTree(ctg,"clear");

buildTreeColumns(wpn.control);
bugFixTreeUnClicked(wpn.control);

if(wln.selNode){//ifHasSelected i think wlnLib.nTypeNum=="e" could go here

wln.selNodeLib = getLibNode(catg.wln,wln.selNode.@n_type_num);
// this would be the tag named "visual" in a xml wpn lib tag named set
wpn.selNodeLib = getLibNode(ctg,"v");
var newNodes = new XML(wpn.selNodeLib.node);

// loop each layout property node and create a newTreeNode for it
for each(var newNode in newNodes..*){//for1
var wpnLib = getLibNode(ctg," ",newNode.@hashVal);
//alert("3.wpnLib.pIDAN:"+wpnLib.pIDAN);
var wpnPidanLength = wpnLib.pIDAN && wpnLib.pIDAN.length || 0; //NEEDED (haspIDAN)?
var wpnPidanIsCss =  wpnLib.pIDAN[0].indexOf("C") == 0; //wpnLibIsCSS 
var wpnViewableValue = " ";
var wpnRuleType = " ";
var wpnWgtValue =" ";
var wpnCssValue = " ";
//alert("1.wpnLib:"+wpnLib);

// CSS
if(wpnLib.cssSelectorName){//ifCSS
wpnCssValue = setWpnCssRule(wpnLib.cssProperty,wln.selNode.@["q"+wpnLib.cssSelectorName]) || " ";

// Css Value which view it's actually value to the user
if(wpnLib.pIDAN[0] == "C"){//ifcss1
wpnViewableValue = wpnCssValue;
wpnRuleType = "CSS";
}//ifcss1
// Css Values which uses the vOPT, usally for aligning elements within a element 
else if(wpnLib.pIDAN[0] == "C1"){//ifcss2
for each(var vOPT in wpnLib.vOPT){
(vOPT[1] == wpnCssValue)? wpnViewableValue = vOPT[0] : null;
}
wpnRuleType = "CSS";
}//ifcss2
// Css value witch needs quotes removed from it ends, usally for the css :before and :after {content:"Hello"} 
// and replace any pipe char with the special pipe char &Iota; for the wpnViewableValue string
else if(wpnLib.pIDAN[0] == "C2"){//ifcss3
wpnViewableValue = removeEndQuoteMarks(wpnCssValue);
//100021 wpnViewableValue = wpnViewableValue.replace(/\|/g,"l");
wpnRuleType = "CSS";
}//ifcss3

//change misc lang that the users may see as a ViewableValue
//this also is used to replace pipe char("|") to a lowercase(L) "l" so the treenode column can accept it.
//Basically, TreeNodes use pipes in values to make colums in a treenode// so it needs to replace pipes(|)s with a small L char.
if(wpnLib.wordReplace && notBlank(wpnViewableValue)){//wordReplace
for each(var word in wpnLib.wordReplace){
var re = new RegExp(word[1],"g");
wpnViewableValue.replace(re,word[0]);
}
}//wordReplace
}//ifCSS

//WGT
//propetryThatDontNeedToUseAValue
if(!wpnPidanIsCss && wpnLib.vDPV ==7){
var setWpnWgtValues = setWpnWgtRule(wpnLib,"");
wpnRuleType = "WGT";
wpnWgtValue = setWpnWgtValues[0];
wpnViewableValue = setWpnWgtValues[1];
}//propetryThatDontNeedToUseAValue

//propertyHasNoSubProps and no underscores
else if(!wpnPidanIsCss && wpnPidanLength==1){
// maybe this does not need to test for wpnLib.wgtSelectorName but good to have it just in case
wpnWgtValue = wpnLib.wgtSelectorName && wln.selNode.@[wpnLib.wgtSelectorName] || "";
var setWpnWgtValues = setWpnWgtRule(wpnLib,wpnWgtValue);
wpnRuleType = "WGT";
wpnWgtValue = setWpnWgtValues[0]; // could put a log error here, but the int should really catch it
wpnViewableValue = setWpnWgtValues[1] || " ";
}//propertyHasNoSubProps and no underscores

//hasUnderscore
else if(wpnPidanLength>1){
wpnWgtValue = wpnLib.wgtSelectorName && wln.selNode.@[wpnLib.wgtSelectorName] || "";
var useWgtValueX = "";
var wlnIdRuleXs=wpnWgtValue.indexOf("_")>-1 && wpnWgtValue.split("_") || false;

if(wlnIdRuleXs){//if14
var wpnTagPidan1 = parseInt(wpnLib.pIDAN[1]);
var wpnTagPidan2 = parseInt(wpnLib.pIDAN[2]) || 0;

if(wpnPidanLength ==2){//if1a one _
useWgtValueX = notBlank(wlnIdRuleXs[wpnTagPidan1]) || wpnTagPidan1;
}//if1a

else if(wpnPidanLength == 3){//if15 two _
var wlnIdRuleX = !isBlank(wlnIdRuleXs[wpnTagPidan1]) && wlnIdRuleXs[wpnTagPidan1];
if(wlnIdRuleX !== false && !isBlank(wpnTagPidan2) && !isBlank(wlnIdRuleX.charAt(wpnTagPidan2))){//if17
useWgtValueX = wlnIdRuleX.charAt(wpnTagPidan2);
}//if17
}//if15
}//if14

var setWpnWgtValues = setWpnWgtRule(wpnLib,useWgtValueX);
wpnRuleType = "WGT";
wpnWgtValue = setWpnWgtValues[0]; // may need a or || condtion here for blank 
wpnViewableValue = setWpnWgtValues[1] || " ";
}//hasUnderscore

newNode.@n_type_num=newNode.@id;// this line must be above setting the @id
newNode.@id= ctg.pF + wpnLib.cssSelectorName +"q"+ Math.random().toString().replace(".","");
//alert("wpnLib.toSource():"+wpnLib.toSource()); // property_type // property_langage rule
newNode.@n_name=wpnLib.vV;
newNode.@viewable_value=wpnViewableValue;
newNode.@rule_type=wpnRuleType;
newNode.@wgt_value=wpnWgtValue;
newNode.@css_value=wpnCssValue || "";
newNode.@hash_val = wpnLib.hashVal;
newNode.@state= "expanded"; // only set to expanded bc it help me with testing// needs to go back to collapsed.
newNode.@value=wpnLib.vV+"|"+wpnViewableValue;
// newNode.@icon="3";
newNode.setName("zztreenode");
(newNode.hasSimpleContent())? newNode.appendChild(" ") : null;
}//for1
wpn.control.appendChild(newNodes.children());
}//ifHasSelected

var runFns = !logErrorReported && treeColNeedsUpdate() && updateTree("wpn");
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}


function setWpnCssRule(cssProperty,wlnCssRule){
// get the css value from the css rule declaration
// returns the rule, or if no rule then it returns false
var logFtn=LogFtn(new Error(),1,1,1,-1);
var cssValue = "";
///alert("cssProperty:"+cssProperty+ " ||||||| wlnCssRule:"+wlnCssRule);

// most of the time the last css declaration will come with no semicolon at the end, so one is added below to the end of wlnCssRule
if(cssProperty && notBlank(wlnCssRule) && wlnCssRule.indexOf(cssProperty)>-1){//if1
var re = new RegExp(cssProperty + "[\\W]*\\:[^;]+\\;", "i"); // this is it literially  /.tabs[\W]+\{[^}]+\}/i
cssValue = (wlnCssRule+";").match(re); // matches the css value based on the css declaration property
cssValue = cssValue && cssValue+""; // add a space at the end to make it a text string
cssValue = cssValue && cssValue.slice((cssValue.indexOf(":")+1),-1) || ""; // cut off the colons

//if not blank remove all double blank spaces with single blank spaces and remove any end blank spaces
if(notBlank(cssValue)){//if2
cssValue = removeDbBlankSpaces(cssValue);
cssValue = removeEndBlankSpaces(cssValue);
}//if2
return LogFtnReturn(logFtn) && cssValue;
}//if1
else{//else1
return LogFtnReturn(logFtn) && false;
}//else1
}

function setWpnWgtRule(wpnLib,wpnWgtValue){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var wpnLibDPV = wpnLib.vDPV;
var wpnViewableValue = " ";
var noErrors = 1; // just here 4 testing while I develop. Can be remove when I'm done

// gets the value from the vOpt // align
// it needs to test if the wpnWgtValue is larger than the wpnLib.vOPT.length.
// if it uses the wpnLib.vOPT.length as the wpnWgtValue. I don't think this is a good way,
// but it's the best one I can think of. The scripts for the webpages will need to select the highest option if it doesn't already.
if(wpnLibDPV == 1){
for each(var vOPT in wpnLib.vOPT){
//alert("vOPT[1]:"+vOPT[1] +" ||||| "+"wpnWgtValue:"+parseInt(wpnWgtValue));
//alert(vOPT[1]==parseInt(wpnWgtValue));
(parseInt(vOPT[1])==parseInt(wpnWgtValue))? wpnViewableValue = vOPT[0] : null;
}
}

// not being used // needs to be removed
else if(wpnLibDPV == 2){
alert("not used 123");
}
// not being used // needs to be removed
else if(wpnLibDPV == 3){
alert("not used 345");
}
// Folder numbers for 4=border(b) || 5=snipit(n)  || 10=menu(m) 
else if(wpnLibDPV == 4 || wpnLibDPV == 5 ||  wpnLibDPV == 10){
var xType = (wpnLibDPV == 4)? "b" :  (wpnLibDPV == 5)? "n" : "m"; 
wpnWgtValue=parseInt(wpnWgtValue) || 0;
var npn =wpnWgtValue&&wpnWgtValue!= "0"&&getTree(catg[xType+"dn"]).control..zztreenode.(@id == xType+"dn"+wpnWgtValue);
var npnName = npn && npn.@n_name || " "; // needs to check if 
wpnViewableValue = (wpnWgtValue && wpnWgtValue != "0")? wpnWgtValue+"."+npnName : " ";
// alert("wpnLibDPV4-"+" wpnWgtValue:"+ wpnWgtValue + " wpnWgtValue:"+wpnWgtValue + " wpnViewableValue:"+wpnViewableValue);
}
//background borders // not used anymore
else if(wpnLibDPV == 6){
wpnViewableValue = 0;
for each(var vOPT in wpnLib.vOPT){
(parseInt(vOPT[1])==parseInt(wpnWgtValue))? wpnViewableValue = vOPT[0] : null;
}
//100020 wpnWgtValue =  wpnWgtValue && 1 || 0;
//100020 wpnViewableValue = wpnLib.vOPT[wpnWgtValue];
//alert("wpnLibDPV6-"+" wpnWgtValue:"+ wpnWgtValue + " wpnWgtValue:"+wpnWgtValue + " wpnViewableValue:"+wpnViewableValue);
}
// mostly for nodes, like General that have no display values right of the first colum
else if(wpnLibDPV == 7){
wpnViewableValue = " ";
//alert("wpnLibDPV7-"+" wpnWgtValue:"+ wpnWgtValue + " wpnWgtValue:"+wpnWgtValue + " wpnViewableValue:"+wpnViewableValue);
}
// Error if it could not be found
else{
wpnViewableValue = false;
}

// Error handling maybe should just avoid saying  error. Instead, the property row should be blank. 
// Error is here just for testing
wpnViewableValue= noErrors && wpnViewableValue || "Error:WGT";
var returnArray = [wpnWgtValue, wpnViewableValue];
return LogFtnReturn(logFtn) && returnArray;
}

function setTree(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var dn = getTree(ctg,"clear");
if(logErrorReported){return false;}

buildTreeColumns(dn.control);
bugFixTreeUnClicked(dn.control);

//list Folders
var dnFolder = getPathInSS(ctg.a);
var dnFolders= stackRoot&&dwFileExist(dnFolder) && dwFileListFolder(dnFolder,"directorys");
var dnFoldersList=[]; // should be called dnFolderArr

//create a array and sort it, of any file that would be part of stacksite
for each(var dnNumX in  dnFolders){//dir
var uFileCode = dnNumX.search(/[^0-9]/) < 0 && dwFileExist(dnFolder+dnNumX+"/u.js");
if(!uFileCode){continue;}
var nFileCode= dwFileExist(dnFolder+dnNumX+"/n.text") && DWfile.read(dnFolder+dnNumX+"/n.text");
var nFileXML= nFileCode && new XML(nFileCode) || false;
var dnNameX = nFileXML && nFileXML.name && notBlank(nFileXML.name);
(dnNameX && dnNameX.search(/\W/) > -1)? dnNameX = "":null; // makes sure it has only letters
var dnVersionX = nFileXML && nFileXML.version && notBlank(nFileXML.version);
(dnVersionX && !parseFloat(dnVersionX))? dnVersionX = "":null; // makes sure it has only a number

//NOTE maybe test for other various files here with a if before adding it to the array and a option to correct any errors
dnFoldersList.push([dnNameX,dnNumX,dnVersionX]);
}//dir

dnFoldersList.sort( sortArray([2,1,0]));


if(ctg.a == "m"){
//alert(dnFoldersListLength +"||||"+ dnFoldersList);
//alert(dnNameX+"|"+dnNumX+"|"+dnVersionX);
}

//alert(dnFoldersList);
//Build the nodes
for each(var folderArr in  dnFoldersList){//folderArr
var newNode = createTreeNode();
var dnUfileCodes=getFile(dnFolder+folderArr[1]+"/u.js",false);
dnUfileCodes= dnUfileCodes&&dnUfileCodes.indexOf("StackSite") && getSubStringWithIn('"','"',dnUfileCodes);
dnUfileCodes =  dnUfileCodes&&dnUfileCodes.indexOf("_") && dnUfileCodes.split("_");
var dnLib = getLibNode(ctg,parseInt(dnUfileCodes[0]));
if(logErrorReported){return false;}
var dnId = ctg.pF+folderArr[1];
var dnNum= folderArr[1];
var dnVname = folderArr[0] || dnLib.dName;

var dnTypeNum = dnLib.typeNum;
var dnTypeNumSub = dnUfileCodes[1] || " ";
var dnTypeName = dnLib.tyNme;
var dnTypeDescription =  dnLib.tyDes;
var dnInUseQty = 0;
var dnSelected = "false";
var dnVersion = parseFloat(folderArr[2]) || .01;

// set the page link // this is the page that will show in the browser window
var dnLink = dnLib.nLink && "stacksite/"+ctg.a+"/"+dnNum+"/"+dnLib.nLink || "";

if(ctg.pF=="wdn"){//if1
//set layouts and it's inUseQty
var tdn = getTree(catg.tdn);
newNode.@dn_layouts= dnUfileCodes && notBlank(dnUfileCodes[2]) || "";
var tdnNums = getStringArraySplit(newNode.@dn_layouts,"-");
for each(var tdnNum in tdnNums){
var tdnNode = tdn.hasNodes && tdn.control.zztreenode.(@id == "tdn"+tdnNum)[0] || false;
(tdnNode)? tdnNode.@in_use_qty = parseInt(tdnNode.@in_use_qty)+1 : null;
}
//set script node inuseQty up one if it exist, if script is missing and doesn't exist then add it.
var jdn = getTree(catg.jdn);
for each(var jdnNum in dnLib.uScripts){//forscr
var jdnNode = jdn.hasNodes && jdn.control.zztreenode.(@id == "jdn"+jdnNum)[0] || false;
if(jdnNode){
jdnNode.@in_use_qty = parseInt(jdnNode.@in_use_qty)+1;
}
else{
// off bc I don't want it over writing any changes I make to the script in the current stacksite folder
//off var runFns=add_DN(catg.jdn,"jdn"+jdnNum,jdnNum);
}
}//forscr
}//if1

else if(ctg.pF=="tdn"){//elseif2
//set menus
var mdn = getTree(catg.mdn);
newNode.@n_menus = dnUfileCodes && notBlank(dnUfileCodes[2]) || "";
var mdnNums = getStringArraySplit(newNode.@n_menus,"-");
for each(mdnNum in mdnNums){
var mdnNode = mdn.hasNodes && mdn.control.zztreenode.(@id == "mdn"+mdnNum)[0] || false;
(mdnNode)? mdnNode.@in_use_qty = parseInt(mdnNode.@in_use_qty)+1 : null;
}

//setSnipits
var ndn = getTree(catg.ndn);
newNode.@n_snipits= dnUfileCodes && notBlank(dnUfileCodes[3]) || dnUfileCodes[3]; //might be wrong || ""
var ndns = getStringArraySplit(newNode.@n_snipits,"-");
for each(var ndnNum in ndns){//for1
var ndnNode = ndn.hasNodes && ndn.control.zztreenode.(@id == "ndn"+ndnNum)[0] || false;
(ndnNode)? ndnNode.@in_use_qty = parseInt(ndnNode.@in_use_qty)+1 : null;
}//for1

//setScripts
var jdn = getTree(catg.jdn);
newNode.@n_scripts= dnUfileCodes && notBlank(dnUfileCodes[4]) || dnUfileCodes[4]; //might be wrong || ""
var jdnNums = getStringArraySplit(newNode.@n_scripts,"-");
for each(var jdnNum in jdnNums){//for1
var jdnNode = jdn.hasNodes && jdn.control.zztreenode.(@id == "jdn"+jdnNum)[0] || false;
(jdnNode)? jdnNode.@in_use_qty = parseInt(jdnNode.@in_use_qty)+1 : null;
}//for1
}//elseif2


// set node info
newNode.@id=dnId;
newNode.@n_num=dnNum;
newNode.@n_link=dnLink;
newNode.@n_name=dnVname;
newNode.@n_type_num=dnTypeNum;
newNode.@n_type_num_sub=dnTypeNumSub;
newNode.@n_type_name=dnTypeName;
newNode.@n_type_description=dnTypeDescription;
newNode.@in_use_qty=dnInUseQty;
newNode.@n_version=dnVersion;
newNode.@hash_val = dnLib.hashVal;
//newNode.@value= dnVname+"|"+dnTypeName +": ";

if(ctg.pF!="wdn"){// wdn only needs to update the layouts in use when first loading a chosen site
dn.control.appendChild(newNode);
}
//(ctg.a == "n")? alert("newNodes:"+newNodes) : null;
}//folderArr

return LogFtnReturn(logFtn);
}

function setVForm(ctg,shouldRefresh){

// shouldRefresh: Boolean. // maybe not needed but I'll keep it here just in case.

var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());

//REFRESH******************************************************************
// Refresh the vForm if all went well
// (OPEN) A string.replace or xml.setName(). I'm don't know which one is faster. Will need testing on large trees.
// (OPEN) document.getElementById("vForm").innerHTML = frm.replace(/zztree/g,"mm:tree");
// (OPEN) the frm var below may need to use the copy() method
//alert(document.getElementById("vForm").innerHTML);
//writeTestingPage(true,"setFormVarFrmXML.js","var x ="+frm.toXMLString());
if(!logErrorReported&&shouldRefresh){//if1
var frm = new XML(zForm[ctg.a]);
if(ctg.pF=="wdn"){// just here for testing
}
for each(var elm in frm..*){//for1
if(elm.nodeKind()!="element"){continue;}//if2//if2
var elmName = elm.name();
if(elmName=="zztreenode"){
elm.setName("mm:treenode");
}
else if(elmName=="zztreecolumn"){
elm.setName("mm:treecolumn");
}
else if(elmName=="zztreecontrol"){
elm.setName("mm:treecontrol");
}
}//for1

// 
// borders has an browsercontrol.
// It's not put above for speed. It's the only form with a browsercontrol. 
if(ctg.a=="b"&&controlBrowserOn){//if2
for each(var elm in frm..*){//for1
if(elm.nodeKind()!="element" || elm.name()!="zzbrowsercontrol"){continue;}//if3//if3
elm.setName("mm:browsercontrol");
}//for1
}//if2

document.getElementById("vForm").innerHTML = frm.toXMLString();

if(ctg.a=="b"&&controlBrowserOn){setTimeout("setVFormBrowserControls()",500);}
LogFtnReturn(logFtn);
logFileNum = 0;
logErrOn = false;
logFtnOn = false;
functionIsRunning = false;
return true;
}//if1
// ERROR HAPPEN*********************************************************************
//NEEDED it needs to call a error screen to email the errors to zoshe
// and recover from the error, and undo anything it changed
// Then have it go back to it's all state if possible, or reload the program.
// Make a suggestion to run a program repair to try to fix it if the problem persist.
else if(shouldRefresh||logErrorReported){//if2
logError(new Error("shouldRefresh failed for:"+ ctg.pF));
logFileNum = 0;
logErrOn = false;
logFtnOn = false;
functionIsRunning = false;
return false;
}//if2
// NO REFRESH***********************************************************************
else{//if3
LogFtnReturn(logFtn);
logFileNum = 0;
logErrOn = false;
logFtnOn = false;
functionIsRunning = false;
return true;
}//if3
}

function setVFormBrowserControls(){
// this will handle resetting any browsercontrols found in the current Vform
// this ftn is a work around bc DW will not reset the browsercontrol's url location when adding by DOM.
// needsToOpenURL is set to parentNode bc browsercontrol hates and bugs out on attibutes is does not know.
//BUG NOTE for each() MM:BROWSERCONTROL mac osx bug. The for each will loop more then the number of actual MM:BROWSERCONTROL elements. The work around: Use a standard for loop.
var logFtn=LogFtn(new Error(),1,1,1,-1);
var browserControls = getVformElementsByTagName("MM:BROWSERCONTROL");

for(var i = 0; i< browserControls.length; i++){//for1
var browserControl = browserControls[i];
var parentElm = browserControl.parentNode;
var needsToOpenURL = parentElm.getAttribute("needs_to_open_url");
if(!isBlank(needsToOpenURL)){
//Important  openURL needs to go first here // mac bugs out if it's not set first
//alert("needsToOpenURL:"+needsToOpenURL);
browserControl.openURL(needsToOpenURL);
parentElm.setAttribute("needs_to_open_url"," ");
parentElm.firstChild.innerHTML = zLang._PreviewCol;
}
}//for1

LogFtnReturn(logFtn);
//writeTestingPage(true,"hFormDocOuterHTML.txt",getElmById("hFormHolder").getWindow().document.documentElement.innerHTML);
}

function updateTree(ctg){
// update treecontrol
//(ctg =="tdn")? alert("001:"+colsNeedUpdating) : null;

var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
if(logErrorReported){return false;}
var hasRoot = siteRoot&&stackRoot;

// get tree control stuff
var dn = getTree(ctg);
if(logErrorReported){return false;}

////BUG FIX MAC OSX. Fixes the onclick of the first tree node, which would lose it's state sometimes
if((ctg.pF=="wln"||ctg.pF=="wpn") && dn.hasSelNode){
var vFirstTreeNode = getVformTree(ctg.pF).getElementsByTagName("MM:TREENODE")[0];
dn.control.zztreenode[0].@state=isBlank(vFirstTreeNode)&&"collapsed"||vFirstTreeNode.getAttribute("state");
}

if(ctg.pF == "bdn"){
//alert(dn.toSource());
//(dn.hasSelNode)? alert("1: "+ dn.selNodeLibId) : alert("00")
}

// set the selNodeLib n_type_num
// find the right o_opt and o_sel to use and set it on the treecontrol
// 00 is the treecontrol and it also means the tree has no selected node 
dn.selNodeLib = (dn.hasSelNode)? getLibNode(ctg,dn.selNode.@n_type_num) : getLibNode(ctg,"00");
//(ctg.pF=="wpn")? alert("dn.selNodeLib:"+dn.selNodeLib.oOpts.toSource()) : null;
//alert((dn.hasSelNode)? getLibNode(ctg,dn.selNodeLibId) : getLibNode(ctg,"00"));
if(ctg.pF == "bdn"){
//alert("2");
//(dn.hasSelNode)? alert("1: "+ dn.selNodeLibId) : alert("00")
}

if(ctg.pF=="bln"){
if(!dn.hasSelNode){//NOTE may not need this if
var bdn = getTree(catg.bdn);
(bdn.selNode)? null : dn.selNodeLib.oOpts = false;
}
}
else if(ctg.pF=="wln"){
if(!dn.hasSelNode){
var wdn = getTree(catg.wdn);
(wdn.selNode)? null : dn.selNodeLib.oOpts = false;
}
}
else if(ctg.pF=="wpn"){

//100016 if(!dn.hasSelNode){
//100016 var wln = getTree(catg.wln);
//100016 (wln.selNode)? null : dn.selNodeLib.oOpts = false;
//100016 }

//alert("dn.selNodeLib.toSource():"+dn.selNodeLib.toSource());
//alert("dn.selNodeLib.oOpts:"+dn.selNodeLib.oOpts);
}
//NOT USED, but could be used for something ie a 30 day demo runs out or it needs a newer version to open this site
else if(ctg.pF=="sdn"){
if(2==1){
dn.selNodeLib.oOpts = false;
}
}
//0284 else if(ctg.pF=="wdn"){
//0284 if(dn.hasNodes && !dn.hasSelNode || !hasRoot){
//0284 dn.selNodeLib.oOpts =  false;
//0284}
//0284}
else{ // bdn, and all others
if(!hasRoot){
dn.selNodeLib.oOpts =  false;
}
}
/* 0304
// set the tool bar to blank for ndn, others may need this too.
if(ctg.pF=="ndn"){
//alert(zForm[ctg.a].*.(@id==ctg.pM+"Table0")[0].tr.td[1].toXMLString());
zForm[ctg.a].*.(@id==ctg.pM+"Table0")[0].tr.td[1].setChildren(" ");
//zForm[ctg.a].*.(@id==ctg.pM+"Table0")[0].tr.td[1].setChildren(new XML(" "));
}
*/
//Set the option menu
var __o = {};
var oCat = {a:ctg.a, b:ctg.b, c:"o", pF:ctg.pO};
var optArr = [];

// Find the option menu to select 
if(!dn.selNodeLib.oOpts){// has no options
// alert("found A False dn.selNodeLib.oOpts for:"+ctg.pF);
 __o.selNodeLib = getLibNode(oCat,"00");
 __o.selNodeLib.eElms = false;
dn.control.@o_sel = "0";
}
else{// has options
var previous_oSel = dn.control.@o_sel+"";

// set it to the default
 __o.selNodeLib = getLibNode(oCat,dn.selNodeLib.oSel);// set it to the default
dn.control.@o_sel = dn.selNodeLib.oSel;
//Build an array of options, and select option if it matches the previous option type, then sort them
for each(var oOpt in dn.selNodeLib.oOpts){//for1
var doLib= getLibNode(oCat,oOpt);
if(logErrorReported){return false;}
var optType = oOpt.indexOf("q") && oOpt.split("q")[0] || -1;
if(previous_oSel.indexOf(optType)==0){
__o.selNodeLib = doLib;
dn.control.@o_sel = oOpt;
}
optArr.push([doLib.vV,oOpt]);
}//for1
//sort the option menu array
optArr.sort();
}// has options
dn.optArr = optArr;
//(oCat.pF=="sdo")? alert(oCat.pF+":::"+ dn.control.@o_sel):null;
//(oCat.pF=="sdo")? alert(oCat.pF+":::"+ optArr.toSource()):null;

/* 0307
// build the dn Option Menu Element from the optArr
var newSelect = createSel();
newSelect.@id = ctg.pF+"OptMnuElm";
newSelect.@onChange="runFnctn(this,'"+ctg.pF+"','optMnu"+ctg.pF.toUpperCase()+"')";
//newSelect.@onChange="runFnctn(this,'"+ctg.pF+"','"+ctg.pF+"OptMnu')";
for each(var oOpt in optArr){//for1
var newOption = createOptn();
newOption.appendChild(oOpt[0]); 
newOption.@value = oOpt[1];
if(dn.control.@o_sel==oOpt[1]){
newOption.@selected = true;
}
newSelect.appendChild(newOption);
}//for1 
zForm[ctg.a].*.(@id==ctg.pF+"Table2")[0].tr.td[1].setChildren(newSelect);
*/
// build the option menu Elements needed
var eCat = {a:ctg.a, b:ctg.b, c:"e", pF:ctg.pE};
//(eCat.pF=="sde")? alert(eCat.pF+":::"+ __o.selNodeLib.eElms):null;
//(eCat.pF=="wpe")? alert(eCat.pF+":::"+ __o.selNodeLib.eElms):null;

for each(var eElm in __o.selNodeLib.eElms){
//alert(__o.selNodeLib.toSource());
var deLib= getLibNode(eCat,eElm);//eBF
if(logErrorReported){return false;}
var creatElm = eval("build"+deLib.eBF+"(eCat,deLib,dn)");//timeout will not work here, must be an eval. 
if(logErrorReported){return false;}// could test each creatElm
}

// set the colum values
var colValEs = ""; // value eval string
var colNvs       =  __o.selNodeLib.colNvs;
var colNames =  __o.selNodeLib.colNames;
var colNamesLgth = colNames.length;
var countCol = 0;
//alert(" __o.selNodeLib.toSource():"+ __o.selNodeLib.toSource());

for(var i=0;i<colNamesLgth;i++){//for1
//zForm[ctg.a].*.(@id==ctg.pF+"Table1")[0].tr.td[1].child(0)
var xdnColumn = dn.control.zztreecolumn[countCol];
if(!xdnColumn){return logError(new Error("missing xdnColumn:"+countCol +"in: "+dn.control.toSource()));}//ifEr

//alert(dn.control.zztreecolumn[countCol].toXMLString());
if(colNames[i] == " : "){//if2 it's just a spacer do this // _sCs is the lang 
xdnColumn.@value = xdnColumn.@value + " : ";
colValEs = colValEs + "+':'+";
//alert("1"+colValEs);
}//if2
else if(colNames[i-1] != " : "){ // the first in a colum
xdnColumn.@value = colNames[i];
(colNames[i+1]== " : ")? null: countCol++;
var colDivider = (colNames[i+1]== " : "|| !colNames[i+1])? "" : "+'|'+";
colValEs = (i==0)? colNvs[i]  + colDivider :  colValEs + colNvs[i] + colDivider;
//alert("2"+colValEs);
}
else if(colNames[i-1] == " : "){ // the last or middle in a shared colum
xdnColumn.@value = xdnColumn.@value + colNames[i];
(colNames[i+1]== " : ")? null: countCol++;
var colDivider = (colNames[i+1]== " : "|| !colNames[i+1])? "" : "+'|'+";
colValEs =  colValEs + colNvs[i] + colDivider;
//alert("3"+colValEs);
}

//Put tree status saying on the first column  
if(i==0 && !dn.hasSelNode){ 
xdnColumn.@value = xdnColumn.@value + " " + zLang._NoneSelected;
}
//(ctg.pF=="sdn")? alert("colValEs"+ colValEs) : null;
}//ENDfor1

// rebuild the treenode second colum if needed
//Note maybe all cols should be done 
// NOTE wpn does not need to use dnTagX. So it currently has it own for each loop. Some other might be able to do this to increase it speed
if(colsNeedUpdating && ctg.pF != "wpn"){//if1
for each(var node in dn.control..zztreenode){//for1
var dnTagX = getLibNode(ctg," ",node.@hash_val);
if(logErrorReported){return false;}
node.@value = eval(colValEs); 
//alert("colValEs: "+colValEs);
//alert(node.toXMLString());
//alert(dnTagX.toSource());
//(ctg.pF=="tdn")? alert(node.@hash_val) : null;
//(ctg.pF=="tdn")? alert(dnTagX.toSource()) : null;
//(ctg.pF=="tdn")? alert(node.toXMLString()) : null;
}//for1
}//if1
else if(colsNeedUpdating && ctg.pF == "wpn"){//e1 // does the wpn tree
for each(var node in dn.control..zztreenode){//for1
node.@value = eval(colValEs);
//alert(node.toXMLString());
}//for1
//alert(dn.control.toXMLString());
}//e1
//alert(dn.control);
//(ctg.pF=="wpn")? alert(colsNeedUpdating) : null;
colsNeedUpdating = false;
//(ctg.pF=="wpn")? writeTestingPage(true,ctg.pF+"UpDateTree.txt",dn.control.toXMLString()) : null;
return LogFtnReturn(logFtn);
}

function buildTreeOptionMenu(ctg,eLib,tree){
var logFtn=LogFtn(new Error(),1,1,1,-1);

var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");

//create a select menu
var newSelect = createSel();
newSelect.@hash_val = eLib.hashVal;
newSelect.@id = eLib.eID;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";

for each(var oOpt in tree.optArr){//for1
var newOption = createOptn();
newOption.appendChild(oOpt[0]); 
newOption.@value = oOpt[1];
if(tree.control.@o_sel==oOpt[1]){
newOption.@selected = true;
}
newSelect.appendChild(newOption);
}//for1
putItHere.appendChild(newSelect);

return LogFtnReturn(logFtn);
}


function updateMM(ctg){
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var mnu = zForm[ctg.a].*.(@id==ctg.a+"mbTable0")[0].tr.td[0].select[0];
var optSel = getEx4ElmByAttribName(mnu..option,"selected");
delete optSel.@selected;
var optSelCat = optSel.@value;
mnu.*.(@value==ctg.a).@selected = true;
var runFns = dwChangeFileInTab(optSelCat+"dn") && setVForm(optSelCat+"dn",1);
return runFns && LogFtnReturn(logFtn) || logError(new Error());
}

function bugFixTreeUnClicked(treeControl){
// fixes a bug when a tree is clicked on for the first, which happens when one or more trees is showing
// this sets a val on the treecontrol element that will tell if it's being clicked on for the first time
var logFtn=LogFtn(new Error(),1,1,1,-1);
treeControl.@unclicked = 0;
LogFtnReturn(logFtn);
}

function buildTreeColumns(treeControl){
// help fixes a treecolumn width bug, and clears the treenodes too.
var logFtn=LogFtn(new Error(),1,1,1,-1);
//fix bug
for each(treecolumn in treeControl..zztreecolumn){
var oldCol = document.getElementById(treecolumn.@id);
if(oldCol != null){
treecolumn.@width = oldCol.getAttribute("width");
}
}
//delete all treenodes
//delete treeControl.zztreenode;
LogFtnReturn(logFtn);
}

function buildEmptyLocation(ctg,eLib,tree){
var logFtn=LogFtn(new Error(),1,1,1,-1);
try{
getZFormTagNameById(ctg.a,eLib.pIH,"td").setChildren(" ");
}
catch(err){
return logError(err,true);
}
return LogFtnReturn(logFtn);
}


function buildOpenElm(ctg,eLib,tree){
var logFtn=LogFtn(new Error(),1,1,1,-1);
try{
//create a line break
getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(new XML("<"+eLib.vOPT[0][0] + " />"));
}
catch(err){
return logError(err,true);
}
return LogFtnReturn(logFtn);
}

function buildInput1(ctg,eLib,tree){
//Adds a name text input field for bdn, sdn, or wdn, or the URL text field for wdn
var logFtn=LogFtn(new Error(),1,1,1,-1);
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "text";
newInput.@id = eLib.eID;
newInput.@size = eLib.eSZ;
newInput.@value =  tree.selNode.@[eLib.dataSource];
getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newInput);
return LogFtnReturn(logFtn);
}

function buildInput3(ctg,eLib,tree){
//Adds OnOff input checkbox for wln 
var logFtn=LogFtn(new Error(),1,1,1,-1);
var eDataSource = tree.selNode.@[eLib.dataSource];
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "checkbox";
newInput.@id = eLib.eID;
newInput.@size = eLib.eSZ;
newInput.@value =  eDataSource;
newInput.@onClick="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
newInput.@checked =  (eDataSource == 1)? "checked" : "";
getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newInput);
return LogFtnReturn(logFtn);
}

function buildInputBtn(ctg,eLib,tree){
//Adds a input button for all type of uses
var logFtn=LogFtn(new Error(),1,1,1,-1);
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "button";
newInput.@id = eLib.eID;
newInput.@size = eLib.eSZ;
newInput.@value =  eLib.vOPT[0][0];
newInput.@onClick="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newInput);
return LogFtnReturn(logFtn);
}

function buildInputBtnHsn(ctg,eLib,tree){
//Adds a input button for refreshing ndn
// if tree has a selected node it will show this btn
// if it does not, it will not be added to the table
var logFtn=LogFtn(new Error(),1,1,1,-1);
if(tree.hasSelNode){
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "button";
newInput.@id = eLib.eID;
newInput.@size = eLib.eSZ;
newInput.@value =  eLib.vOPT[0][0];
newInput.@onClick="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newInput);
}
return LogFtnReturn(logFtn);
}

function buildInputColorCss(ctg,eLib,tree){
//Adds a color input button mostly for wpn CSSbackground color
var logFtn=LogFtn(new Error(),1,1,1,-1);
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "mmcolorbutton";
newInput.@id = eLib.eID;
newInput.@size = eLib.eSZ;
newInput.@value = notBlank(tree.selNode.@css_value) || "";
newInput.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newInput);
return LogFtnReturn(logFtn);
}

function buildInputTextCss(ctg,eLib,tree){
// mostly for wpn Css text field
var logFtn=LogFtn(new Error(),1,1,1,-1);
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "text";
newInput.@id = eLib.eID;
newInput.@size = eLib.eSZ;
newInput.@value =  notBlank(tree.selNode.@css_value) || "";
getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newInput);
return LogFtnReturn(logFtn);
}

function buildMixedCornerRadCss(ctg,eLib,tree){ 
// border radius
// this and buildMixedMaCss  R very much the same
var logFtn=LogFtn(new Error(),1,1,1,-1);

// break up all the sizes into small array vars
var cssX = getCssRule(tree.selNode.@css_value);
var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");

var count = 0;
for each(var sizeName in tree.selNodeLib.vOPT){//for1
var sizeX = getNumber((cssX.rulesLength - 1 >= count)? cssX.rules[count] : "");

// put a label on it
putItHere.appendChild(sizeName[0]);

// create a input field
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "text";
newInput.@id = "textfield"+count;
newInput.@size = 5;
newInput.@value = (sizeX.isNum)? sizeX.val : "";
newInput.@label_name = sizeName[0];
putItHere.appendChild(newInput);


//Build the size type select element
// I think just using the ok button maybe better, so maybe select onChange can go
var selOption = -1;
var newSelect = createSel();
newSelect.@id = "selMenu"+count;
newSelect.@hash_val = eLib.hashVal;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
// loop and create the options and check the selected size type option
for each(var sizeType in tree.selNodeLib.vOPT2){
var newOption = createOptn();
newOption.text()[0] =  sizeType[0];
newOption.@value =  sizeType[1];
if(sizeX.string.indexOf(sizeType[1]) >= 0){newOption.@selected = true;selOption = 1;}
newSelect.appendChild(newOption);
}
putItHere.appendChild(newSelect);
count++;
}//for1

return LogFtnReturn(logFtn);
}

function buildMixedFsCss(ctg,eLib,tree){
//used for: CSSfont-Size|CSSMarginSize|CSSpaddingSize
var logFtn=LogFtn(new Error(),1,1,1,-1);
var cssX = getCssRule(tree.selNode.@css_value);
var sizeX = getNumber(cssX.rule);
var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");

//create a input field
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "text";
newInput.@id = "textfield0";
newInput.@size = "5";
newInput.@value =  (sizeX.isNum)? sizeX.val : "";
putItHere.appendChild(newInput);

//create a select menu
var newSelect = createSel();
newSelect.@id = "selMenu0";
newSelect.@hash_val = eLib.hashVal;
// not being use but i'll keep it here if something else would need it.
(eLib.eFN)? newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')" : null;

var selOption = false;

// loop and create the options and check the selected option
for each(var vOPT in tree.selNodeLib.vOPT){
var newOption = createOptn();
newOption.text()[0] =  vOPT[0];
newOption.@value =  vOPT[1];
if(sizeX.string.indexOf(vOPT[1])>=0||(!selOption&&cssX.isBlank)||tree.selNodeLib.vOPT.length==1){
selOption = true;
newOption.@selected = true;
}
newSelect.appendChild(newOption);
}

putItHere.appendChild(newSelect);

return LogFtnReturn(logFtn);
}


function buildMixedMaCss(ctg,eLib,tree){
// Margins and padding shorthand ie  1px 1px 1px 1px
// not used but should keep it, just in case
// break up all the sizes into small array vars
var logFtn=LogFtn(new Error(),1,1,1,-1);
var cssX = getCssRule(tree.selNode.@css_value);
var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");
var sizeTypes = ["px","ex"];
var sizeName = ["_Top","_RT","_Bot","_LT"];
var sizeNumber = [];
var sizeUnit = [];

// fill the small array values
for(var i=0; i<4;i++){//for1
var sizeX = getNumber((cssX.rulesLength - 1 >= i)? cssX.rules[i] : "");
(sizeX.isNum)? sizeNumber.push(sizeX.val) : null;
// find the selected size Type option
for each(var sizeType in sizeTypes){
if(sizeX.string.indexOf(sizeType) >= 0){ sizeUnit.push(sizeType);break;}
}
if(sizeNumber.length<i+1){sizeNumber.push("E");}
if(sizeUnit.length<i+1){sizeUnit.push(" ");}
}//ENDfor1

//create a line break
putItHere.appendChild(<br />);

//start building it
for(var i=0; i< 4; i++){//for1
// put a label on it
putItHere.appendChild(zLang[sizeName[i]]);
// create a input field
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "text";
newInput.@id = "textfield"+i;
newInput.@size = 5;
newInput.@value = (sizeNumber[i]=="E")? "" : sizeNumber[i];
newInput.@label_name = zLang[sizeName[i]];
putItHere.appendChild(newInput);
//create a select menu
var newSelect = createSel();
newSelect.@hash_val = eLib.hashVal;
newSelect.@id = "selMenu"+ i;
//create the options
for each(var sizeType in sizeTypes){
var newOption = createOptn();
newOption.text()[0] = sizeType;
newOption.@value = sizeType; // may want to put the word _none here 
(sizeType == sizeUnit[i])? newOption.@selected = true : null;
newSelect.appendChild(newOption);
}
putItHere.appendChild(newSelect);
//create a line break
(i == 1)? putItHere.appendChild(<br />): null;
}//ENDfor1
putItHere.appendChild(<br />);

return LogFtnReturn(logFtn);
}

function buildSelect1(ctg,eLib,tree){
// layout menu for wdn
var logFtn=LogFtn(new Error(),1,1,1,-1);
var tdns= getTree(catg.tdn).control.zztreenode;
var tdnNum= tree.selNode.@tdn_num;
var tdnName = tree.selNode.@tdn_name;
var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");

//create a select menu
var newSelect = createSel();
newSelect.@hash_val = eLib.hashVal;
newSelect.@id = eLib.eID;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
newSelect.@width = "180px";
//create first option
var newOption1st = createOptn();
newOption1st.@value = " ";
newOption1st.text()[0] = zLang._NoneWbrakets;
//// should use a filter to find if one is selected here if the false and true trick below does not work
newOption1st.@selected = true;
newSelect.appendChild(newOption1st);
// loop the options and check the selected option
for each(var node in tdns){//for1
var newOption = createOptn();
newOption.@value = node.@n_num;
newOption.text()[0] = node.@n_name;
// if a layout matches a file then select it
if(tdnNum != " " && node.@n_num == tdnNum){//if1
newOption1st.@selected = false;
newOption.@selected = true;
}//if1
newSelect.appendChild(newOption);
}//ENDfor1

putItHere.appendChild(newSelect);
return LogFtnReturn(logFtn);
}

function buildSelect2(ctg,eLib,tree){
//layout option Menu//site menu options
// not sure if I'm going to use this
// this could be hard on ftns that use this select since langs will be different on value option, nor will it know which to use.
// in the to do list I have this as a problem to fix, So I'll do it then and leave this alone for now. Plus sorts need to be fixed.
// Sort is on the to do list too, because I would like to do alot of sorting in the Lib compiler. 
var logFtn=LogFtn(new Error(),1,1,1,-1);
var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");

//create a select menu
var newSelect = createSel();
newSelect.@hash_val = eLib.hashVal;
newSelect.@id = eLib.eID;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";

var selOption = -1;

// loop and create the options and selected the first option option
for each(var vOPT in tree.selNodeLib.vOPT){
var newOption = createOptn();
newOption.text()[0] =  vOPT[0];
newOption.@value =  vOPT[1];
if(selOption < 0){newOption.@selected = true;selOption=1;}
newSelect.appendChild(newOption);
}

putItHere.appendChild(newSelect);
return LogFtnReturn(logFtn);
}

function buildSelect3(ctg,eLib,tree){
// builds a select drop down add menu for: wdn, wln, ndn, mdn, sdn 
// addable items can be the node's children or it's parent node siblings
// c means it's children items, p means it's siblings items in it's parent
// In some cases siblings can also be put into a selected node as a child
// In those cases it will not be obvious here, but it will be in layouts and others that
// have a "p" and can add as a child. ie a layout box in a box

var logFtn=LogFtn(new Error(),1,1,1,-1);

//check for error
if(!tree.selNodeLib){logError(new Error("selNodeLib is missing"));return false;}


var addableToo = tree.selNodeLib.adNds;
var adNodes = (addableToo =="c" && tree.selNodeLib.node.*) || (addableToo =="p" && tree.selNodeLib.node.parent().*);

//check for error
if(!adNodes&&(addableToo=="c"||addableToo=="p")){
logError(new Error("tree.selNodeLib.node is missing for:"+tree.toSource()));
return false;
}
//Find the addible items
var optArr = [];
for each(var node in adNodes){//for1
var nodeLib = getLibNode(catg[ctg.a+ctg.b+"n"],"",node.@hashVal);
var addableQty = parseInt(nodeLib.adQty) || (nodeLib.adQty!=0 && nodeLib.adQty) || 0;

// If item is unlimitedly addable as a child or a sibling to their parent, add it to the add item menu
if(addableQty =="u" && (addableToo=="c" || addableToo=="p")){//if1
}//if1
// If item is limitedly addable and has no selected treenode, use treecontrol
// and if item is less than the allowed limit as a child in the treecontrol, add it to the add item menu
else if(addableQty && !tree.hasSelNode){//if2
if(tree.control.zztreenode.(@n_type_num == node.@id)[addableQty-1]){continue;}
}//if2
// If item is limitedly addable as a child to the selected treenode
// and if item is less than the allowed limit as a child in the selected treenode, add it to the add item menu
else if(addableQty && addableToo=="c" && tree.hasSelNode){//if3
if(tree.selNode.zztreenode.(@n_type_num==node.@id)[addableQty-1]){continue;}
}//if3
// If item is limitedly addable as a sibling to the selected treenode
// and in some cases a sibling as a child(this can happen in layouts(ie a box in a box or a menubox in a box)
// and if item is less than the allowed limit as a sibling or sibling as a child in the selected treenode
// add it to the add item menu
else if(addableQty && addableToo=="p" && tree.hasSelNode){//if4
if(tree.selNode.parent().zztreenode.(@n_type_num==node.@id)[addableQty-1]){continue;}
}//if4
// if item is not addable at all, then do not add it to the add item menu
else{
continue;
}
// add the addable item's name and item number to a array for sorting
optArr.push([nodeLib.vV,node.@id]);
}//for1

//sort the addable items by name
optArr.sort();

//create a select menu of addable items for the user to select from 
var newSelect = createSel();
newSelect.@hash_val = eLib.hashVal;
newSelect.@id = eLib.eID;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
//create first option
var newOption = createOptn();
newOption.@value = false;
newOption.text()[0] = "+";
newOption.@selected = true;
newSelect.appendChild(newOption);
//create options and check if or not a add option can be used
for each(var opt in optArr){//for1
newOption = createOptn();
newOption.@value = opt[1];
newOption.appendChild(opt[0]);
newSelect.appendChild(newOption);
}//ENDfor1
// put the new selected menu here
getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newSelect);
return LogFtnReturn(logFtn);
}

function buildSelect4(ctg,eLib,tree){
// mostly used for delete
// This function always creates a select element which always selects the first option
var logFtn=LogFtn(new Error(),1,1,1,-1);
var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");

//create a select menu
var newSelect = createSel();
newSelect.@hash_val = eLib.hashVal;
newSelect.@id = eLib.eID;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";

var selOption = -1;

// loop and create the options and check the first selected option
for each(var vOPT in tree.selNodeLib.vOPT){
var newOption = createOptn();
newOption.text()[0] =  vOPT[0];
newOption.@value =  vOPT[1];
if(selOption<0){ newOption.@selected = true; selOption=1;};
newSelect.appendChild(newOption);
}

putItHere.appendChild(newSelect);
return LogFtnReturn(logFtn);
}

function buildSelect7(ctg,eLib,tree){
// Used for wpn wgt id=3 // id-3 type value , // id-5 bordertype value // // id-5 liquid Width value
// This ftn is for item Properties which require matching a vOPT and if nothing matches it will display
// the select element with a down arrow
var logFtn=LogFtn(new Error(),1,1,1,-1);

//create a select menu
var newSelect = createSel();
newSelect.@id = eLib.eID;
newSelect.@hash_val = eLib.hashVal;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";

var selOption = -1;

// loop and create the options and check the selected option
for each(var vOPT in tree.selNodeLib.vOPT){
var newOption = createOptn();
newOption.text()[0] =  vOPT[0];
newOption.@value =  vOPT[1];
if(parseInt(vOPT[1]) == parseInt(tree.selNode.@wgt_value)){newOption.@selected = true;selOption=1;}
newSelect.appendChild(newOption);
}

// if no option was select, create a down arrow on the select menu
if(selOption<0 && newSelect.option[0]){
var newOption = createOptn();
newOption.text()[0] =  zLang._Arrow01Down;
newOption.@value =  false;
newOption.@selected = true;
if(newSelect.option[0]){
newSelect.insertChildBefore(newSelect.option[0],newOption);
}
else{
newSelect.appendChild(newOption);
}
}

getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newSelect);
return LogFtnReturn(logFtn);
}

function buildSelect8(ctg,eLib,tree){
//NOT USED but may want to use it for something
// Used for wpn wgt id=3 // id-3 type value , // id-5 bordertype value // // id-5 liquid Width value
// This ftn is for item Properties which require something to be always selected
// If no match and it's blank, or does not have a number it will always select the default
// or if the number is higher than the choices to match, it will choose the last item.
// NOTE I have not put in the code here to select the default or the last item. 
// Also NOTE I may want to build a ftn for nav-start level which looks at what the current page and
// _NavDirectory to decide what levels R avalible and if the currently selected level is out
// of range, and what actions should be taken to correct this problem
var logFtn=LogFtn(new Error(),1,1,1,-1);

//create a select menu
var newSelect = createSel();
newSelect.@id = eLib.eID;
newSelect.@hash_val = eLib.hashVal;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";

var selOption = -1;

// loop and create the options and check the selected option
for each(var vOPT in tree.selNodeLib.vOPT){
var newOption = createOptn();
newOption.text()[0] =  vOPT[0];
newOption.@value =  vOPT[1];
if(parseInt(vOPT[1]) == parseInt(tree.selNode.@wgt_value)){newOption.@selected = true;selOption = 1;}
newSelect.appendChild(newOption);
}

// if no option is select, select the first option
if(selOption<0 && newSelect.option[0]){
newSelect.option[0].@selected = true;
}

getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newSelect);
return LogFtnReturn(logFtn);
}

function buildSelect9(ctg,eLib,tree){
//Used for: CSSdirection|CSStext-align|CSStext-decoration|CSSvertical-align|CSSwhite-space
var logFtn=LogFtn(new Error(),1,1,1,-1);
var cssX = getCssRule(tree.selNode.@css_value);
var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");

//create a select menu
var newSelect = createSel();
newSelect.@id = eLib.eID;
newSelect.@hash_val = eLib.hashVal;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";

var selOption = -1;

// loop and create the options and check the selected option
for each(var vOPT in tree.selNodeLib.vOPT){
var newOption = createOptn();
newOption.text()[0] =  vOPT[0];
newOption.@value =  vOPT[1];
if(vOPT[1] == cssX.rule){newOption.@selected = true;selOption = 1;}
newSelect.appendChild(newOption);
}
// if no option was select, create a down arrow on the select menu
if(selOption<0 && newSelect.option[0]){
var newOption = createOptn();
newOption.text()[0] =  zLang._Arrow01Down;
newOption.@value =  false;
newOption.@selected = true;
if(newSelect.option[0]){
newSelect.insertChildBefore(newSelect.option[0],newOption);
}
else{
newSelect.appendChild(newOption);
}
}
//or else add a clear option if a value was matched
else if(selOption>0 && newSelect.option[0]){
var newOption = createOptn();
newOption.text()[0] =  zLang._ClearWbrakets;
newOption.@value =  "";
if(newSelect.option[0]){
newSelect.insertChildBefore(newSelect.option[0],newOption);
}
else{
newSelect.appendChild(newOption);
}
}

getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newSelect);
return LogFtnReturn(logFtn);

}

function buildSelectBdi(ctg,eLib,tree){// CSS Border image
//NOTE NOT FInished it needs to be finished.
// NOT SURE, may need to remove all end and double blank spaces on nodeCssRule, but this
// might be getting done in wln //need to check if wln does do this 
var logFtn=LogFtn(new Error(),1,1,1,-1);
var cssX =  getCssRule(tree.selNode.@css_value);
var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");
//set the imageURL
var url = cssX.rulesLength>0 && cssX.rules[0];
url=(url.indexOf("url(")==0&&url.indexOf(")")>-1)?url.substring(4,url.indexOf(")")):false;

//get the edge sizes for the top, right, bottom, anf left
var sizeTypes = ["px","ex"];
var sizeName = ["_Top","_RT","_Bot","_LT"];
var sizeNumber = [];
var sizeUnit = [];

// fill the small array values
for(var i=1; i<5;i++){//for1
var sizeX = getNumber((cssX.rulesLength - 1 >= i)? cssX.rules[i] : "");
(sizeX.isNum)? sizeNumber.push(sizeX.val) : null;
// find the selected size Type option
for each(var sizeType in sizeTypes){
if(sizeX.string.indexOf(sizeType) >= 0){ sizeUnit.push(sizeType);break;}
}
if(sizeNumber.length>sizeUnit.length){sizeUnit.push("");}
if(sizeNumber.length<sizeUnit.length){sizeNumber.push("");}
//if(sizeNumber.length<i+1){sizeNumber.push("E");}
//if(sizeUnit.length<i+1){sizeUnit.push(" ");}
}//ENDfor1

//If CSS shorthand is present then set the edge size values to reflect those values
var sizeNumberLength = sizeNumber.length;
// it only has the first size value // then all four values R the same
if(sizeNumberLength==1&&!isBlank(sizeNumber[0])){
sizeNumber = [sizeNumber[0],sizeNumber[0],sizeNumber[0],sizeNumber[0]];
sizeUnit = [sizeUnit[0],sizeUnit[0],sizeUnit[0],sizeUnit[0]];
}
// it has the first and second size value// then [2] = [0] and [1] = [3]
else if(sizeNumberLength==2){
sizeNumber = [sizeNumber[0],sizeNumber[1],sizeNumber[0],sizeNumber[1]];
sizeUnit = [sizeUnit[0],sizeUnit[1],sizeUnit[0],sizeUnit[1]];
}
// it has the first, second and third size value// then [1] = [3]
else if(sizeNumberLength==3){
sizeNumber = [sizeNumber[0],sizeNumber[1],sizeNumber[2],sizeNumber[1]];
sizeUnit = [sizeUnit[0],sizeUnit[1],sizeUnit[2],sizeUnit[1]];
}
// then use all the four values
else if(sizeNumberLength==4){
null;
}
else{
sizeNumber = ["","","",""];
sizeUnit =  ["","","",""];
}

//get scaled setting for Hort and Vert
var scaleTypes = [" ","repeat","round","stretch"];
var scaleName = [zLang._HorizontalOneLetter,zLang._VerticalOneLetter];
var scaleValue = [];
for(var i=sizeNumberLength+1; i<cssX.rulesLength;i++){//for1
var useScaleValueLength = scaleValue.length;
var scaleX = cssX.rules[i];
//alert(i +"******"+ nodeCssRule +"**XX**"+ nodeCssRules[i]);
for each(var scaleType in scaleTypes){//for2 // find the selected scale Type option
if(scaleX && scaleX.indexOf(scaleType) == 0){ scaleValue.push(scaleType);break;}
}//for2
}//ENDfor1

//If CSS shorthand is present then set the scaled setting values to reflect those values
var scaleValueLength = scaleValue.length;
if(scaleValueLength==1&&!isBlank(scaleValue[0])){//only has a first scaled value // then the two values R the same
scaleValue = [scaleValue[0],scaleValue[0]];
}
else if(scaleValueLength==2){// it has the first and second scaled setting value// then use those two
null;
}
else{//has no scaled setting values and everything else would be blank
scaleValue = ["",""];
}

//create the url Field

for(var i = 0;i>4;i++){

}
//alert("url:"+url+" sizeNumber0:"+sizeNumber[0]+" sizeNumber1:"+sizeNumber[1]+" sizeNumber2:"+sizeNumber[2]+" sizeNumber3:"+sizeNumber[3]+" sizeUnit0:"+sizeUnit[0]+" sizeUnit1:"+sizeUnit[1]+" sizeUnit2:"+sizeUnit[2]+" sizeUnit3:"+sizeUnit[3]+" scaleValue0:"+scaleValue[0]+" scaleValue1:"+scaleValue[1]);
return LogFtnReturn(logFtn);
}

function buildSelectBdr(ctg,eLib,tree){// CSS Borders
var logFtn=LogFtn(new Error(),1,1,1,-1);
var cssX = getCssRule(tree.selNode.@css_value);
v0 = cssX.rules[0] || ""; // color
v1 = cssX.rules[1] || ""; // line
v2 = cssX.rules[2] || ""; // size

var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");

//Build the color elements
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "mmcolorbutton";
newInput.@id = "colorswatch0";
newInput.@value = v0;
newInput.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";// may want no onchange
putItHere.appendChild(newInput);

//Build the 2nd color element
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "text";
newInput.@id = "textfield0";
newInput.@size = "10";
newInput.@value = v0;
putItHere.appendChild(newInput);

// Find and Build the line type element
// I think just using the ok button maybe better, so maybe select onChange can go
//create a select menu
var selOption = -1;
var newSelect = createSel();
newSelect.@id = "selMenu0";
newSelect.@hash_val = eLib.hashVal;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
// loop and create the options and check the selected option
for each(var vOPT in tree.selNodeLib.vOPT){
var newOption = createOptn();
newOption.text()[0] =  vOPT[0];
newOption.@value =  vOPT[1];
if(vOPT[1] == v1){newOption.@selected = true;selOption = 1;}
newSelect.appendChild(newOption);
}
// if no option is select, select the first option
if(selOption<0 && newSelect.option[0]){
newSelect.option[0].@selected = true;
}
putItHere.appendChild(newSelect);


//Build the size text input element
var sizeX = getNumber(v2);
newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "text";
newInput.@id = "textfield1";
newInput.@size = "5";
newInput.@value = (sizeX.isNum)? sizeX.val : "";
putItHere.appendChild(newInput);


//Build the size type select element
// I think just using the ok button maybe better, so maybe select onChange can go
var selOption = -1;
var newSelect = createSel();
newSelect.@id = "selMenu1";
newSelect.@hash_val = eLib.hashVal;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
// loop and create the options and check the selected size type option
for each(var vOPT in tree.selNodeLib.vOPT2){
var newOption = createOptn();
newOption.text()[0] =  vOPT[0];
newOption.@value =  vOPT[1];
if(sizeX.string.indexOf(vOPT[1]) >= 0){newOption.@selected = true;selOption = 1;}
newSelect.appendChild(newOption);
}
putItHere.appendChild(newSelect);

return LogFtnReturn(logFtn);
}


function buildSelectBGB(ctg,eLib,tree){ // BackGround Borders
//NOTE NOT USED
// this includes the none value. It's a little different then the others
var logFtn=LogFtn(new Error(),1,1,1,-1);

//Build the option Menu
var newSelect = createSel();
newSelect.@hash_val = eLib.hashVal;
newSelect.@id = eLib.eID;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
//create options menus
for(var i=0; tree.selNodeLib.vOPT && i< tree.selNodeLib.vOPT.length; i++){//for1
//if(isBlank(tree.selNodeLib.vOPT[i])){continue;}
var newOption = createOptn();
newOption.@value = i;
newOption.text()[0] =  (i>0)? tree.selNodeLib.vOPT[i]: zLang._None;
if(parseInt(tree.selNode.@wgt_value)==i){
newOption.@selected = true;
}
newSelect.appendChild(newOption);
}//for1
getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newSelect);

return LogFtnReturn(logFtn);
}

function buildSelectFf(ctg,eLib,tree){ // CSSfont family
var logFtn=LogFtn(new Error(),1,1,1,-1);
var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");
var optionValues = dw.getFontList() || [];
var optionTexts = dw.getFontList() || [];
//sort the font names
optionValues.sort();
optionTexts.sort();
//add the arrow down, and none to the front of the font select menu
optionValues.unshift("false","");
optionTexts.unshift(zLang._Arrow01Down,zLang._NoneWbrakets);

//create a select menu
var newSelect = createSel();
newSelect.@hash_val = eLib.hashVal;
newSelect.@id = eLib.eID;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
//create the option menus
var selectOption = "false";
for(var i = 0; i<optionValues.length;i++){
var newOption = createOptn();
//add the font style to each select option, so the user can see the style
// this will not work in DW floater panel, but it should work in the browser control
// therefore, I added so it will work if or when I put everything in the browsercontrol
// the following lines caused error in DW's floating pannel. So this will need to be save until
// version 2 if or when I use browsercontrol
// newOption.@style = "font-family:"+optionValues[i];
newOption.@value = optionValues[i];
newOption.text()[0] =  optionTexts[i];
if(selectOption==optionValues[i]){newOption.@selected = true;}
newSelect.appendChild(newOption);
}
putItHere.appendChild(newSelect);

//create a break
putItHere.appendChild(<br />);

//create a input field
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "text";
newInput.@id = "textfield0";
//newInput.@size = "30px";
newInput.@style = "width:100%;min-width:30px;max-width:100%";
newInput.@value = notBlank(tree.selNode.@css_value) || " ";
putItHere.appendChild(newInput);

/*

//create a break
putItHere.appendChild(<br />);
//Build the Clear element
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "button";
newInput.@id = "btn0";
newInput.@size = "auto";
newInput.@value =  zLang._Clear;
newInput.@onClick="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";
putItHere.appendChild(newInput);
*/
return LogFtnReturn(logFtn);
}

function buildSelectNameSet(ctg,eLib,tree){
//Snipit file, Background Border Image sets, menuArray file
var logFtn=LogFtn(new Error(),1,1,1,-1);
var wgtRuleValue = notBlank(tree.selNode.@wgt_value) || "";
//  4=border(b) || 5=snipit(n)  || 10=menu(m)
var ndn=(tree.selNodeLib.vDPV=="4")?getTree(catg.bdn):(tree.selNodeLib.vDPV=="5")?getTree(catg.ndn):(tree.selNodeLib.vDPV=="10")? getTree(catg.mdn): false;

//create a select menu
var newSelect = createSel();
newSelect.@hash_val = eLib.hashVal;
newSelect.@id = eLib.eID;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";

//create a firstOption
newSelect.appendChild(createOptn());

var selOption = false;
// create the other options
for each(var treenode in ndn.control.zztreenode){//for1
var treenodeNNum = treenode.@n_num;
if(treenodeNNum == "e"){continue;}
var newOption = createOptn();
newOption.@value = treenodeNNum;
newOption.text()[0] = treenodeNNum+":"+treenode.@n_name;
if(wgtRuleValue == treenodeNNum){newOption.@selected = true;selOption=true}
newSelect.appendChild(newOption);
}//ENDfor1

//set the firstOption
var firstOption = newSelect.option[0];
//if it's blank or no valued matched, add the down arrow,
if(!selOption){
firstOption.@value = "false";
firstOption.text()[0] = zLang._Arrow01Down;
firstOption.@selected = true;
}
//or add clear if a value was matched
else{
firstOption.@value = "";
firstOption.text()[0] = zLang._ClearWbrakets;
}
//alert(newSelect.toXMLString());
getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newSelect);

return LogFtnReturn(logFtn);
}

function buildtxtMsg0(ctg,eLib,tree){//wuiDirectoryNodeTree // not in use
var logFtn=LogFtn(new Error(),1,1,1,-1);
var eLib = getLib(cat1+cat2+cat3);
var eTag = getTag(eLib,eTagNum);
var holdCode = eTag.vOPT;
var putItHere = getHformElmById(eTag.pIH);
putItHere.innerHTML = putItHere.innerHTML + holdCode;
return LogFtnReturn(logFtn);
}

function buildBtnImg0(ctg,eLib,tree){// not in use// maybe wdnUp//wlnUp and etc..
var logFtn=LogFtn(new Error(),1,1,1,-1);
var eLib = getLib(cat1+cat2+cat3);
var eTag = getTag(eLib,eTagNum);
var putItHere = getHformElmById(eTag.pIH);
var holdCode = "<input type='button' id='"+eTag.eID+"' value='"+eTag.vOPT+"' onClick=\"runFnctn(this,'"+eTag.eFN+"')\" />";
putItHere.innerHTML = putItHere.innerHTML + holdCode;
return LogFtnReturn(logFtn);
}

//border layout edit menu
function buildSelect6(ctg,eLib,tree){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var eLib = getLib(cat1+cat2+cat3);
var eTag = getTag(eLib,eTagNum);
var eOptions = dreamweaver.getExtensionEditorList(".gif");
var eOptionLength = eOptions.length / 2;
var putItHere = getHformElmById(eTag.pIH);

//create a select menu
var newSelect = createSel();
newSelect.@hash_val = eLib.hashVal;
newSelect.id = eTag.eID;
newSelect.setAttribute("onChange","runFnctn(this,'"+eTag.eFN+"')");
//create first option
var newOption1st = createOptn();
newOption1st.value = false;
newOption1st.text = "v";
newOption1st.selected = true;
// loop the options
for(var i=0;i<eOptionLength;i=i+2){//for1
var newOption = createOptn();
newOption.value = eOptions[i+1];
newOption.text = eOptions[i];
}//ENDfor1

putItHere.innerHTML = putItHere.innerHTML + newSelect.outerHTML;
return LogFtnReturn(logFtn);
}

function buildSelectDvdr(ctg,eLib,tree){
//breadcrumb Divider uni2
var logFtn=LogFtn(new Error(),1,1,1,-1);
var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");
var cssX = removeEndQuoteMarks(tree.selNode.@css_value);

//create a select menu
var newSelect = createSel();
newSelect.@id = eLib.eID;
newSelect.@hash_val = eLib.hashVal;
newSelect.@onChange="runFnctn(this,'"+eLib.eFN[0]+"','"+eLib.eFN[1]+"')";

var selOption = -1;

// loop and create the options and check the selected option
for each(var vOPT in tree.selNodeLib.vOPT){
var newOption = createOptn();
newOption.text()[0] =  vOPT[0];
newOption.@value =  vOPT[1];
if(vOPT[1] == cssX){newOption.@selected = true;selOption = 1;}
newSelect.appendChild(newOption);
}

// if no option was select, create a down arrow on the select menu
if(selOption<0 && newSelect.option[0]){
var newOption = createOptn();
newOption.text()[0] =  zLang._Arrow01Down;
newOption.@value =  false;
newOption.@selected = true;
if(newSelect.option[0]){
newSelect.insertChildBefore(newSelect.option[0],newOption);
}
else{
newSelect.appendChild(newOption);
}
}
//or else add a clear option if a value was matched
else if(selOption<0 && newSelect.option[0]){
newOption.text()[0] =  zLang._ClearWbrakets;
newOption.@value =  "";
if(newSelect.option[0]){
newSelect.insertChildBefore(newSelect.option[0],newOption);
}
else{
newSelect.appendChild(newOption);
}
}

getZFormTagNameById(ctg.a,eLib.pIH,"td").appendChild(newSelect);
return LogFtnReturn(logFtn);
}

function buildSelect15(ctg,eLib,tree){
// breadcrumb before words
var logFtn=LogFtn(new Error(),1,1,1,-1);
var putItHere = getZFormTagNameById(ctg.a,eLib.pIH,"td");
var cssX = removeEndQuoteMarks(tree.selNode.@css_value);

var selOption = -1;

// loop and create the options and check the selected option
for each(var vOPT in tree.selNodeLib.vOPT){
var newOption = createOptn();
newOption.text()[0] =  vOPT[0];
newOption.@value =  vOPT[1];
if(vOPT[1] == cssX){newOption.@selected = true;selOption = 1;}
newSelect.appendChild(newOption);
}

// if no option was select, create a down arrow on the select menu
if(selOption<0 && newSelect.option[0]){
var newOption = createOptn();
newOption.text()[0] =  zLang._Arrow01Down;
newOption.@value =  false;
newOption.@selected = true;
if(newSelect.option[0]){
newSelect.insertChildBefore(newSelect.option[0],newOption);
}
else{
newSelect.appendChild(newOption);
}
}
//or else add a clear option if a value was matched
else if(selOption<0 && newSelect.option[0]){
newOption.text()[0] =  zLang._ClearWbrakets;
newOption.@value =  "";
if(newSelect.option[0]){
newSelect.insertChildBefore(newSelect.option[0],newOption);
}
else{
newSelect.appendChild(newOption);
}
}

putItHere.appendChild(newSelect);

//create a break
putItHere.appendChild(<br />);

//create a input field
var newInput = createInp();
newInput.@hash_val = eLib.hashVal;
newInput.@type = "text";
newInput.@id = "textfield0";
newInput.@size = "30px";
newInput.@value = cssX;
putItHere.appendChild(newInput);
return LogFtnReturn(logFtn);
}

function changeRelURLtoFileURL(relURL){ 
// It changes a Relative URL to a File URL
// if no url then it returns blank
var logFtn=LogFtn(new Error(),1,1,1,-1);
var fileURL= notBlank(relURL) || "";
while(fileURL.charAt(0)=="." || fileURL.charAt(0)=="/"){
fileURL = fileURL.substring(1);
}
fileURL =(isBlank(fileURL))? " " : siteRoot+fileURL;
return LogFtnReturn(logFtn) && fileURL;
}

function changeZFormElmCSS(cat1,tagName,elmId,elmObj,cssProp,cssValue){
// leaving the cssValue blank will remove the cssRule

var logFtn=LogFtn(new Error(),1,1,1,-1);
var elm = elmObj || getZFormTagNameById(cat1,elmId,tagName);

if(!elm && !cssProp){//error checking
return logError(new Error());
}

var elmCss = elm.@style+"";
// replace
if(elmCss && elmCss.indexOf(cssProp+":") > -1&&cssValue){
elmCss = elmCss + ";"; // adding the semicol is needed if it needs to find the last cssProp in the string
var re = new RegExp(cssProp + "[\\W]*\\:[^;]+\\;", "i");
var cssRule = elmCss.match(re);
elmCss = elmCss.replace(cssRule,cssProp+":"+cssValue+";");
(elmCss && elmCss.charAt(elmCss.length-1) == ";")? elmCss =  elmCss.substring(0, elmCss.lastIndexOf(";")) : null;
elm.@style = elmCss;
}
// add to the end
else if(!isBlank(elmCss)&&cssValue){
(elmCss.charAt(elmCss.length-1) == ";")? elmCss =  elmCss.substring(0, elmCss.lastIndexOf(";")) : null;
elm.@style = elmCss+";"+cssProp+":"+cssValue;
}
// blank
else if(cssValue){
elm.@style = cssProp+":"+cssValue;
}
//remove
else if(elmCss.indexOf(cssProp+":") > -1){
elmCss = elmCss + ";"; // adding the semicol is needed if it needs to find the last cssProp in the str
var re = new RegExp(cssProp + "[\\W]*\\:[^;]+\\;", "i");
var cssRule = elmCss.match(re);
elmCss = elmCss.replace(cssRule,"");
(elmCss && elmCss.charAt(elmCss.length-1) == ";")? elmCss =  elmCss.substring(0, elmCss.lastIndexOf(";")) : null;
elm.@style = elmCss;
}
LogFtnReturn(logFtn);
}

function isUrlOfUrlRoot(url){
//checks if the url is equal to siteRoot or stackRoot or any stackRoot folders
//returns true if it is and false if it is not
var logFtn=LogFtn(new Error(),1,1,1,-1);
// make sure url amd siteRoot is not blank
var urlIsBlank = isBlank(siteRoot) || isBlank(url);
//make sure url starts with file://
var urlTest01= url.indexOf( "file:///")!=0;
//make sure url does not equal siteRoot:
var urlTest02=url==siteRoot||url+"/"==siteRoot;
//make sure url does not equal stackRoot:
var urlTest03=url==stackRoot+"/"||url+"/"==stackRoot+"/";
//test to make sure it is not a folder in the stacksite folder
var urlTest04=false;
for each(var char in ["b","j","m","n","s","t","w"]){
(url==stackRoot+"/"+char+"/"||url+"/"==stackRoot+"/"+char+"/")? null : urlTest04=false;
}
return LogFtnReturn(logFtn) && (urlIsBlank||urlTest01||urlTest02||urlTest03||urlTest04);
//alert("siteRoot:"+siteRoot.toLowerCase()+" stackRoot:"+stackRoot.toLowerCase());
}

function createInp(val){
var logFtn=LogFtn(new Error(),1,1,1,-1);
LogFtnReturn(logFtn);
return <input />;
}
function createOptn(){
var logFtn=LogFtn(new Error(),1,1,1,-1);
LogFtnReturn(logFtn);
return <option></option>;
}
function createSel(){
var logFtn=LogFtn(new Error(),1,1,1,-1);
LogFtnReturn(logFtn);
return <select></select>;
}
function createTreeColumn(){
var logFtn=LogFtn(new Error(),1,1,1,-1);
LogFtnReturn(logFtn);
return <zztreecolumn />;
}

function createTreeControl(){
// The "a" element is a hack to trick the parser not to throw a namespace error.
// It most have a space between the element. Otherwise it will get messup when inserted into HTML.
// The hack works but it's a bit messy finding and copying the vForn into a zForm.
var logFtn=LogFtn(new Error(),1,1,1,-1);
// THE hackWay
//var e=<a> </a>
//e.setName("mm:treenode");
//LogFtnReturn(logFtn);
//return e;
// The currentWay
LogFtnReturn(logFtn);
return <zztreecontrol> </zztreecontrol>;
}

function createTreeNode(){
// The "a" element is a hack to trick the parser not to throw a namespace error.
// It most have a space between the element. Otherwise it will get messup when inserted into HTML.
// The hack works but it's a bit messy finding and copying the vForn into a zForm.
var logFtn=LogFtn(new Error(),1,1,1,-1);
// THE hackWay
//var e=<a> </a>
//e.setName("mm:treenode");
//LogFtnReturn(logFtn);
//return e;
// The currentWay
LogFtnReturn(logFtn);
return <zztreenode> </zztreenode>;
}

function dwReload(typeOfReload){

var wuiShouldCompileUrl = wui.configpath+wui.versionName+"ShouldCompile.html";

// reload Dw and Compile wui
// the wuiShouldCompileUrl file is added so it will trigger a compile on reload
if(typeOfReload=="compile"){
DWfile.write(wuiShouldCompileUrl,"en");
saveAndCloseFilesInTabs(wui.logs+"ftn");
}
// or reload Dw and Extensions 
// the wuiShouldCompileUrl file is removed so it does not trigger a compile on reload
else{
if(dwFileExist(wuiShouldCompileUrl)){DWfile.remove(wuiShouldCompileUrl);}
saveAndCloseFilesInTabs(wui.logs+"ftn");
}
dreamweaver.reloadExtensions();
}

function saveAndCloseFilesInTabs(folderURL){
// description:
// This function saves and closes any files open in the tab of the folderURL
// arguments:
// the folderURL: is the folder for which you want any files within the folderURL saved and closed, which is expressed as a file:// URL
// file: does nothing, it's strickly used by the ftn and should always be keeped blank
// returns:
// true unless an error happens, which will return false;
// notes: 
// maybe it should just return blank if a error happens
var logFtn=LogFtn(new Error(),1,1,1,-1);
var fileAttribute = DWfile.getAttributes(folderURL);

// check if the first folderURL exist and it's a folder, or return false
if(logFtn.ftnName != logFtn.ftnRunName){//if1
if(!dwFileExist(folderURL)){return false;}
if(fileAttribute!="D"){logError(new Error("folder is a file error for:"+folderURL));return false;}
folderURL=folderURL.charAt(folderURL.length-1) == "/"&&folderURL.substring(0, folderURL.lastIndexOf("/"))||folderURL;
}//if1

// if it's a folder recurse
if(fileAttribute=="D"){//if1
for each(var f in dwFileListFolder(folderURL)){//for1
var x = saveAndCloseFilesInTabs(folderURL+"/"+f);
}//for1
}//if1
// or if it's file save and close it if it's open in a tab
else{
for each(var tabUrl in dw.getDocumentList()){//for2
//alert(logFileUrl + " ||||||||||||||||| " + tabUrl.URL);
if(folderURL == tabUrl.URL){//if1
dwCloseFileInTab(folderURL);
break;
}//if1
}//for2
return LogFtnReturn(logFtn);
}

return LogFtnReturn(logFtn);

}

function getCssRule(rule){
var logFtn=LogFtn(new Error(),1,1,1,-1);
var arr = {};
arr.isBlank = isBlank(rule);
arr.hasRules = !arr.isBlank && rule.indexOf(" ")>-1;
arr.rules =  arr.hasRules && rule.split(" ") || false;
arr.rulesLength = arr.rules && arr.rules.length || 0;
arr.rule = (arr.isBlank)? " " : rule;
return LogFtnReturn(logFtn) && arr;
}

function getEx4ElmByAttribName(elms,attribName){
// returns the first elm with this attribute name, and if none exist it will return false
var logFtn=LogFtn(new Error(),1,1,1,-1);
for each(var elm in elms){
if(elm.hasOwnProperty("@"+attribName)){
return LogFtnReturn(logFtn) && elm;
}
}
return LogFtnReturn(logFtn) && false;
}

function getEx4Attrib(elm,attrib){// not used
//returns false and logs an error if the element has no attribute with that name or element does not exist.
// if it's blank it will return blank, otherwise it's value
var logFtn=LogFtn(new Error(),1,1,1,-1);
LogFtnReturn(logFtn);
return elm && elm(hasOwnProperty(@[attrib])) && elm.@[attrib] || getEx4Attrib(getEx4Attrib," Lib elmParent not found for:"+elm.toXMLString());
}


function getFile(filePath,ifNoFileExistLogError){
// this return the content of the file if it exist // if no file exist it returns false;
// filePath - is the name of the complete file path. 
// ifNoFileExistLogError - a boolean value is required. False will not log a error if the file does not exist, true will log a error. Default is false.
var logFtn=LogFtn(new Error(),1,1,1,-1);
if(dwFileExist(filePath)){
return LogFtnReturn(logFtn) && DWfile.read(filePath);
}
else if(ifNoFileExistLogError){
LogFtn(new Error("this file could not be found"+filePath),1,1,1,-1);
}
return LogFtnReturn(logFtn) && false;
}

function getUrlFullLocalPath(fileURL){
return notBlank((fileURL.indexOf("../../../")==0)? fileURL.substring(9): fileURL); 
}


function getFileInStackSite(filePath,ifNoFileExistLogError){
// this return the content of the file if it exist // if no file exist it returns false;
// filePath - is the name of the /folder/file. A slash in the beginning is required.
// ifNoFileExistLogError - a boolean value is required. False will not log a error if the file does not exist, true will log a error. 
//alert(stackRoot +" ||||||||| "+filePath);
var logFtn=LogFtn(new Error(),1,1,1,-1);
if(dwFileExist(stackRoot+filePath)){
return LogFtnReturn(logFtn) && DWfile.read(stackRoot+filePath);
}
else if(ifNoFileExistLogError){
LogFtn(new Error("this file could not be found"+filePath),1,1,1,-1);
}
return LogFtnReturn(logFtn) && false;
}

function getFileListShifted(folderURL,findTypes,newArray){
// description:
// This function gets a shifted array list of the contents of the specified folder
// which each url is added to the beginning of the array. Basically it will grab all files in
// a folder, and files nested in folders of folderURL, and put them in an array list of URLs.
// arguments:
// the folderURL: is the folder for which you want a shifted contents list, which is expressed as a file:// URL
// findTypes: (blank: is file and folders) (directorys: is folder only) (files: is files only)
// newArray: does nothing, it's strickly used by the ftn and should always be keeped blank
// returns:
// An array of strings that represents the contents of the folder URLs and it's URL
// otherwise if folder does not exist it will return blank
// notes:
// 1: may need to weed out TMP files- if (f.indexOf("TMP") == 0) continue;	// leave temporary files
// 2: maybe it could use a fileFilterMask argument 
// 3. // getFileListShifted is a little slow bc of concat maybe it would be faster to shift an xml list

var logFtn=LogFtn(new Error(),1,1,1,-1);
var fileAttribute = DWfile.getAttributes(folderURL);

// check if the first folderURL exist and it's a folder, or return blank
if(logFtn.ftnName != logFtn.ftnRunName){//if1
if(fileAttribute!="D"){logError(new Error("folder is a file error for:"+folderURL));return "";}
folderURL=folderURL.charAt(folderURL.length-1) == "/"&&folderURL.substring(0, folderURL.lastIndexOf("/"))||folderURL;
}//if1
newArray = [folderURL];

// if it's a folder recurse and append files to the newNode
// and leave Dreamweaver folders alone
if(fileAttribute=="D"){//if1
for each(var f in dwFileListFolder(folderURL,findTypes)){//for1
if(f == '_notes'){continue;}
newArray = getFileListShifted(folderURL+"/"+f,findTypes,newArray).concat(newArray);
}//for1
}//if1

return LogFtnReturn(logFtn) && newArray;
}

function getFileSubStrArray(fileUrl,Prefix,SubChar,SplitChar){
// this could be made to get other files and return them too, currently it's only being use in setWDNtree
// if any thing is wrong it will return false and send an error

var logFtn=LogFtn(new Error(),1,1,1,-1);
var fileUrlNotBlank = notBlank(fileUrl) || logError(new Error("fileUrl is Blank"));
var fileUrlExist = fileUrlNotBlank && dwFileExist(stackRoot+fileUrl) || logError(new Error("fileUrl does not exist"));
var code = fileUrlExist &&notBlank(DWfile.read(stackRoot+fileUrl)) || logError(new Error("SubStr is blank"));
// if this file is missing or blank return false
if(!code){return false;}

var hasPrefix = Prefix && code.indexOf("q"+Prefix+"StackSite")>-1;
var firstSubChar = SubChar && code.indexOf(SubChar);
var lastSubChar = SubChar && code.lastIndexOf(SubChar);
var hasGoodSubChar = SubChar &&  firstSubChar > -1 && lastSubChar > -1 && firstSubChar != lastSubChar;
var hasSplitChar = SplitChar && code.indexOf("_")>-1;

//alert("hasPrefix: "+hasPrefix + " firstSubChar: "+firstSubChar + " lastSubChar: "+lastSubChar+" hasGoodSubChar: "+hasGoodSubChar+ " hasSplitChar: "+hasSplitChar);

//has subChar
if(SubChar && hasGoodSubChar){
code = code.substring(firstSubChar+1,lastSubChar);
}
else if(SubChar && !hasGoodSubChar){
return logError(new Error("has bad SubChar"));
}
//has SplitChar
if(SplitChar && hasSplitChar){
return LogFtnReturn(logFtn) && code.split(SplitChar);
}
else if(SplitChar && !hasSplitChar){//error
return logError(new Error("missing SplitChar"));
}
// has code
if(code){
return LogFtnReturn(logFtn) && [code+""];
}
else{//error
return logError(new Error("missing code"));
}
}


function getLibNode(ctg,libNodeId,hashVal){
//Returns the treecontrol or treenode element and/or with it's lib attribute values of strings, booleans, arrays and numbers.
// 1. if it is given a ctg and libNodeId with no hashVal it will return a lib node and it attributes.
// 2. if a hashVal is given, it will only return the lib attrib values.
//NOTE: libNodeId is the id attrib value on a libray node, not the id attrib value on a treenode. The attrib n_type_num value on a treenode is the id attrib value on a libray node. 

var logFtn=LogFtn(new Error(),1,1,1,-1);
var arry = {};

//###### NOT WPN #########
// if it's not a wpn  node
if(ctg.pF!="wpn"){//if0
if(libNodeId=="00"){//if1 library node for tree control
arry.typeNum = libNodeId+"";
arry.node = zLib.*.(@id==ctg.a)[0].*.(@id==ctg.a+ctg.b)[0].*.(@id==ctg.pF)[0];
arry.hashVal = arry.node && arry.node.@hashVal;
}//if1
else if(hashVal){//ei2
arry.typeNum = libNodeId+"";
arry.hashVal = parseInt(hashVal) || false;
//(ctg.pF=="bdn")? alert("hashVal:"+hashVal) : null;
}//ei2

else{//ei3 all other types of library nodes
arry.typeNum = libNodeId+"";
//descendants()..*.(@id== "black")[0]
var getLib  = zLib.*.(@id==ctg.a)[0].*.(@id==ctg.a+ctg.b)[0].*.(@id==ctg.pF)[0];
arry.node = getLib.*.(@id==libNodeId)[0] || getLib.descendants()..*.(@id==libNodeId)[0];
//(ctg.pF=="bdn")? alert("arry.node.toXMLString():"+arry.node.toXMLString()) : null;
//arry.node = zLib.*.(@id==ctg.a)[0].*.(@id==ctg.a+ctg.b)[0].*.(@id==ctg.pF)[0]..*.(@id==libNodeId)[0];
arry.hashVal = arry.node && arry.node.@hashVal;
//alert(ctg.pF +" ||| "+libNodeId);
//alert(zLib.*.(@id==ctg.a)[0].*.(@id==ctg.a+ctg.b)[0].*.(@id==ctg.pF)[0].*.(@id==libNodeId)[0].toXMLString());
//(ctg.pF=="wpn")? alert("libNodeId:"+libNodeId) : null;
//(ctg.pF=="wpn")? alert("arry.node.toSource():"+arry.node.toSource()) : null;
}//ei3
}//if0

//###### IS WPN ############
// Note: wpn uses sets and I think I'll be using this on others libs.
else{//elseWPN
//var nodeLibId = libNodeId.split("|"); 
if(libNodeId=="00"){//if1 get the wpn node for tree control
arry.node = zLib.*.(@id==ctg.a)[0].*.(@id==ctg.a+ctg.b)[0].*.(@id==ctg.pF)[0];
arry.hashVal = arry.node && arry.node.@hashVal;
}//if1

else if(hashVal){//ei2
arry.hashVal = hashVal;
}//ei2
else{//ei3 get either the setNode or a lib node within the setNode.
// The set nodes r in the wpn lib with a tagname <set> .
//Note the compiler changes the id of all wpn lib nodes within the <set> tag. The set tag id does not get changed, only elements within the setNode element. The changed id is a unique number, which can be random. During development the lib will move the old id to a attribute named oldId. The oldid attibute will not exist for beta and final public versions of the program. The oldid attribute is only used to help with developing the program.
var wln = getTree(catg.wln);
var libSet = wln.hasSelNode && wln.selNode.@wpn_set_elm;
//alert(libSet);
arry.typeNum = libNodeId+"";
//descendants()..*.(@id== "black")[0]
var getLibSet  = zLib.*.(@id==ctg.a)[0].*.(@id==ctg.a+ctg.b)[0].*.(@id==ctg.pF)[0].*.(@id==libSet)[0];
//alert("getLibSet:"+getLibSet);
arry.node = getLibSet.*.(@id==libNodeId)[0] || getLibSet.descendants()..*.(@id==libNodeId)[0];
//(ctg.pF=="sdn")? alert("arry.node.toXMLString():"+arry.node.toXMLString()) : null;
//arry.node = zLib.*.(@id==ctg.a)[0].*.(@id==ctg.a+ctg.b)[0].*.(@id==ctg.pF)[0]..*.(@id==libNodeId)[0];
arry.hashVal = arry.node && arry.node.@hashVal;
//alert(ctg.pF +" ||| "+libNodeId);
//alert(zLib.*.(@id==ctg.a)[0].*.(@id==ctg.a+ctg.b)[0].*.(@id==ctg.pF)[0].*.(@id==libNodeId)[0].toXMLString());
//(ctg.pF=="wpn")? alert("libNodeId:"+libNodeId) : null;
//(ctg.pF=="wpn")? alert("arry.node.toSource():"+arry.node.toSource()) : null;
}//ei3
}//elseWPN


// if libNode can not be found use error libNode.
if(!arry.hashVal){
if(!hashVal && !arry.node&&arry.typeNum!="e" || hashVal){
//find error for developer
logChange(new Error("failed to find arry.node:"+arry.typeNum+" for:"+ctg.pF+ " changed typeNum to:e"));
arry.typeNum = "e";
arry.node = zLib.*.(@id==ctg.a)[0].*.(@id==ctg.a+ctg.b)[0].*.(@id==ctg.pF)[0].*.(@id=="e")[0];
arry.hashVal = arry.node && arry.node.@hashVal;
//(ctg.pF=="sde")? alert(libNodeId) : null;
}
}
//alert(arry.node.toXMLString());


//set libNode
// if it has a hash number, add the attributes. Info: Some lib nodes(<set> and others) don't have or need a hashVal attrib
// on some items without attribs can cause some problem when it comes to catching errors on items that do require
// attribs
var attribHashNum = parseInt(arry.hashVal);

//alert(attribHashNum);
if(attribHashNum){//if1 if it has a hash number, add the attributes. Some lib nodes don't have attribs
var attribHashes = zHash.val[attribHashNum];
var attribNames = zHash[ctg.pF];
var attribNamesLength = attribNames.length;
//alert(attribHashes.toSource());
//alert(attribNames.toSource());
for(var i=0;i<attribNamesLength;i++){
//(attribNames[i] =="vV" && ctg.c=="e")? alert(attribHashes[i]) : null;
arry[attribNames[i]] = zHash.val[attribHashes[i]];
}
}//if1
//alert(arry.toSource());

return LogFtnReturn(logFtn) && arry;

}

function getLibAttribByHash(ctg,HashVal){ // not used
LogFtnReturn(logFtn);
return arry;
}

function getNumber(valu,parseType){
// valu(number): is the number to be parsed. Number can be a Int or a floating number.
//parseType(bolean): if left blank it will defaults to retuning what the number is.
// if parseType is true it will return a Int value only, otherwise false will be the same as leaving it blank 
// Returns a array with a parsed number or  blank value.
// The parse number will be floating

var logFtn=LogFtn(new Error(),1,1,1,-1);

var num = {};
num.isBlank = isBlank(valu);// this line must go first
num.string = (num.isBlank)? "" : valu.toString();// this line must go first
valu = parseFloat(valu) || parseInt(valu);
(isNaN(valu))? valu = "" : null;

num.float = parseFloat(valu);
num.int = parseInt(valu);
num.isFloat = num.float.toString() == valu;
//num.isFloat = num.float.toString() == valu || num.float.toString() == "0"+ valu;
num.isInt = num.int.toString() == valu;
num.isNum = num.isInt || num.isFloat;
num.val = (!num.isNum)? "" : (parseType)? num.Int  : (num.isFloat )? num.float : num.Int;
//num.val = (!num.isNum)? (num.isFloat&&!parseType)? num.float : (num.Int)? num.Int : "" : "";
return LogFtnReturn(logFtn) && num;
// ie var retVal = (parseInt(theStr).toString() == theStr && (theStr.toString()).indexOf(".")>-1
//var retVal = (parseInt(theStr).toString() == theStr || parseFloat(theStr).toString() == theStr);
// isNaN();
}

function getParseNumOrRtnBlnk(valu){
// NOT USED, was replaced by getNumber
// return a Parse number, or return blank
// Note the blank part could case problems in some ftns,

var logFtn=LogFtn(new Error(),1,1,1,-1);

var num = parseFloat(valu) || parseInt(valu);

LogFtnReturn(logFtn);

return (num != "NaN")? num : "";
}

function getPathInSS(fileName){
// returns a file path to a folder in the Stacksite folder
var logFtn=LogFtn(new Error(),1,1,1,-1);
return LogFtnReturn(logFtn) && siteRoot + "stacksite/" + fileName +"/";
}

function getPropDump(obj, parent) {
var holdProps=[];
// Go through all the properties of the passed-in object 
for(var i in obj){//for1
// if a parent (2nd parameter) was passed in, then use that to 
// build the message. Message includes i (the object's property name) 
// then the object's property value on a new line 
var msg =(parent)?"Parent\n"+parent + "." + i +"\n"+ obj[i]+"\n"+typeof obj[i] :"OBJ\n"+i + "\n" + obj[i]+"\n"+typeof obj[i];
// Display the message. If the user clicks "OK", then continue. If they 
// click "CANCEL" then quit this level of recursion 
if (!confirm(msg)) { return;}
// If this property (i) is an object, then recursively process the object
if (typeof obj[i] == "object"){ 
if(parent){getPropDump(obj[i], parent + "." + i);} else{getPropDump(obj[i], i);}
}
}//for1
}

function getStringArraySplit(theString,splitWith){
//Returns an array of the split string or false if the string is blank
//Returns false if theString has no value.
var logFtn=LogFtn(new Error(),1,1,1,-1);
theString = notBlank(theString) && theString+"";
LogFtnReturn(logFtn);
return (theString)? theString.indexOf(splitWith)>-1 && theString.split(splitWith) || [theString] : false;
}

function getSubStringWithIn(firstChar,lastChar,code){
//Returns a substring of code between the fstChar and lastChar.
//Returns false if chars can't be found.
var logFtn=LogFtn(new Error(),1,1,1,-1);
var firstCharIndex = code.indexOf(firstChar);
var lastCharIndex = code.lastIndexOf(lastChar);
if(firstCharIndex > -1 && lastCharIndex > -1 && firstCharIndex != lastCharIndex){
return LogFtnReturn(logFtn) && code.substring(firstCharIndex+1,lastCharIndex);
}
else{
return LogFtnReturn(logFtn) && false;
}
}

function getTree(ctg,useSelNodeId){
//Returns the treecontrol. and other stuff. I'll write down later what it returns.
// note it maybe good to have tree.hasSelNode. big maybe. The only reason to have is to return the selNode as the treecontrol and this makes no sence and it could load up memory

// I think getTree could have a second arrgment to past the selected node id. This would allow ftns like delete and some others to get that info and if needed. The problem with that is, it could end up be confusing and misunderstood to others that will need to look at this code later. Needs more thinking.

var logFtn=LogFtn(new Error(),1,1,1,-1);
var tree = {};
tree.controlAttrib = {};
// tree.controlLib = {};
//0276 tree.ctg = ctg;// not sure this is needed anymore

// treeControl
tree.control=zForm[ctg.a]..zztreecontrol.(@id==ctg.pF+"TreeElm")[0] || false;//works
//tree.control = zForm[ctg.a].*.(@id==ctg.pF+"Table1")[0].tr.td[1].child(0);//works
//alert(zForm[ctg.a].*.(@id==ctg.pF+"Table1")[0].tr.td[1].child(0));// works
if(!tree.control){return logError(new Error(ctg.pF+"TreeElm is missing"));}//ifEr

//delete all treenodes if called for
if(useSelNodeId=="clear"){
delete tree.control.zztreenode;
}

tree.hasNodes = tree.control.zztreenode[0] && true || false;

if(useSelNodeId){
tree.selNode = tree.hasNodes &&  tree.control..zztreenode.(@id==useSelNodeId)[0];
}
else{
tree.selNode = tree.hasNodes && getEx4ElmByAttribName(tree.control..zztreenode,"selected");
//100015 tree.selNode=tree.selNodeId!="00"&& tree.control..zztreenode.(@id==tree.selNodeId)[0];
}
//(ctg.pF=="wdn")? alert("tree.control.toSource():"+tree.control.toSource()):null;
tree.hasSelNode = tree.selNode && true || false;



//// these R objects that seem to get used a lot but may want to get ride of  var objNames = ["n_type_num","o_sel","unclicked"];

// get all the attributes
// NOT being used
if(1===2){ // not used 
for each(var xAttrib in tree.control.attributes()){//forAX set each attribute on the element
tree.controlAttrib[xAttrib.name()] = tree.control.@[xAttrib.name()];
}//forAX
}
LogFtnReturn(logFtn);
return tree;
}

function getTreeNodeFileList(folderURL,findTypes,firstFolderName,file){
// description:
// This function gets a xml treenode list of the contents of the specified folder
// which each url is added to the beginning of the array
// arguments:
// the folderURL: is the folder for which you want a treenode contents list, which is expressed as a file:// URL
// findTypes: (blank: is file and folders) (directorys: is folder only) (files: is files only)
// firstFolderName: it's a option to add a name in front of the starting folder ie: site - (then the folderPath)
// file: does nothing, it's strickly used by the ftn and should always be keeped blank
// returns:
// An xml of treenodes that represents the contents of the folder URLs and it's URL
// otherwise if folder does not exist it will return blank
// notes:
// 1: may need to weed out TMP files- if (f.indexOf("TMP") == 0) continue;	// leave temporary files
// 2: maybe it could use a fileFilterMask argument 
var logFtn=LogFtn(new Error(),1,1,1,-1);
var fileAttribute = DWfile.getAttributes(folderURL);
var newNode = createTreeNode();

// check if the first folderURL exist and it's a folder, or return blank
if(logFtn.ftnName != logFtn.ftnRunName){//if1
if(fileAttribute!="D"){logError(new Error("folder is a file error for:"+folderURL));return "";}
folderURL=folderURL.charAt(folderURL.length-1) == "/"&&folderURL.substring(0, folderURL.lastIndexOf("/"))||folderURL;
file = firstFolderName && firstFolderName +" - "+ folderURL || folderURL;
}//if1

newNode.@value = file;
newNode.@icon = (fileAttribute=="D")? 0 : 1; // 0 is folder
newNode.@n_link= folderURL;

// if it's a folder recurse and append files to the newNode
// and leave Dreamweaver folders alone
if(fileAttribute=="D"){//if1
for each(var f in dwFileListFolder(folderURL,findTypes)){//for1
if(f == '_notes'){continue;}
newNode.appendChild(getTreeNodeFileList(folderURL+"/"+f,findTypes,false,f));
}//for1
}//if1
writeTestingPage(true,"getTreeNodeFileList.txt",newNode.toXMLString());
return LogFtnReturn(logFtn) && newNode;
}

function getVformElmById(id){
// Returns a Element in the Vform element.
// Returns False if obj does not Exist and logs it as a error.
var logFtn=LogFtn(new Error(),1,1,1,-1);
var elm = document.getElementById(id);
return ((elm!=null)&&LogFtnReturn(logFtn)&&elm)||logError(new Error("element with id: "+id+" could not be found in the vForm."));
}

function getVformElementsByTagName(tagName){ // not used
var vForm = document.getElementById("vForm");
return vForm.getElementsByTagName(tagName);
}

function getTreeSelNodeSiblingsAndParent(ctg,arry){
var logFtn=LogFtn(new Error(),1,1,1,-1);
arry.selNodeParent = arry.hasSelNode && arry.selNode.parent();
arry.selNodeChildIndex = arry.hasSelNode && arry.selNode.childIndex( );
arry.selNodeNextSibling = arry.hasSelNode && arry.selNodeParent.*[arry.selNodeChildIndex+1] || false;
(arry.selNodeNextSibling && arry.selNodeNextSibling.nodeKind()=="element")? null : arry.selNodeNextSibling = false;
arry.selNodePreviousSibling = arry.selNodeChildIndex>0 && arry.selNodeParent.*[arry.selNodeChildIndex-1] || false;
(arry.selNodePreviousSibling&&arry.selNodePreviousSibling.nodeKind()=="element")?null:arry.selNodePreviousSibling= false;
return LogFtnReturn(logFtn) && arry;
}

function getVformMmSelectElm(){
// get the main Menu select element value
// if obj exist then it will return the obj
// Returns False if obj does not Exist
var logFtn=LogFtn(new Error(),1,1,1,-1);
var vForm = document.getElementById("vForm");
var mnu = vForm.getElementsByTagName("select")[0];
return  LogFtnReturn(logFtn) && mnu.options[mnu.selectedIndex]; // get selected option
}

function getVformSelectElm(elmId,elmObj){
// USED STATUS:
//• in use:false
//• should delete:false

// FUNCTION:
//• getVformSelectElm- It gets all the basic typical element information, values, and the stuff needed to work with an existing html select element located in a Document Object Model structure.

// DESCRIPTION:
//• Creates an returned an array with all the basic typical information, values, and stuff needed to work with this type of element. See "RETURNS:" below for a full detail list of all the basic typical information, values, and stuff return in the array.

// ARGUMENTS:
//• elmId(string)[required]- Is the elements id attribute.
//• elmObj(object)[optional] Is the element object.

// RETURNS:
//• array- The array returns the following of this type of element:
	//{
	//•node: [element object<select>||false],
	//•selNode: [selected element object<option>||false],
	//•selNodeValueNotBlank: [boolean],
	//•selNodeText:[string||false],
	//•selNodeValue:[string||false],
	//}
	
// NOTE:
//• All returned array items will return false if they do not exist or it's string value is blank.

var logFtn=LogFtn(new Error(),1,1,1,-1);
mnu = {};
mnu.node = elmObj || getVformElmById(elmId);
mnu.selNode =  mnu.node && mnu.options[mnu.selectedIndex];
mnu.selNodeValueNotBlank = mnu.selNode && notBlank(mnu.selNode.value) && true;
mnu.selNodeText =  mnu.selNode && notBlank(mnu.selNode.text) || false;
mnu.selNodeValue =  mnu.selNode && mnu.selNode.value || false;
return LogFtnReturn(logFtn) && mnu;
}


function getVformTree(preFix){
// Returns a treecontrol in the Vform element
// Returns False if obj does not Exist and logs it as a error
var logFtn=LogFtn(new Error(),1,1,1,-1);
return LogFtnReturn(logFtn) && getVformElmById(preFix+"TreeElm") || logError(new Error(preFix+"TreeElm in vForm, not found."));
}

function getZFormElms(ctg){ // not used
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
var wpeTd2 = getZFormTagNameById(ctg.a,ctg.pf+"Td4","td");
}

function getZFormElementById(cat1,elmId,tagName){
// FUNCTION:
//• getZFormElementById- Gets a element by it's id attribute value located in a e4x xml object structure.
// DESCRIPTION:
//• Finds and returns a single element object by it's id attribute's value located in a e4x xml object structure. Returns false, if element could not be found.
// ARGUMENTS:
//• cat1(string)[optional]- Is the one letter category code of the panel in which the element is located.
//• elmId(string)[required]- The element's id attribute value.
//• tagName(string)[optional] Is the element's tagname.
// RETURNS:[element object<>||false].
//NOTES:
//• It returns the first element it finds with that id, from a top down structure order. This function will also log an error if element was not found.

//##########FOR DEVELOPMENT ONLY
//ToDoList:
// The for each loop may be slow and some other way may be needed. Using the following line maybe faster but has a bug with moz's JS e4x filter which requires all elements to have an id.
//var elm = zForm[cat1].descendants(tagName).(@id==elmId)[0]; 
// Which creates an error, when an elm does not have a id attribute. So far the for each loop seem to work the best. Which loops the xml ex4 elements and then returns the first element it finds within the e4x structure.


var logFtn=LogFtn(new Error(),1,1,1,-1);
for each(var elm in tagName && zForm[cat1].descendants(tagName) || zForm[cat1]..*){
try{
if(elm.@id==elmId){return LogFtnReturn(logFtn) && elm;}
}
catch(err){}
}
return logError(new Error("Could not find elm with id:"+elmId+ " in ZForm:"+cat1));
}

function getZFormTagNameById(cat1,elmId,tagName){
// FUNCTION:
//• getZFormTagNameById- Gets a element by it's tagName and id attribute value located in a e4x xml object structure.
// DESCRIPTION:
//• Finds and returns a single element object by it's element tagName and id attribute's value located in a e4x xml object structure. Returns false, if element could not be found.
// ARGUMENTS:
//• cat1(string)[optional]- Is the one letter category code of the panel in which the element is located.
//• elmId(string)[required]- The element's id attribute value.
//• tagName(string)[required] Is the element's tagname.
// RETURNS:[element object<>||false].
//NOTES:
//• It returns the first element it finds with that id, from a top down structure order. This function will also log an error if element was not found.

//##########FOR DEVELOPMENT ONLY
//ToDoList:
// The for each loop may be slow and some other way may be needed. Using the following line maybe faster but has a bug with moz's JS e4x filter which requires all elements to have an id.
//var elm = zForm[cat1].descendants(tagName).(@id==elmId)[0]; 
// Which creates an error, when an elm does not have a id attribute. So far the for each loop seem to work the best. Which loops the xml ex4 elements and then returns the first element it finds within the e4x structure. Maybe using a try and catch will work here like it did in the getZFormElementById ftn.

var logFtn=LogFtn(new Error(),1,1,1,-1);
for each(var elm in zForm[cat1].descendants(tagName)){
if(elm.hasOwnProperty("@id") && elm.@id==elmId){
return LogFtnReturn(logFtn) && elm;
}
}
return logError(new Error());
}

function getZFormSelectElm(cat1,elmId,elmObj){
// FUNCTION:
//• getZFormSelectElm- It gets all the basic typical element information, values, and the stuff needed to work with an existing html select element located in a e4x xml object structure.
// DESCRIPTION:
//• Creates an returned an array with all the basic typical information, values, and stuff needed to work with this type of element. See "RETURNS:" below for a full detail list of all the basic typical information, values, and stuff return in the array.
// ARGUMENTS:
//• cat1(string)[optional]- Is the one letter category code of the panel in which the element is located.
//• elmId(string)[optional]- Is the elements id attribute.
//• elmObj(object)[optional] Is the element object.
// RETURNS:
//• array- The array returns the following of this type of element:
	//{
	//•node: [element object<select>||false],
	//•selNode: [selected element object<option>||false],
	//•selNodeValueNotBlank: [boolean],
	//•selNodeText:[string||false],
	//•selNodeValue:[string||false],
	//}
// NOTE:
//• All returned array items will return false if they do not exist or it's string value is blank.

var logFtn=LogFtn(new Error(),1,1,1,-1);
mnu = {};
mnu.node = elmObj || getZFormElementById(cat1,elmId,"select");
mnu.selNode =  mnu.node && getEx4ElmByAttribName(mnu.node.option,"selected");
mnu.selNodeValueNotBlank = mnu.selNode && notBlank(mnu.selNode.@value) && true;
mnu.selNodeText =  mnu.selNode && notBlank(mnu.selNode.text()) || false;
mnu.selNodeValue =  mnu.selNode && mnu.selNode.@value || false;
return LogFtnReturn(logFtn) && mnu;
}

function getZFormTableElm(cat1,elmId,elmObj){
// FUNCTION:
//• getZFormTableElm- It gets all the basic typical element information, values, and the stuff needed to work with an existing html table element located in a e4x xml object structure.
// DESCRIPTION:
//• Creates an returned an array with all the basic typical information, values, and stuff needed to work with this type of element. See "RETURNS:" below for a full detail list of all the basic typical information, values, and stuff return in the array.
// ARGUMENTS:
//• cat1(string)[optional]- Is the one letter category code of the panel in which the element is located.
//• elmId(string)[optional]- Is the elements id attribute.
//• elmObj(object)[optional] Is the element object.
// RETURNS:
//• array- The array returns the following of this type of element:
	//{
	//•node: [element object<table>||false],
	//•style: [string||""],
	//}

var logFtn=LogFtn(new Error(),1,1,1,-1);
elm = {};
elm.node = elmObj || getZFormElementById(cat1,elmId,"table");
elm.style =  elm.node && elm.node.@style || "";
return LogFtnReturn(logFtn) && elm;
}

function getZFormInputTextElm(cat1,elmId,elmObj){
// FUNCTION:
//• getZFormInputTextElm- It gets all the basic typical element information, values, and the stuff needed to work with an existing input text element located in a e4x xml object structure.
// DESCRIPTION:
//• Creates an returned an array with all the basic typical information, values, and stuff needed to work with this type of element. See "RETURNS:" below for a full detail list of all the basic typical information, values, and stuff return in the array.
// ARGUMENTS:
//• cat1(string)[optional]- Is the one letter category code of the panel in which the element is located.
//• elmId(string)[optional]- Is the elements id attribute.
//• elmObj(object)[optional] Is the element object.
// RETURNS:
//• array- The array returns the following of this type of element:
	//{
	//•node: [element object<input type="text"/>||false],
	//•nodeValue: [string||""],
	//•nodeValueIsBlank: [boolean],
	//}

var logFtn=LogFtn(new Error(),1,1,1,-1);
elm = {};
elm.node = elmObj || getZFormElementById(cat1,elmId,"input");
elm.nodeValue = elm.node && elm.node.@value || "";
elm.nodeValueIsBlank = isBlank(elm.nodeValue);
return LogFtnReturn(logFtn) && elm;
}

function getZFormInputColorButtonElm(cat1,elmId,elmObj){
// FUNCTION:
//• getZFormInputColorButtonElm- It gets all the basic typical element information, values, and the stuff needed to work with an existing input color element located in a e4x xml object structure.
// DESCRIPTION:
//• Creates an returned an array with all the basic typical information, values, and stuff needed to work with this type of element. See "RETURNS:" below for a full detail list of all the basic typical information, values, and stuff return in the array.
// ARGUMENTS:
//• cat1(string)[optional]- Is the one letter category code of the panel in which the element is located.
//• elmId(string)[optional]- Is the elements id attribute.
//• elmObj(object)[optional] Is the element object.
// RETURNS:
//• array- The array returns the following of this type of element:
	//{
	//•node: [element object<input type="mmcolorbutton"/>||false],
	//•nodeValue: [string||""],
	//•nodeValueIsBlank: [boolean],
	//}

var logFtn=LogFtn(new Error(),1,1,1,-1);
elm = {};
elm.node = elmObj || getZFormElementById(cat1,elmId,"input");
elm.nodeValue = elm.node && elm.node.@value || "";
elm.nodeValueIsBlank = isBlank(elm.nodeValue);
return LogFtnReturn(logFtn) && elm;
}

function isArray(testObj){
//Test if it's an array. Use only for the compiler. Can be remove on release and beta builds.
//Note in the following coments, that tmp2 is an assoiate array and will return false because it is not a real array like tmp
//var tmp = [5,9,12,18,'blue',30,7,97,53,33,30,35,27,30];
//var tmp2 = {0:5,1:9,2:12} 
//test1 = isArray(tmp);    // returns true
//test2 = isArray(tmp2);   // returns false;
//#############
return testObj && !(testObj.propertyIsEnumerable('length')) && typeof testObj === 'object' && typeof testObj.length === 'number';
}
function isBlank(valu){
// this returns true or false. True if it's blank, false if it's not..
var valuX = valu+""; // the end is needed to trick into a string
if(valuX==null || valuX=="undefined" || valuX==""|| valuX==" "){
return true;
}
for(var i=0;i<valuX.length;i++){//for1
var charX = valuX.charAt(i);
if ((charX!=' ')&&(charX!="\t")){
return false;
}
}//ENDfor1
return true;
}

function isElmSelect(elm){// not in use
// returns true if it is, false if it's not a select element
return elm.tagName.toLowerCase() == "select";
}
function isElmTreeControl(node){// not in use
// returns true if it is, false if it's not a zztreecontrol element
// null is needed on some ftns bc it may test for a parent node that does not exist
return node != null && node.name().toLowerCase() == "zztreecontrol";
}
function isElmTreeNode(node){// not in use
// returns true if it is, false if it's not a number
return (node.name()+"").toLowerCase() == "zztreenode";
}

function isNumber(theStr){//not used, but keep in case.
// returns true if it is a number, false if it's not a number
var retVal = (parseInt(theStr).toString() == theStr || parseFloat(theStr).toString() == theStr);
return retVal;
}


function logChange(errObj){
// only used to log items that the program can not recongnized and
// can't find in the lib, which it has changed successfully to an error item.
// Basically it help see if the change has done the right thing.
// maybe it could upload the logs to zoshe too.
if(!logChangeOn){return;}// if it's off don't run
//logErrorReported = true;
var lineNum = errObj.lineNumber || " ";
var Msg = errObj.message.substring(0,250);
var ftnRunName = arguments.callee.caller.name || " ";
var ftnCaller = arguments.callee.caller.arguments.callee.caller;
var ftnName = ftnCaller && ftnCaller.name || " ";
var ftnArgmnts = arguments.callee.caller.arguments;
var ftnArgmntLngth = ftnArgmnts.length;
var argmnts = (ftnArgmntLngth>0)? "": "none";

for(var i=0;i<ftnArgmntLngth;i++){
argmnts =argmnts+" val"+i+":"+(ftnArgmnts[i]&&typeof ftnArgmnts[i]!="string"&&ftnArgmnts[i].toSource() || ftnArgmnts[i]);
}

var logFolder = wui.logs+"ftn/";
var logFileURL = logFolder+((logFileNum<20)? logFileNum||1 : 20)+".html";

if(logFileNum && DWfile.exists(logFileURL) && DWfile.getSize(logFileURL) < 50000){
var logFile = new XML(DWfile.read(logFileURL));
}
else{
logFileNum = (logFileNum<20)? logFileNum+1 : 20;
logFileURL = logFolder+logFileNum+".html"
var tr = <tr id="trow1"></tr>;
tr.appendChild(<td width="0%">�</td>);
tr.appendChild(<td width="0%">Time:</td>);
tr.appendChild(<td width="0%">Line:</td>);
tr.appendChild(<td width="0%">Ftn:</td>);
tr.appendChild(<td width="0%">runFtn:</td>);
tr.appendChild(<td width="0%">runFtnArgmnts:</td>);
tr.appendChild(<td width="50%">Msg:</td>);
var logFile = <table width="100%"><tbody valign="top">{tr}</tbody></table>;
}

var tRow = <tr></tr>;
tRow.@id = "trow" + Math.random().toString().replace(".","");
tRow.appendChild(<td style="background:blue" width="0%"> </td>);
tRow.appendChild(<td width="0%">Warn</td>);
tRow.appendChild(<td width="0%">{lineNum}</td>);
tRow.appendChild(<td width="0%">{ftnName}</td>);
tRow.appendChild(<td width="0%">{ftnRunName}</td>);
tRow.appendChild(<td width="50%">{argmnts}</td>);
tRow.appendChild(<td width="50%">{Msg}</td>);
logFile.tbody.appendChild(tRow);
var runFns=DWfile.write( logFolder+logFileNum+".html",logFile.toXMLString()) || alert("pemission to write log file failed");

document.getElementById("openTestFileElm").options[0].innerHTML =  "*!WARN";
alert("Warn:"+lineNum+ "@ftn-"+ftnName+ "@runFtn-"+ftnRunName+"@ftnArgmnts-"+argmnts+"@Msg-"+(Msg || ""));

return true;
}

function logError(errObj,reportErrorGobally){
//NEEDED needs to popup a option to reload the extensions or refresh site 
// and bring them to the site page, and to upload the logs to me
// reportErrorGobally will allow the program to know if it should report
// a gobal error, A gobal error should only be used, and set to true if the program needs
// to stop it's forward progress, otherwise it should be left blank or set to false
// furthermore the reportErrorGobally will change the gobal var named reportErrorGobally to true

if(!logErrOn){return;}// if it's off don't run
(reportErrorGobally)? logErrorReported = true : null;
var stackLastLine = errObj.stack && errObj.stack.indexOf("@") && errObj.stack.split("@")[2];
//alert("errObjX:"+errObj.toSource());
var lineNum = (stackLastLine && stackLastLine.indexOf(":"))? parseInt(stackLastLine.substring(stackLastLine.lastIndexOf(":")+1))||" " : errObj.lineNumber || " ";
var Msg = errObj.message +" stack:"+stackLastLine;
//var Msg = errObj.message.substring(0,250);
var ftnRunName = arguments.callee.caller.name || " ";
var ftnCaller = arguments.callee.caller.arguments.callee.caller;
var ftnName = ftnCaller && ftnCaller.name || " ";
var ftnArgmnts = arguments.callee.caller.arguments;
var ftnArgmntLngth = ftnArgmnts.length;
var argmnts = (ftnArgmntLngth>0)? "": "none";

for(var i=0;i<ftnArgmntLngth;i++){
argmnts =argmnts+" val"+i+":"+(ftnArgmnts[i]&&typeof ftnArgmnts[i]!="string"&&ftnArgmnts[i].toSource() || ftnArgmnts[i]);
}

var logFolder = wui.logs+"ftn/";
var logFileURL = logFolder+((logFileNum<20)? logFileNum||1 : 20)+".html";

if(logFileNum && DWfile.exists(logFileURL) && DWfile.getSize(logFileURL) < 50000){
var logFile = new XML(DWfile.read(logFileURL));
}
else{
logFileNum = (logFileNum<20)? logFileNum+1 : 20;
logFileURL = logFolder+logFileNum+".html"
var tr = <tr id="trow1"></tr>;
tr.appendChild(<td width="0%">�</td>);
tr.appendChild(<td width="0%">Time:</td>);
tr.appendChild(<td width="0%">Line:</td>);
tr.appendChild(<td width="0%">Ftn:</td>);
tr.appendChild(<td width="0%">runFtn:</td>);
tr.appendChild(<td width="0%">runFtnArgmnts:</td>);
tr.appendChild(<td width="50%">Msg:</td>);
var logFile = <table width="100%"><tbody valign="top">{tr}</tbody></table>;
}

var tRow = <tr></tr>;
tRow.@id = "trow" + Math.random().toString().replace(".","");
tRow.appendChild(<td style="background:red" width="0%"> </td>);
tRow.appendChild(<td width="0%">Error</td>);
tRow.appendChild(<td width="0%">{lineNum}</td>);
tRow.appendChild(<td width="0%">{ftnName}</td>);
tRow.appendChild(<td width="0%">{ftnRunName}</td>);
tRow.appendChild(<td width="50%">{argmnts}</td>);
tRow.appendChild(<td width="50%">{Msg}</td>);
logFile.tbody.appendChild(tRow);
var runFns=DWfile.write( logFolder+logFileNum+".html",logFile.toXMLString()) || alert("pemission to write log file failed");

document.getElementById("openTestFileElm").options[0].innerHTML = "***ERROR!";
alert("Error:"+lineNum+ "  ftn:"+ftnName+ "  runFtn:"+ftnRunName+"  ftnArgmnts:"+argmnts+"  Msg:"+(Msg || ""));

return false;
}

function LogFtn(errObj,ftnOrder,writeArgmntValues,userLogType,ftnOverRide,ftn_Name){//log Function
// FUNCTION:
//• LogFtn- logs the beginning of running a function, and returns an array with both log information
// and information about the function itself. 
// ARGUMENTS:
//• errObj- (required)(object) is a new Error() Object. It provides lineNumber, file name and other stuff. 
//• ftnOrder- (NOT USED)[NOT USED] not used.
//• writeArgmntValues- (required)[number] -1 = don't write values, 1 = write values. 
//• userLogType- (required)[number] 1- developer, 2-beta testers, 3-EndUser.
//• ftnOverRide- (required)[number] -1 don't overRide logging, 1 = overRide and log it. It's meant to help when developing so the log file does not need to log everything when you only want to log one ftn or ftns. This is set from the function. And should be set to -1.
//• ftn_Name- (optional)[string] 
// RETURNS:
//• array- true if no error, and false if any error occured. 


// var logFtn=LogFtn(ggg,2,1,2,1,1,-1); 
//alert(arguments.callee.caller.name);
//alert(errObj.stack.split("@"));
var a = {};
var ftnCaller = arguments.callee.caller.arguments.callee.caller;
a.ftnName = ftnCaller && ftnCaller.name || ftn_Name || " ";
a.ftnRunName = arguments.callee.caller.name || " ";
//alert("ftnName :"+a.ftnName+" ftnRunName :"+a.ftnRunName);
//if logFtn is off then return a array with just the ftnName and ftnCaller
if(logUserType>=userLogType&&( logFtnOn || ftnOverRide>1)){a.isOn=true;}else{a.isOn=false;return a;}
var lineNum = errObj.lineNumber || " ";
var Msg = errObj.message.substring(0,125);
var ftnArgmnts = arguments.callee.caller.arguments;
var ftnArgmntLngth = ftnArgmnts.length;
var argmnts = (writeArgmntValues<0)? "off": (ftnArgmntLngth>0)? "": "none";
//alert(userLogType +" || " + ftnOverRide +" || " + getVformElmById("logsOverRideBtn").checked);
//alert("ftnName: "+a.ftnName);
//alert("ftnRunName: "+a.ftnRunName);
//alert("errObj.lineNumber: "+errObj.lineNumber);
//alert("errObj.stack: "+errObj.stack);//
alert("logFileNum:"+logFileNum);
for(var i=0;i<ftnArgmntLngth;i++){
argmnts =argmnts+" val"+i+":"+(ftnArgmnts[i]&&typeof ftnArgmnts[i]!="string"&&ftnArgmnts[i].toSource() || ftnArgmnts[i]);
}

var logFolder = wui.logs+"ftn/";
var logFileURL = logFolder+((logFileNum<20)? logFileNum||1 : 20)+".html";
var logFile = "";
if(logFileNum && DWfile.exists(logFileURL) && DWfile.getSize(logFileURL) < 25000){
logFile = new XML(DWfile.read(logFileURL));
}
else{ // this needs work
logFileNum = (logFileNum<20)? logFileNum+1 : 20;
logFileURL = logFolder+logFileNum+".html"
var tr = <tr id="trow1"></tr>;
tr.appendChild(<td width="0%">�</td>);
tr.appendChild(<td width="0%">Time:</td>);
tr.appendChild(<td width="0%">Line:</td>);
tr.appendChild(<td width="0%">Ftn:</td>);
tr.appendChild(<td width="0%">runFtn:</td>);
tr.appendChild(<td width="50%">runFtnArgmnts:</td>);
tr.appendChild(<td width="50%">Msg:</td>);
logFile = <table width="100%"><tbody valign="top">{tr}</tbody></table>;
tr = null;
}

var tRow = <tr></tr>;
tRow.@id = a["tRowId"] = "trow" + Math.random().toString().replace(".","");
tRow.appendChild(<td style="background:yellow" width="0%"> </td>);
tRow.appendChild(<td width="0%"> </td>);
tRow.appendChild(<td width="0%">{lineNum}</td>);
tRow.appendChild(<td width="0%">{a.ftnName}</td>);
tRow.appendChild(<td width="0%">{a.ftnRunName}</td>);
tRow.appendChild(<td width="50%">{argmnts}</td>);
tRow.appendChild(<td width="50%">{Msg}</td>);
logFile.tbody.appendChild(tRow);
var runFns=DWfile.write( logFolder+logFileNum+".html",logFile.toXMLString()) || alert("pemission to write log file failed");
logFile = tRow = argmnts = null;
a["logFileURL"] = logFolder+logFileNum+".html";
a["time"] = new Date().getTime(); // needs to go last to give the most accur time.
return a;
}

function LogFtnReturn(logFtnArray){//log Function
if(logFtnArray.isOn){
//alert(" logFtnArray['time']:"+logFtnArray["time"]+" logFtnArray['tRowId']:"+logFtnArray["tRowId"]+" logFtnArray['logFileURL']:"+logFtnArray["logFileURL"]);
var timeX = new Date().getTime() - logFtnArray["time"]; // needs to go first to give the most accur time.
var logFile = new XML(DWfile.read(logFtnArray["logFileURL"]));
var trNode=logFile..tr.(@id==logFtnArray["tRowId"]);
trNode..td[0].@style = "background:green";
trNode..td[1] = timeX;
//alert(DWfile.write(logFtnArray["logFileURL"],logFile.toXMLString()));
if(!DWfile.write(logFtnArray["logFileURL"],logFile.toXMLString())){
alert("pemission to write log file failed");
logError(new Error("pemission to write log file failed"));

return false;
}
}
return true;
}



function notBlank(valu){
// FUNCTION:
//• notBlank- checks if a value is blank. 
// ARGUMENTS:
//• valu- (required)[string||number||booleen] All values will be first converted to a string, and then checked if value is blank.
// RETURNS:
//• string||boolean if is not blank it will return the value as a string. Otherwise it will return a false boolean. If argument valu is a number it will return that number but it will be in the form of a string. If argument valu is booleen(true||false) it too will be converted and returned as a string too.

var valuX = valu+""; // the end is needed to trick into a string
if(valuX==null || valuX=="undefined" || valuX==""){
return false;
}
for(var i=0;i<valuX.length;i++){//for1
var charX = valuX.charAt(i);
if ((charX!=' ')&&(charX!="\n")&&(charX!="\t")&&(charX!="\r")){
return valu;
}
}//ENDfor1
return false;
}


function dwChangeFileInTab(ctg,useSelNodeId,useMessage,editRefresh,dontErrorIfFileIsMissing){
// FUNCTION:
//• dwChangeFileInTab- changes the file in the dreamweaver tab, by opening the needed file for
//   the stacksite panel, and closing the last used file, which stacksite used.
// ARGUMENTS:
//• ctg- (required)[string] Is the category name of the active stacksite panel tool being used.
//• useSelNodeId- (optional)[string] This sets this ftn to use this selNodeId as the selNode of ctg. The string value should be of a existing selected node of ctg. 
//• editRefresh- (required)[string] This tell what type of page refresh is needed. The string value can be none|page|style. default is none.
//• editView- (required)[string] This tell what type of page view is needed. The string value can be user|code|split|design. default is code.
//• useMessage- (optional)[string] This puts a message in the browser. The string value can be of text or html. 
//• dontErrorIfFileIsMissing- (optional)[booleen] Default is false, and should be left blank unless it's being used when a file is being deleted from the calling ftn, which maybe missing bc the user may have already deleted it
// RETURNS:
//• boolean- true if no error, and false if any error occured. 
// NOTES:
//• the following may work too and needs testing: closeAllWindowsButCurrentOne(),
//• At some point I believe Location will need to be work into this ftn
// currently it just calls the site + file without any search included in the url
// most of the code is there to include having it call url's with search added to it
//• dom.getParseMode() it returns  "html", "xml", "css", or "text" could be useful here 
//• Restarting Dreamweaver and opening or creating a document shows the document in the Code and Design view with the last used size and orientation. The dreamweaver.setSplitViewOrientation() function sets the orientation and dreamweaver.setPrimaryView() sets the primary view. For information on using these functions, see "Vertical Split view functions" in the Dreamweaver API Reference.
//• editView above is not used, but keeping it in here just in case I need to do something like this.
var logFtn=LogFtn(new Error(),1,1,1,-1);
//USED FOR TESTING*********************************************************
if(!browserRefreshOn){return true;}

//SET THE FTN ARGUMENTS****************************************************
ctg = catg[ctg] || logError(new Error());
useSelNodeId = notBlank(useSelNodeId);
useMessage = notBlank(useMessage);
editRefresh = notBlank(editRefresh);
// editView = notBlank(editRefresh) || "code";
dontErrorIfFileIsMissing = notBlank(dontErrorIfFileIsMissing);

//SET USE ROOT PATH********************************************************
//When no site is selected or can not be found, it needs to use the users config file to create a message page. 
var useRoot =   siteRoot || wui.configpath;
var styleRefreshNeeded = editRefresh == "style";
var pageRefreshNeeded = editRefresh == "page";

//LAST USED FILE INFO******************************************************
var lastCTG = catg[browserLastCtg];
var last = getTree(lastCTG);
var lastNLink = last.hasSelNode && notBlank(last.selNode.@n_link);
var lastFile = notBlank(last.control.@last_file) || useRoot + "stacksite/temp/"+zLang._messagepage+".html";
var lastFileExist = lastFile && dwFileExist(lastFile);
var lastSearch = notBlank(last.control.@last_search) || ""; //not used
var lastLocation = notBlank(last.control.@last_location) || lastFile + lastSearch;
var lastHasTab = dwHasFileInTab(lastFile);
var lastCanBeSaved = lastHasTab && dwCanSaveFileInTab(lastFile);
var vcx = dwGetFileDom(lastFile);
var lastDom = lastHasTab && dwGetFileDomInTab(lastFile);
var lastView = (lastDom && lastDom.getView()) || notBlank(last.control.@last_view);
var lastLiveView = (lastDom && lastDom.getDesignViewMode()) || notBlank(last.control.@last_live_view);
var lastLiveCode = (lastDom && lastDom.getLiveCodeEnabled()) || (last.control.@last_live_code  == "true");
var lastIsFilePage = lastCTG.a=="w" || lastCTG.a=="n" || lastCTG.a=="j";
var lastIsMessagePage = lastFile.indexOf("stacksite/temp/"+zLang._messagepage+".html")>-1;//// not used


//SAVE LAST USED FILE SETTINGS*********************************************
if(lastIsFilePage && !lastIsMessagePage){
last.control.@last_view = lastView || "";
last.control.@last_live_view = lastLiveView || "";
last.control.@last_live_code = lastLiveCode || "";
}
last.control.@last_file = lastFile || "";
last.control.@last_search = lastSearch || "";
last.control.@last_location = lastLocation || "";

//SAVE LAST USED FILE*******************************************************
//if it exist in the file system and is opened in a tab
if(lastHasTab && lastFileExist && lastCanBeSaved){//if1
//for Non-Snipit
if(lastCTG.a!="n"){
dwSaveFileInTab(lastFile);
}
//for Snipit
else if(lastCTG.a=="n" && last.hasSelNode){
//NOTE could put a confirm here if they want to save the changes
var savendn = saveNDN() && dwSaveFileInTab(lastFile);
}
}//if1

//RELEASE LAST USED FILE DOM***********************************************
//(lastDom)? dwReleaseDocument() : null;

//OPEN FILE INFO*************************************************************
var opnCTG = ctg;
var opnIsFilePage = opnCTG.a=="w" || opnCTG.a=="n" || opnCTG.a=="j";
var opn = (lastCTG.pF === opnCTG.pF)? last : getTree(opnCTG,useSelNodeId);
var opnNLink = !useMessage && opn.hasSelNode && notBlank(opn.selNode.@n_link);
var opnFile = (opnNLink)? useRoot + getUrlFullLocalPath(opnNLink): useRoot+ "stacksite/temp/"+zLang._messagepage+".html";
var opnFileExist = opnFile != useRoot && dwFileExist(opnFile);
var opnSearch =  notBlank(opn.selNode.@n_search) || "";
var opnLocation = opnFile + opnSearch;
var opnHasTab = dwHasFileInTab(opnFile);
var opnCanBeSaved = opnHasTab && dwCanSaveFileInTab(opnFile);
var opnDom =  opnHasTab && dwGetFileDomInTab(opnFile);
var opnView = (opnDom && opnDom.getView()) || notBlank(opn.control.@last_view);
var opnLiveView = (opnDom && opnDom.getDesignViewMode()) || notBlank(opn.control.@last_live_view);
var opnLiveCode = (opnDom && opnDom.getLiveCodeEnabled()) || (opn.control.@last_live_code  == "true");
var opnIsFilePage = opnCTG.a=="w" || opnCTG.a=="n" || opnCTG.a=="j";
var opnIsMessagePage = opnFile.indexOf("stacksite/temp/"+zLang._messagepage+".html")>-1 || useMessage && true;
var opnNewMsg = useMessage || "";
//These act like the default
var opnViewToo = !opnIsMessagePage && opnView || "design";
var opnLiveViewToo = !opnIsMessagePage && opnLiveView || "live";
var opnLiveCodeToo = !opnIsMessagePage && opnLiveCode;


//REPAIR *****************************************************************
//NDN(SNIPIT) FILE
//if it does not exist to open
if(opnCTG.a=="n" && opn.hasSelNode && !opnFileExist){
opnFileExist = saveUfileLoader("ndn") && save_DN(catg.ndn,opn.selNode.@id);
}


//USE MESSAGE PAGE WHEN *******************************************
//NOTE: I NEED TO CREATE A FTN TO CREATE PAGES FOR STUFF LIKE SDN which get called from the dwChangeFileInTab ftn.
// THE FTN can be called createMessageSDN1() the ftn can return bacic info
//NEEDED it needs to create a message for each panel.

//A SELECTED FILE DOES NOT EXIST.
//Page requested not found message page.
if(opn.hasSelNode && !opnFileExist&&siteRoot&&opnIsFilePage&&!dontErrorIfFileIsMissing){
opnFile = useRoot+ "stacksite/temp/"+zLang._messagepage+".html";
opnFileExist = dwFileExist(opnFile);
opnSearch = "";
opnLocation = opnFile + opnSearch;
opnHasTab = dwHasFileInTab(opnFile);
opnDom = opnHasTab && dwGetFileDomInTab(opnFile);
opnCanBeSaved = opnHasTab && dwCanSaveFileInTab(opnFile);
opnView = opnDom && opnDom.getView();
opnLiveView = (opnDom)? opnDom.getDesignViewMode() : false;
opnLiveCode = (opnDom)? opnDom.getLiveCodeEnabled() : false;
opnViewToo = "design";
opnLiveViewToo = "live";
opnLiveCodeToo = false;
opnIsMessagePage = true;
(opnCTG.a=="w")?opnNewMsg+= opn.selNode.@n_name+" "+zLang._Page+ " "+zLang._couldNotBeFound+".":null;
(opnCTG.a=="n")?opnNewMsg+= opn.selNode.@n_name+" "+zLang._Snipit+ " "+zLang._couldNotBeFound+".":null;
(opnCTG.a=="j")?opnNewMsg+= opn.selNode.@n_name+" "+"Script"+ " "+zLang._couldNotBeFound+".":null;
(opnCTG.a=="j" || opnCTG.a=="n" || opnCTG.a=="w")? alert(preMsg) : null;
opnNewMsg += "<br /><br />"+ zLang["_message4holdPage"];
}
//NO FILE IS SELECTED IN THE STACKSITE PANEL.
//No file selected message page.
else if(!opn.hasSelNode){
opnIsMessagePage = true;
opnNewMsg = zLang["_message4holdPage"];
}
//HAS A SITE SELECTED IN THE SITE PANEL(SDN)
// site information page.
else if(opn.hasSelNode && opnCTG.pF == "sdn"){
opnIsMessagePage = true;
opnNewMsg = "site name:"+opn.selNode.@n_name +"<br />";
opnNewMsg += "I NEED TO PUT AND ADD MORE INFO HERE.<br />";
}


//OPEN**************************************************
//FILE PAGE, IF NOT OPEN IN A TAB
if(!opnHasTab && !opnIsMessagePage){//if1
dw.setActiveWindow(lastFile);//NOTE: I DONT THINK THIS LINE IS NEEDED HERE
dwOpenFileInTab(opnFile);
opnHasTab = dwHasFileInTab(opnFile);
opnDom = opnHasTab && dw.getDocumentDOM(opnFile);
opnView = opnDom && opnDom.getView();
opnLiveView = opnDom && opnDom.getDesignViewMode();
opnLiveCode = opnDom && opnDom.getLiveCodeEnabled();
}//if1
//MESSAGE PAGE IS ALREADY OPEN IN A TAB
else if(opnIsMessagePage && opnFile.indexOf("stacksite/temp/"+zLang._messagepage+".html")>-1){//else2
//alert(opnFile);
//alert(dwFileWriteAndReloadDom(opnFile,opnNewMsg));
dwFileWriteAndReloadDom(opnFile,opnNewMsg);
dwOpenFileInTab(opnFile);
//alert(dwOpenFileInTab(opnFile));
opnHasTab = dwHasFileInTab(opnFile);
opnDom = opnHasTab && dw.getDocumentDOM(opnFile);
pageRefreshNeeded = true; //I don't think this will be needed
//(opnHasTab);
}//else2

//FILE FAILED TO OPEN************************************
if(!opnDom){
//NEEDS WORK
//dwChangeFileInTab(ctg,useSelNodeId,useMessage,editRefresh,dontErrorIfFileIsMissing);
alert("ERROR:file failed to open");
// return false
}


//CLOSE***************************************************
//LAST USED DOCUMENT.
// if the last used document(lastFile) is open in a tab and is not the same as the opnFile,
// then the lastFile will be closed, and the opnFile will be set as the Active tab.
if(lastHasTab && opnFile!=lastFile){//if1
dwCloseFileInTab(lastFile);
opnDom = dwGetFileDomInTab(opnFile);
dw.setActiveWindow(opnDom);
}//if1
//OR MAKE OPENFILE ACTIVE IN TAB.
else{//el1
dwOpenFileInTab(opnFile);
//alert("jjjj");
}//el1


//SET TAB***************************************************
//LIVE CODE
if(opnLiveCode!=opnLiveCodeToo){
opnDom.setLiveCodeEnabled(opnLiveCodeToo);
opnView = opnDom.getView();
}
//LIVE VIEW
else if(opnLiveView!=opnLiveViewToo){
opnDom.setDesignViewMode(opnLiveViewToo);
opnView = opnDom.getView();
}

//VIEW
if(opnView!=opnViewToo){
opnDom.setView(opnViewToo);
}


//REFRESH TAB'S VIEW ***************************************************
//PAGE STYLE.
//If needed, this refreshes the styling of the page in the Tab without changing the User's page scroll positions. 
if(styleRefreshNeeded){
//if(opnViewToo != "code" && styleRefreshNeeded){
//alert("PAGE STYLE");
dwRefreshStyleInTab(opnFile);
}
//WHOLE PAGE.
//If needed, this refreshes the whole page in the Tab. If the User had any scroll positions they will be lost. Basically this is a complete page reload.
else if(opnViewToo != "code" && pageRefreshNeeded){
//	alert("WHOLE PAGE");
dwReloadFileInTab(opnFile);
}

//SET OPN FILE'S LAST USED VALUES FOR NEXT TIME ***********************************
browserLastCtg = ctg.pF;
opn.control.@last_file = opnFile;
opn.control.@last_search =opnSearch;
opn.control.@last_location = opnLocation;
if(opnIsFilePage){
opn.control.@last_view =  opnViewToo;
opn.control.@last_live_view =  opnLiveViewToo;
opn.control.@last_live_code = lastLiveCode;
}

return LogFtnReturn(logFtn);
}


function dwCanSaveFileInTab(fileURL){
// FUNCTION:
//• dwCanSaveFileInTab- can save file in a dreamweaver tab.
// DESCRIPTION:
//• Detremines if a file can be saved.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to save in an open tab.
// RETURNS:
//• boolean- If fileURL is open in a tab and can be saved, it will return true. Otherwise it will return true false.

var logFtn=LogFtn(new Error(),1,1,1,-1);

for each(var tab in dw.getDocumentList()){
if(tab.URL == fileURL){
return LogFtnReturn(logFtn) && dw.canSaveDocument(tab);
}
}
return LogFtnReturn(logFtn) && false;
}


function dwCloseFileInTab(fileURL){
// FUNCTION:
//• dwCloseFileInTab- closes a file in a dreamweaver tab.
// DESCRIPTION:
//• Closes a open file. If the fileURL is open in a tab, the file will be saved if it exist in the file system, and then it's tab will be closed.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to close in an open tab.
// RETURNS:
//• boolean- If tab is closed or was closed already it will return true. If tab is open and can not be closed, it will return false.

var logFtn=LogFtn(new Error(),1,1,1,-1);

for each(var tab in dw.getDocumentList()){
if(tab.URL == fileURL){
dw.setActiveWindow(dw.getDocumentDOM(fileURL));
var saveFile = dwCanSaveFileInTab(fileURL) && dwSaveFileInTab(fileURL) || true;
dw.moveToNewWindow(tab);
dw.setActiveWindow(dw.getDocumentDOM(fileURL));
dw.closeDocument(fileURL);
return;
}
}
return LogFtnReturn(logFtn);
}

function dwFileExist(fileURL,returnURL){
// FUNCTION:
//• dwFileExist- Does a file or folder exist.
// DESCRIPTION:
//• Checks if a file or folder exist in the file system.
// ARGUMENTS:
//• fileURL-[required] (string)- Is the full url of the file or folder U wish to check if it exist.
//• returnURL-[optional](boolean)- A true value makes this function return the actual url string if the file or folder exist. If ommitted(left blank), it defaults to false.

// RETURNS:
//• boolean- If file or folder does exist it will return true. Returns false if it does not exist.
//• fileURL(when returnType is set to true) - If file or folder does exist it will return the fileURL. Otherwise it will return false if the file does not exist.

var logFtn=LogFtn(new Error(),1,1,1,-1);

if(returnURL && fileURL && DWfile.exists(fileURL)){
return LogFtnReturn(logFtn) && fileURL;
}
else if(fileURL){
return LogFtnReturn(logFtn) && DWfile.exists(fileURL);
}
return LogFtnReturn(logFtn) && false;
}




function dwFileListFolder(folderURL,constraint){
// FUNCTION:
//• dwFileListFolder- list of files found in a folder.
// DESCRIPTION:
//• If folder exist in the file system, it returns a content array list of URL string.
// ARGUMENTS:
//• folderURL-[required] (string)- Is the full url of the folder U wish to obtain a list of file and/or files contain in it.
//• constraint-[optional](string)- Default or left blank will return both files and folders. Otherwise it must be either "files" (which return only files) or "directories" (which return only folders).

// RETURNS:
//• boolean- If folderURL is left blank it will return false. Otherwise it will return the Array.
//• Array - An array of strings that represents the contents of the folderURL.

var logFtn=LogFtn(new Error(),1,1,1,-1);

if(folderURL){
return LogFtnReturn(logFtn) && DWfile.listFolder(folderURL,constraint);
}
return LogFtnReturn(logFtn) && logError(new Error("Missing Folder URL"));
}

function dwFileWrite(fileURL,fileText){
// FUNCTION:
//• dwFileWrite- writes File, to user storage system.
// DESCRIPTION:
//• It writes fileURL with fileText to user storage system. If file URL does not exist it will create the file.
// ARGUMENTS:
//• fileURL- Is the full url of the file to write the fileText too.
//• fileText- Is the text of the file tobe written.
// RETURNS:
//• boolean- If the fileURL is successfully written, it will return true. Otherwise it returns false.
var logFtn=LogFtn(new Error(),1,1,1,-1);
return DWfile.write(fileURL,fileText) && LogFtnReturn(logFtn) || logError(new Error("fileWriteFailed:"+fileURL));
}


function dwFileWriteAndReloadDom(fileURL,fileText){
// FUNCTION:
//• dwFileWriteAndReloadDom- writes File, and reLoads the file's dreamweaver Dom source.
// DESCRIPTION:
//• It writes fileURL with fileText, and reloads it's Dreamweaver DOM, which also rewrite the viewed codes in the users tab or related file.
// ARGUMENTS:
//• fileURL- Is the full url of the file to write the fileText too, and reload its dreamweaver DOM.
// RETURNS:
//• boolean- If the fileURL and the Dreamweaver's DOM is successfully reloaded, it will return true. Otherwise it returns false.
var logFtn=LogFtn(new Error(),1,1,1,-1);
return (dwFileWrite(fileURL,fileText) && dwReloadDom(fileURL) && LogFtnReturn(logFtn))||logError(new Error());

}

function dwReloadDom(fileURL){
// FUNCTION:
//• dwReloadDom- reLoads the file's dreamweaver Dom source.
// DESCRIPTION:
//• If the fileURL exist, it reloads the Dreamweaver DOM.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to reload its dreamweaver DOM.
// RETURNS:
//• boolean- If the fileURL Dreamweaver's DOM is successfully reloaded, it will return true. Otherwise it returns false.

// NOTE: replaceRange needs to make sure it's range is long enough to remove all code
// May need to check if file dom needs to be saved, by checking if the text is different.
var logFtn=LogFtn(new Error(),1,1,1,-1);
var fileText = DWfile.read(fileURL);
var fileTextLength = fileText.length;
var dom = dw.getDocumentDOM(fileURL);
var domText = dom && dom.source.getText();
var domTextLength = domText.length;
var rangeLength = (fileTextLength>domTextLength)? fileTextLength : domTextLength;
//alert("dom:"+dom);
if(dom){
dom.source.replaceRange(0,rangeLength,fileText);
return LogFtnReturn(logFtn);
}

return logError(new Error());
}

function dwReloadDomInTab(fileURL){
// FUNCTION:
//• dwReloadDomInTab- reLoads the file's dreamweaver Dom source, if it exist in a tab.
// DESCRIPTION:
//• If the fileURL exist and is open in a tab, it reloads it's Dreamweaver DOM, which also rewrite the viewed codes in the users tab.
// ARGUMENTS:
//• fileURL- Is the full url of the file open in a tab U wish to reload its dreamweaver DOM and current user tab view.
// RETURNS:
//• boolean- If the fileURL Dreamweaver's DOM is successfully reloaded, it will return true. Otherwise it returns false.

var logFtn=LogFtn(new Error(),1,1,1,-1);
var fileText = DWfile.read(fileURL);

for each(var tab in dw.getDocumentList()){
if(tab.URL == fileURL && fileText){
var dom = dw.getDocumentDOM(fileURL);
var domText = dom && dom.source.getText();
var domTextLength = domText.length;
var rangeLength = (fileTextLength>domTextLength)? fileTextLength : domTextLength;
dom.source.replaceRange(0,rangeLength,fileText);
return LogFtnReturn(logFtn);
}
}
return LogFtnReturn(logFtn) && false;
}




function dwGetFileDom(fileURL){
// FUNCTION:
//• dwGetFileDomTab- gets the dreamweaver file DOM if it exist.
// DESCRIPTION:
//• Detremines if a file exist, it will return the document object model(DOM).
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to get it's dom.
// RETURNS:
//• DOM || boolean- If fileURL exist, it will return the DOM. Otherwise it will return false.
//alert(fileURL);
var logFtn=LogFtn(new Error(),1,1,1,-1);
LogFtnReturn(logFtn);
return dwFileExist(fileURL) && dreamweaver.getDocumentDOM(fileURL) || false;
}


function dwGetFileDomInTab(fileURL){
// FUNCTION:
//• dwGetFileDomTab- gets the dreamweaver file DOM if it's open a tab.
// DESCRIPTION:
//• Detremines if a file is open in a tab, if it's open, it returns the document object model(DOM) .
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to check if it's open in a tab, and return its DOM.
// RETURNS:
//• DOM || boolean- If fileURL is open in a tab, it will return the DOM in the Tab. Otherwise it will return false.
var logFtn=LogFtn(new Error(),1,1,1,-1);
for each(var tab in dw.getDocumentList()){
if(tab.URL == fileURL){
return LogFtnReturn(logFtn) && tab;
}
}
return LogFtnReturn(logFtn) && false;

}

function dwHasFileInTab(fileURL){
// FUNCTION:
//• dwHasFileInTab- dreamweaver has file In tab open.
// DESCRIPTION:
//• Detremines if a file is open in a tab.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to check if it's open in a tab.
// RETURNS:
//• boolean- If fileURL is open in a tab, it will return true. Otherwise it will return false.
var logFtn=LogFtn(new Error(),1,1,1,-1);
for each(var tab in dw.getDocumentList()){
if(tab.URL == fileURL){
return LogFtnReturn(logFtn);
}
}
return LogFtnReturn(logFtn) && false;

}




function dwOpenFileInTabBrowser(fileURL,browserFileURL){// NOT USED and NOT FINISHED
// FUNCTION:
//• dwOpenFileInTabBrowser- If the fileURL exist in the file system, it will open this file in the dreamweaver tab's browser with the same URL as the openInTabWithThisURL argument.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to open in a tabs browser that already exist.
//• browserFileURL- Is the full url of the file which is to be open in the tab's browser Window.
// RETURNS:
//• boolean- If browserFileURL opens in the existing fileURL tab browser it will return true. If the file opening fails, or fileURL or browserFileURL is blank, or fileURL or browserFileURL does not exist, it will return false.

// if fileURL is blank.
// NEEDED maybe an error should go here
if(!notBlank(fileURL)){return false;}
if(!notBlank(browserFileURL)){return false;}

// If fileURL is currently open in one of the other tabs
for each(var tab in dw.getDocumentList()){//for1
if(tab.URL == fileURL){//if1
if(!dwOpenFileInTab(fileURL)){return false;}
var dom = dw.getActiveWindow(fileURL);
var domBrowser = dom && dom.browser;
var domBrowserURL = dom.browser.getURL()
return domBrowser.openURL(browserFileURL);
//(browser)? browser.refreshPage() : null;

//dreamweaver.releaseDocument(dw.getDocumentDOM());
//dw.setActiveWindow(tab);
//return true;
}//if1
}//for1
return false;
}

function dwOpenFileInTab(fileURL,dd){
// FUNCTION:
//• dwOpenFileInTab- Opens a file in a dreamweaver tab.
// DESCRIPTION:
//• If the fileURL exist in the file system, it will open a file in a dreamweaver tab.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to open in a new tab.
// RETURNS:
//• boolean- If file can be open in a tab it will return true. If th file opening fails, or fileURL is blank, or file does not exist, it will return false.

var logFtn=LogFtn(new Error(),1,1,1,-1);

// if fileURL is blank.
if(isBlank(fileURL)){
return logError(new Error("missing URL"));
}

// If fileURL is currently open in the the active tab
if(dw.getDocumentDOM() && dw.getDocumentDOM().URL == fileURL){
return LogFtnReturn(logFtn);
}

// If fileURL is currently open in one of the other tabs
for each(var tab in dw.getDocumentList()){
if(tab.URL == fileURL){
dreamweaver.releaseDocument(dw.getDocumentDOM());
dw.setActiveWindow(tab);
return LogFtnReturn(logFtn);
}
}

// If fileURL is currently not open in any tab.
if(dwFileExist(fileURL)){
(dw.getDocumentDOM())? dreamweaver.releaseDocument(dw.getDocumentDOM()) : null;
return (dw.openDocument(fileURL) && LogFtnReturn(logFtn)) || (LogFtnReturn(logFtn) && false);
}
return LogFtnReturn(logFtn) && false;
}

function dwReleaseDocument(fileURL){
// FUNCTION:
//• dwReleaseDocument- releases the dreamweaver file DOM.
// DESCRIPTION:
//• Detremines if file has dom, it releases the document object model(DOM) to free up memory.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to release its dreamweaver DOM.
// RETURNS:
//• nothing-
var logFtn=LogFtn(new Error(),1,1,1,-1);
dreamweaver.releaseDocument(dw.getDocumentDOM(fileURL));
LogFtnReturn(logFtn);
}

function dwReloadFileInTab(fileURL){
// FUNCTION:
//• dwReloadFileInTab- Refreshes the file in a dreamweaver tab.
// DESCRIPTION:
//• Refreshes a open file in a tab.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to load in a new tab.
// RETURNS:
//• boolean- If fileURL is open in a tab it will refresh it and return true. If fileURL is open in a tab and refreshing fails, it will return false.

// browser.refreshPageStyles();
// browser.refreshPage();
// dw.refreshRelatedFiles()
//dw.getDocumentDOM().runValidation('auto-implicit',false);

var logFtn=LogFtn(new Error(),1,1,1,-1);

for each(var tab in dw.getDocumentList()){//for1
if(tab.URL == fileURL){//if1
//alert(dw.getFocus(fileURL));
if(!dwOpenFileInTab(fileURL)){return false;}

var getFocus = dw.getFocus();
// if BROWSER VIEW.
if(getFocus == 'browser' || getFocus == 'html' || getFocus == 'textView'){//if2
var dom = dw.getActiveWindow(fileURL);
var browser = dom && dom.browser;
(browser)? browser.refreshPage() : null;
}//if2
// if DESIGN VIEW.
else if(getFocus == 'document' && dw.getDocumentDOM().getFocus() == 'body'){//if3
dw.getDocumentDOM().refreshView('design');
}//if3

// If user was using textview, set tab focus back to TEXT VIEW.
if (getFocus == 'textView'){//if4
dw.setFocus(getFocus);
}//if

return LogFtnReturn(logFtn);
}//if1
}//for1

return false;

}

function dwRefreshStyleInTab(fileURL){
// FUNCTION:
//• dwRefreshStyleInTab- Refreshes the file style in a dreamweaver tab.
// DESCRIPTION:
//• Refreshes the page without changing the user's scrollbar positions.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to refresh in a tab.
// RETURNS:
//• boolean- If file opens in a tab it will refresh it and return true. If file is not open in a tab or the page fails to refresh, it will return false.
// browser.refreshPage();
// dom.getShowLayoutView() // returns true if in layout mode
// dom.getWindowObj();
// dom.refreshView('design');
// dom.resetAllElementViews(false); // true make the whole page refresh
// dom.setShowLayoutView() // true will turn it on to layout mode
// dom.synchronizeDocument();
// dw.canSaveAllRelatedFiles()
// dw.closeRelatedFile(relatedFileURL);
// dw.openRelatedFile(fileURL);
// dw.refreshRelatedFiles();
// dw.releaseDocument(dw.getDocumentDOM())
// dw.saveAllRelatedFiles()
// dw.setRelatedFilesFilter("");
// dw.setRelatedFilesFilter(RelatedFilesFilterStrings);
//NOTE:
//• maybe there is a way to use a .reload()
var logFtn=LogFtn(new Error(),1,1,1,-1);

//Make sure file is open
if(!dwOpenFileInTab(fileURL)){return false;}


//Save any related files
(dw.canSaveAllRelatedFiles())? dw.saveAllRelatedFiles() : null;
/*

var fileURLBinar = fileURL.replace(/ /g,"%20");
var activeRelatedFileURL = dreamweaver.getActiveRelatedFilePath();
var activeRelatedFileURLclean = activeRelatedFileURL.replace(/\%20/g," ");
var relatedFiles = dw.getRelatedFiles(false);
var RelatedFilesFilterStrings = dw.getQuickRelatedFilesFilterStrings();
var canSaveAllRelatedFiles = dw.canSaveAllRelatedFiles();

//REFRESH ALL RELATED FILES NOT SHOWING IN VIEW ****************
alert(changedFiles.toSource());
for each(var relatedFileURL in relatedFiles){//for1
dreamweaver.refreshRelatedFiles(relatedFileURL);
dreamweaver.openRelatedFile(relatedFileURL);
//if(relatedFileURL!=fileURLBinar){
//}

}
//alert("canSaveAllRelatedFiles:"+dw.canSaveAllRelatedFiles());
dw.saveAllRelatedFiles();
//dreamweaver.openRelatedFile(relatedFileURL);

var dom = dw.getDocumentDOM(fileURL);
var domView = dom && dom.getView();
var browser = dom && dom.browser;
var browserWindow = dom.browser.getWindow() || dom.browser.getWindowObj();
var browserDocument = browserWindow.document;
var browserDocumentElm = browserDocument.documentElement;
var browserDocumentBody = browserDocument.body;
var browserScrollTop = browserDocumentElm.scrollTop || browserDocumentBody.scrollTop || 0;
var browserScrollLeft = browserDocumentElm.scrollLeft || browserDocumentBody.scrollLeft || 0;
var isViewUpdated = dom.isDesignViewUpdated();

browser.refreshPageStyles();

browserDocumentBody.scrollTop = browserScrollTop +"px";
browserDocumentBody.scrollLeft = browserScrollLeft + "px";
browserDocumentBody.scrollTop = browserScrollTop +"px";
browserDocumentBody.scrollLeft = browserScrollLeft + "px";
*/
//dw.setActiveRelatedFilePath(fileURL);
//alert(dw.canSaveAllRelatedFiles());

var getFocus = dw.getFocus(true);
//alert(getFocus);

for each(var tab in dw.getDocumentList()){//for1
//alert(tab.getOpenPathName());
if(tab.URL == fileURL){//if1
//UPDATE BROWSER VIEW
// if BROWSER VIEW.
if(getFocus == 'browser' || getFocus == 'html' || getFocus == 'textView'){//if2
var dom = dw.getActiveWindow(fileURL);
var domView = dom && dom.getView();
var browser = dom && dom.browser;
(browser)? dw.refreshRelatedFiles() : null;
(browser)? browser.refreshPageStyles() : null;
}//if2
// if DESIGN VIEW.
else if(getFocus == 'document' && dw.getDocumentDOM().getFocus() == 'body'){//if3
//alert("DESIGN");
dw.getDocumentDOM().refreshView('design');
}//if3 

// If user was using textview, set tab fouus back to TEXT VIEW.
if (getFocus == 'textView'){//if4
dw.setFocus(getFocus);
}//if

return LogFtnReturn(logFtn);
}//if1
}//for1
/*
for each(var tab in dw.getDocumentList()){//for1
if(tab.URL == fileURL){//if1
//UPDATE BROWSER VIEW
// if BROWSER VIEW.
if(getFocus == 'browser' || getFocus == 'html' || getFocus == 'textView'){//if2
var dom = dw.getActiveWindow(fileURL);
var domView = dom && dom.getView();
var browser = dom && dom.browser;
(domView=="split")? dw.refreshRelatedFiles() : null;
(browser)? browser.refreshPageStyles() : null;
}//if2
// if DESIGN VIEW.
else if(getFocus == 'document' && dw.getDocumentDOM().getFocus() == 'body'){//if3
//alert("DESIGN");
dw.getDocumentDOM().refreshView('design');
}//if3 

// If user was using textview, set tab fouus back to TEXT VIEW.
if (getFocus == 'textView'){//if4
dw.setFocus(getFocus);
}//if

dwSaveFileInTab(fileURL);// addded for bug fix

return LogFtnReturn(logFtn);
}//if1
}//for1
*/
return false;
}


function dwRefreshStyleInTabHack3HadNothingThatWorked(fileURL){
// FUNCTION:
//• dwRefreshStyleInTab- Refreshes the file style in a dreamweaver tab.
// DESCRIPTION:
//• Refreshes the page without changing the user's scrollbar positions.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to refresh in a tab.
// RETURNS:
//• boolean- If file opens in a tab it will refresh it and return true. If file is not open in a tab or the page fails to refresh, it will return false.

// browser.refreshPage();
// dw.refreshRelatedFiles();
//var currentDOM = dw.getDocumentDOM(); 
//currentDOM.resetAllElementViews(false); // true make the whole page refresh
// dom.getShowLayoutView() // returns true if in layout mode
// dom.setShowLayoutView() // true will turn it on to layout mode
//  <menuitem mmstring:name="menus/DWContext_DocumentTab_SaveAll_RelatedFiles" command="dw.saveAllRelatedFiles()" enabled="dw.canSaveAllRelatedFiles()" id="DWContext_DocumentTab_SaveAll_RelatedFiles" />
//NOTE:
//• maybe there is a way to use a .reload()

var logFtn=LogFtn(new Error(),1,1,1,-1);

//Make sure file is open
if(!dwOpenFileInTab(fileURL)){return false;}


//(dw.getDocumentDOM())? dreamweaver.releaseDocument(dw.getDocumentDOM()) : null;
//dw.closeDocument(fileURL);
//dw.openDocument(fileURL);
/*
if(domView=="split"){
dwGetFileDomInTab(fileURL).setView("design");
//alert("hello");
//return;
//getPropDump(dw);
//dw.setActiveRelatedFilePath(fileURL);
//dw.setActiveRelatedFile(fileURL);// setActive
//return true;
} 
*/
//var toDoDom = dw.getDocumentDOM(siteRoot+"ThingsToDo.txt");
//var toDoDom = dw.getDocumentDOM(siteRoot+"en.js");
//alert(toDoDom.source.getText());
//alert(wui.configpath+"Floaters");

return;

var fileURLBinar = fileURL.replace(/ /g,"%20");
var activeRelatedFileURL = dreamweaver.getActiveRelatedFilePath();
dreamweaver.openRelatedFile(fileURL);
////var activeRelatedFileURLclean = activeRelatedFileURL.replace(/\%20/g," ");
var relatedFiles = dw.getRelatedFiles(false);
//var RelatedFilesFilterStrings = dw.getQuickRelatedFilesFilterStrings();
//dw.setRelatedFilesFilter("");
//dw.setRelatedFilesFilter(RelatedFilesFilterStrings);
//return;
//REFRESH ALL RELATED FILES NOT SHOWING IN VIEW ****************
//var i =0;
//alert(dw.getQuickRelatedFilesFilterStrings());
//alert(dw.getRelatedFilesFilter());
//dw.setRelatedFilesFilter(dw.getRelatedFilesFilter());
//dw.refreshRelatedFiles();
alert(changedFiles.toSource());
for each(var relatedFileURL in relatedFiles){//for1

//alert(relatedFileURL);
//var relDom = dw.getDocumentDOM(relatedFileURL);
//alert(relDom);
//dreamweaver.closeRelatedFile(relatedFileURL);
//dreamweaver.refreshRelatedFiles(relatedFileURL);
//dreamweaver.openRelatedFile(relatedFileURL);
//dreamweaver.refreshRelatedFiles(relatedFileURL);
//if(i<1){
var relatedDom = dw.getDocumentDOM(relatedFileURL);
dreamweaver.releaseDocument(relatedDom);

//alert(relatedDom.URL);
//var relateCode = DWfile.read(relatedFileURL);
//relatedDom.source.replaceRange(0,relateCode.length,relateCode);
//relatedDom.URL = relatedFileURL;
//alert(relatedDom.getWindowObj());
//relatedDom.openURL(relatedFileURL);
//alert(relatedDom.URL);
//i++;
//}


//break;
//alert("readFile:"+relateCode);
//alert("displayFile:"+relatedDom.source.getText());
//dw.getDocumentDOM().source.refreshVariableCodeHints(false,true);

//if(relatedFileURL!=fileURLBinar){
//}
}

dreamweaver.openRelatedFile(activeRelatedFileURL);
//alert("canSaveAllRelatedFiles:"+dw.canSaveAllRelatedFiles());
dw.saveAllRelatedFiles();
//dreamweaver.openRelatedFile(relatedFileURL);

var dom = dw.getDocumentDOM(fileURL);
var domView = dom && dom.getView();
var browser = dom && dom.browser;
browser.refreshPageStyles();
return;

//dreamweaver.openRelatedFile(activeRelatedFileURL);


//var dom = dw.getActiveWindow(fileURL);
//var isViewUpdated = dom.isDesignViewUpdated();
var browser = dom && dom.browser;
var fileURLBinar = fileURL.replace(/ /g,"%20");
var activeRelatedFileURL = dreamweaver.getActiveRelatedFilePath();
var activeRelatedFileURLclean = activeRelatedFileURL.replace(/\%20/g," ");
var relatedFiles = dw.getRelatedFiles(false);
var getFocusOfUser = dw.getFocus(true);

var browserWindow = dom.browser.getWindow() || dom.browser.getWindowObj();
var browserDocument = browserWindow.document;
var browserDocumentElm = browserDocument.documentElement;
var browserDocumentBody = browserDocument.body;
var browserScrollTop = browserDocumentElm.scrollTop || browserDocumentBody.scrollTop || 0;
var browserScrollLeft = browserDocumentElm.scrollLeft || browserDocumentBody.scrollLeft || 0;

var canSaveAllRelatedFiles = dw.canSaveAllRelatedFiles();
alert(canSaveAllRelatedFiles);

//REFRESH ALL RELATED FILES NOT SHOWING IN VIEW ****************
for each(var relatedFileURL in relatedFiles){//for1
//alert(relatedFileURL);
//var relDom = dw.getDocumentDOM(relatedFileURL);
//alert(relDom);
dreamweaver.refreshRelatedFiles(relatedFileURL);
dreamweaver.openRelatedFile(relatedFileURL);

//if(relatedFileURL!=fileURLBinar){
//}
}
alert(dw.canSaveAllRelatedFiles());
browser.refreshPageStyles();
return;
//dreamweaver.openRelatedFile(activeRelatedFileURL);

// if ((dw.getDocumentDOM()) && (dw.getDocumentDOM().source)){ dw.getDocumentDOM().source.refreshVariableCodeHints(false,true); }"
//dw.getDocumentDOM().refreshView('design');
browserDocumentBody.scrollTop = browserScrollTop +"px";
browserDocumentBody.scrollLeft = browserScrollLeft + "px";
//browser.refreshPage();
//dw.setActiveWindow(fileURL);
//dom = dw.getActiveWindow(fileURL);
domView = dom && dom.getView();
browser = dom && dom.browser;
fileURLBinar = fileURL.replace(/ /g,"%20");
activeRelatedFileURL = dreamweaver.getActiveRelatedFilePath();
activeRelatedFileURLclean = activeRelatedFileURL.replace(/\%20/g," ");
browserWindow = dom.browser.getWindow() || dom.browser.getWindowObj();
browserDocument = browserWindow.document;
browserDocumentElm = browserDocument.documentElement;
browserDocumentBody = browserDocument.body;
dw.getDocumentDOM().source.refreshVariableCodeHints(false,true);
browserWindow.document.body.scrollTop = browserScrollTop;
//dw.getDocumentDOM().refreshView('design');
//dom.synchronizeDocument();
browserDocumentBody.scrollTop = browserScrollTop +"px";
browserDocumentBody.scrollLeft = browserScrollLeft + "px";


//browserScrollTop
//alert(browserScrollTop);
//alert(isNumber(browserScrollTop));
//getPropDump(browserWindow);
//alert(browserWindowObj.window.toSource());
//alert(browserWindowObj.document.documentElement.innerHTML); //scrollLeft
//alert(browserWindow.document.body.scrollLeft); //scrollLeft
//alert(browserWindow.document.body.scrollTop); //scrollLeft
//browserWindow.document.body.scrollTop = 500;
//browserDocumentBody.scrollTop = browserScrollTop;
//browserDocumentBody.scrollLeft = browserScrollLeft;
//• dom.browser.getWindow().eval(jsCode);
//• dom.browser.getWindowObj().dw = dw;


//browser.refreshPageStyles();
//dw.getDocumentDOM().refreshView('code');

return;


//We need to change the activeRelatedFile showing to the source file before
//refreshing. This was needed because DW related files will not update
//any CSS files and some other radom files unless it is showing the
// the Source Code in the textview of a split view.
if(domView=="split"){
dwGetFileDomInTab(fileURL).setView("design");
//alert("hello");
//return;
//getPropDump(dw);
//dw.setActiveRelatedFilePath(fileURL);
//dw.setActiveRelatedFile(fileURL);// setActive
//return true;
}
//return true;
//var textView = (dom.refreshView('design');
//dom.refreshView('design');
//alert(dom.URL);

//alert(activeRelatedFileURL +" ||| "+activeRelatedFileURLclean);
//alert(dw.getRelatedFiles(false).toSource()); // this seems longer
//alert(dw.getRelatedFiles(true).toSource()); // this seems shorter
//alert(dw.getRelatedFiles(false).length); // this seems longer
//alert(dw.getRelatedFiles(true).length); // this seems shorter

//dw.setActiveWindow(activeRelatedFileURLclean);
//for(var i=1;i<relatedFiles.length;i++){
//alert(dw.getRelatedFiles(false)[i]+" ||| "+dw.getRelatedFiles(true)[i]);	
//}
//if(logFtn.ftnName != logFtn.ftnRunName){//if1
//alert(dw.canSaveAllRelatedFiles());
//alert(dw.getRelatedFiles(opnDom).toSource());
//}
/*
*/

//alert(activeRelatedFileURL);
//alert(dw.getRelatedFilesFilter(relatedFiles).toSource());//I 
//alert("fileURLBinar:"+fileURLBinar);
//dw.refreshRelatedFiles();
//alert("fileURL:"+fileURL);
//alert(relatedFiles.length);

// dom.refreshPageStyles(); // NG
//dom.refreshPage();
//dom.refreshView('code');
//dw.refreshRelatedFiles(activeRelatedFileURL);
//alert(dreamweaver.openRelatedFile(activeRelatedFileURLclean));
//dw.getDocumentDOM().refreshView('code');

//REFRESH THE RELATED FILE SHOWING IN VIEW ****************
//var getFocus = dw.getFocus(true);
//alert(getFocus);
//alert(dw.getDocumentDOM().getFocus());
//alert(getFocus);
//100030 for each(var tab in dw.getDocumentList()){//for1
//100030 if(tab.URL == fileURL){//if1

//if(!dwOpenFileInTab(fileURL)){return false;}


var getFocus = dw.getFocus(true);
// if BROWSER VIEW.
if(getFocus == 'browser' || getFocus == 'html' || getFocus == 'textView'){//if2
//var dom = dw.getActiveWindow(fileURL);
//var domView = dom && dom.getView();
//var browser = dom && dom.browser;
//alert(dom.URL);
//alert("browser:"+browser);
//alert("domView:"+domView);
//alert("domView=='split':"+(domView=="split"));
/////////////(domView=="split")? dw.refreshRelatedFiles() : null;
(browser)? browser.refreshPageStyles() : null;
}//if2
// if DESIGN VIEW.
else if(getFocus == 'document' && dw.getDocumentDOM().getFocus() == 'body'){//if3
//alert("DESIGN");
dw.getDocumentDOM().refreshView('design');
}//if3 

// If user was using textview, set tab fouus back to TEXT VIEW.
if (getFocusOfUser == 'textView'){//if4
dw.setFocus(getFocusOfUser);
}//if

if(domView=="split"){
dwGetFileDomInTab(fileURL).setView("split");
dom.setView("split");

}

//100030 return LogFtnReturn(logFtn);
//100030 }//if1
//100030}//for1

//100030return false;
}


function dwRefreshStyleInTabWorksWithSplitAndOtherIfFixedToo(fileURL){
// FUNCTION:
//• dwRefreshStyleInTab- Refreshes the file style in a dreamweaver tab.
// DESCRIPTION:
//• Refreshes the page without changing the user's scrollbar positions.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to open in a new tab.
// RETURNS:
//• boolean- If file opens in a tab it will refresh it and return true. If file is not open in a tab or the page fails to refresh, it will return false.

// browser.refreshPage();
// dw.refreshRelatedFiles();
//var currentDOM = dw.getDocumentDOM(); 
//currentDOM.resetAllElementViews(false); // true make the whole page refresh
// dom.getShowLayoutView() // returns true if in layout mode
// dom.setShowLayoutView() // true will turn it on to layout mode
//  <menuitem mmstring:name="menus/DWContext_DocumentTab_SaveAll_RelatedFiles" command="dw.saveAllRelatedFiles()" enabled="dw.canSaveAllRelatedFiles()" id="DWContext_DocumentTab_SaveAll_RelatedFiles" />
//NOTE:
//• maybe there is a way to use a .reload()

var logFtn=LogFtn(new Error(),1,1,1,-1);

//Make sure file is open
if(!dwOpenFileInTab(fileURL)){return false;}
//(dw.getDocumentDOM())? dreamweaver.releaseDocument(dw.getDocumentDOM()) : null;
//dw.closeDocument(fileURL);
//dw.openDocument(fileURL);
/*
if(domView=="split"){
dwGetFileDomInTab(fileURL).setView("design");
//alert("hello");
//return;
//getPropDump(dw);
//dw.setActiveRelatedFilePath(fileURL);
//dw.setActiveRelatedFile(fileURL);// setActive
//return true;
}
*/
var fileURLBinar = fileURL.replace(/ /g,"%20");
var activeRelatedFileURL = dreamweaver.getActiveRelatedFilePath();
dreamweaver.openRelatedFile(fileURL);
var activeRelatedFileURLclean = activeRelatedFileURL.replace(/\%20/g," ");
var relatedFiles = dw.getRelatedFiles(false);

//REFRESH ALL RELATED FILES NOT SHOWING IN VIEW ****************
//var i =0;

for each(var relatedFileURL in relatedFiles){//for1
//alert(relatedFileURL);
//var relDom = dw.getDocumentDOM(relatedFileURL);
//alert(relDom);
//dreamweaver.closeRelatedFile(relatedFileURL);
dreamweaver.openRelatedFile(relatedFileURL);
dreamweaver.refreshRelatedFiles(relatedFileURL);
//if(i<1){
var relatedDom = dw.getDocumentDOM(relatedFileURL);
//relatedDom.URL = relatedFileURL;
//alert(relatedDom.getWindowObj());
//relatedDom.openURL(relatedFileURL);
//alert(relatedDom.URL);
var relateCode = DWfile.read(relatedFileURL);
relatedDom.source.replaceRange(0,relateCode.length,relateCode);
//i++;
//}


//break;
//alert("readFile:"+relateCode);
//alert("displayFile:"+relatedDom.source.getText());
//dw.getDocumentDOM().source.refreshVariableCodeHints(false,true);

//if(relatedFileURL!=fileURLBinar){
//}
}
dreamweaver.openRelatedFile(activeRelatedFileURL);
//alert("canSaveAllRelatedFiles:"+dw.canSaveAllRelatedFiles());
dw.saveAllRelatedFiles();
//dreamweaver.openRelatedFile(relatedFileURL);

var dom = dw.getDocumentDOM(fileURL);
var domView = dom && dom.getView();
var browser = dom && dom.browser;
browser.refreshPageStyles();
return;

//dreamweaver.openRelatedFile(activeRelatedFileURL);


//var dom = dw.getActiveWindow(fileURL);
//var isViewUpdated = dom.isDesignViewUpdated();
var browser = dom && dom.browser;
var fileURLBinar = fileURL.replace(/ /g,"%20");
var activeRelatedFileURL = dreamweaver.getActiveRelatedFilePath();
var activeRelatedFileURLclean = activeRelatedFileURL.replace(/\%20/g," ");
var relatedFiles = dw.getRelatedFiles(false);
var getFocusOfUser = dw.getFocus(true);

var browserWindow = dom.browser.getWindow() || dom.browser.getWindowObj();
var browserDocument = browserWindow.document;
var browserDocumentElm = browserDocument.documentElement;
var browserDocumentBody = browserDocument.body;
var browserScrollTop = browserDocumentElm.scrollTop || browserDocumentBody.scrollTop || 0;
var browserScrollLeft = browserDocumentElm.scrollLeft || browserDocumentBody.scrollLeft || 0;

var canSaveAllRelatedFiles = dw.canSaveAllRelatedFiles();
alert(canSaveAllRelatedFiles);

//REFRESH ALL RELATED FILES NOT SHOWING IN VIEW ****************
for each(var relatedFileURL in relatedFiles){//for1
//alert(relatedFileURL);
//var relDom = dw.getDocumentDOM(relatedFileURL);
//alert(relDom);
dreamweaver.refreshRelatedFiles(relatedFileURL);
dreamweaver.openRelatedFile(relatedFileURL);

//if(relatedFileURL!=fileURLBinar){
//}
}
alert(dw.canSaveAllRelatedFiles());
browser.refreshPageStyles();
return;
//dreamweaver.openRelatedFile(activeRelatedFileURL);

// if ((dw.getDocumentDOM()) && (dw.getDocumentDOM().source)){ dw.getDocumentDOM().source.refreshVariableCodeHints(false,true); }"
//dw.getDocumentDOM().refreshView('design');
browserDocumentBody.scrollTop = browserScrollTop +"px";
browserDocumentBody.scrollLeft = browserScrollLeft + "px";
//browser.refreshPage();
//dw.setActiveWindow(fileURL);
//dom = dw.getActiveWindow(fileURL);
domView = dom && dom.getView();
browser = dom && dom.browser;
fileURLBinar = fileURL.replace(/ /g,"%20");
activeRelatedFileURL = dreamweaver.getActiveRelatedFilePath();
activeRelatedFileURLclean = activeRelatedFileURL.replace(/\%20/g," ");
browserWindow = dom.browser.getWindow() || dom.browser.getWindowObj();
browserDocument = browserWindow.document;
browserDocumentElm = browserDocument.documentElement;
browserDocumentBody = browserDocument.body;
dw.getDocumentDOM().source.refreshVariableCodeHints(false,true);
browserWindow.document.body.scrollTop = browserScrollTop;
//dw.getDocumentDOM().refreshView('design');
//dom.synchronizeDocument();
browserDocumentBody.scrollTop = browserScrollTop +"px";
browserDocumentBody.scrollLeft = browserScrollLeft + "px";


//browserScrollTop
//alert(browserScrollTop);
//alert(isNumber(browserScrollTop));
//getPropDump(browserWindow);
//alert(browserWindowObj.window.toSource());
//alert(browserWindowObj.document.documentElement.innerHTML); //scrollLeft
//alert(browserWindow.document.body.scrollLeft); //scrollLeft
//alert(browserWindow.document.body.scrollTop); //scrollLeft
//browserWindow.document.body.scrollTop = 500;
//browserDocumentBody.scrollTop = browserScrollTop;
//browserDocumentBody.scrollLeft = browserScrollLeft;
//• dom.browser.getWindow().eval(jsCode);
//• dom.browser.getWindowObj().dw = dw;


//browser.refreshPageStyles();
//dw.getDocumentDOM().refreshView('code');

return;


//We need to change and activeRelatedFile showing to the source file before
//refreshing. This was needed because DW related files will not update
//any CSS files and radomly some other files unless it is showing the
// the Source Code in the textview of a split view.
if(domView=="split"){
dwGetFileDomInTab(fileURL).setView("design");
//alert("hello");
//return;
//getPropDump(dw);
//dw.setActiveRelatedFilePath(fileURL);
//dw.setActiveRelatedFile(fileURL);// setActive
//return true;
}
//return true;
//var textView = (dom.refreshView('design');
//dom.refreshView('design');
//alert(dom.URL);

//alert(activeRelatedFileURL +" ||| "+activeRelatedFileURLclean);
//alert(dw.getRelatedFiles(false).toSource()); // this seems longer
//alert(dw.getRelatedFiles(true).toSource()); // this seems shorter
//alert(dw.getRelatedFiles(false).length); // this seems longer
//alert(dw.getRelatedFiles(true).length); // this seems shorter

//dw.setActiveWindow(activeRelatedFileURLclean);
//for(var i=1;i<relatedFiles.length;i++){
//alert(dw.getRelatedFiles(false)[i]+" ||| "+dw.getRelatedFiles(true)[i]);	
//}
//if(logFtn.ftnName != logFtn.ftnRunName){//if1
//alert(dw.canSaveAllRelatedFiles());
//alert(dw.getRelatedFiles(opnDom).toSource());
//}
/*
*/

//alert(activeRelatedFileURL);
//alert(dw.getRelatedFilesFilter(relatedFiles).toSource());//I 
//alert("fileURLBinar:"+fileURLBinar);
//dw.refreshRelatedFiles();
//alert("fileURL:"+fileURL);
//alert(relatedFiles.length);

// dom.refreshPageStyles(); // NG
//dom.refreshPage();
//dom.refreshView('code');
//dw.refreshRelatedFiles(activeRelatedFileURL);
//alert(dreamweaver.openRelatedFile(activeRelatedFileURLclean));
//dw.getDocumentDOM().refreshView('code');

//REFRESH THE RELATED FILE SHOWING IN VIEW ****************
//var getFocus = dw.getFocus(true);
//alert(getFocus);
//alert(dw.getDocumentDOM().getFocus());
//alert(getFocus);
//100030 for each(var tab in dw.getDocumentList()){//for1
//100030 if(tab.URL == fileURL){//if1

//if(!dwOpenFileInTab(fileURL)){return false;}


var getFocus = dw.getFocus(true);
// if BROWSER VIEW.
if(getFocus == 'browser' || getFocus == 'html' || getFocus == 'textView'){//if2
//var dom = dw.getActiveWindow(fileURL);
//var domView = dom && dom.getView();
//var browser = dom && dom.browser;
//alert(dom.URL);
//alert("browser:"+browser);
//alert("domView:"+domView);
//alert("domView=='split':"+(domView=="split"));
/////////////(domView=="split")? dw.refreshRelatedFiles() : null;
(browser)? browser.refreshPageStyles() : null;
}//if2
// if DESIGN VIEW.
else if(getFocus == 'document' && dw.getDocumentDOM().getFocus() == 'body'){//if3
//alert("DESIGN");
dw.getDocumentDOM().refreshView('design');
}//if3 

// If user was using textview, set tab fouus back to TEXT VIEW.
if (getFocusOfUser == 'textView'){//if4
dw.setFocus(getFocusOfUser);
}//if

if(domView=="split"){
dwGetFileDomInTab(fileURL).setView("split");
dom.setView("split");

}

//100030 return LogFtnReturn(logFtn);
//100030 }//if1
//100030}//for1

//100030return false;
}


function dwRefreshStyleInTabHack2(fileURL){
// FUNCTION:
//• dwRefreshStyleInTab- Refreshes the file style in a dreamweaver tab.
// DESCRIPTION:
//• Refreshes the page without changing the user's scrollbar positions.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to open in a new tab.
// RETURNS:
//• boolean- If file opens in a tab it will refresh it and return true. If file is not open in a tab or the page fails to refresh, it will return false.

// browser.refreshPage();
// dw.refreshRelatedFiles();

//NOTE:
//• maybe there is a way to use a .reload()

var logFtn=LogFtn(new Error(),1,1,1,-1);

//Make sure file is open
if(!dwOpenFileInTab(fileURL)){return false;}


var dom = dw.getActiveWindow(fileURL);
var domView = dom && dom.getView();
var browser = dom && dom.browser;
var fileURLBinar = fileURL.replace(/ /g,"%20");
var activeRelatedFileURL = dw.getActiveRelatedFilePath();
var activeRelatedFileURLclean = activeRelatedFileURL.replace(/\%20/g," ");
var relatedFiles = dw.getRelatedFiles(false);
var getFocusOfUser = dw.getFocus(true);

//browser.refreshPageStyles();
//dw.getDocumentDOM().refreshView('code');

//REFRESH ALL RELATED FILES NOT SHOWING IN VIEW ****************
for each(var relatedFileURL in relatedFiles){//for1
//alert(relatedFileURL);

//if(relatedFileURL!=fileURLBinar){
dw.refreshRelatedFiles(relatedFileURL);
//}
}


//We need to change and activeRelatedFile showing to the source file before
//refreshing. This was needed because DW related files will not update
//any CSS files and radomly some other files unless it is showing the
// the Source Code in the textview of a split view.
if(domView=="split"){
dwGetFileDomInTab(fileURL).setView("design");
//alert("hello");
//return;
//getPropDump(dw);
//dw.setActiveRelatedFilePath(fileURL);
//dw.setActiveRelatedFile(fileURL);// setActive
//return true;
}
//return true;
//var textView = (dom.refreshView('design');
//dom.refreshView('design');
//alert(dom.URL);

//alert(activeRelatedFileURL +" ||| "+activeRelatedFileURLclean);
//alert(dw.getRelatedFiles(false).toSource()); // this seems longer
//alert(dw.getRelatedFiles(true).toSource()); // this seems shorter
//alert(dw.getRelatedFiles(false).length); // this seems longer
//alert(dw.getRelatedFiles(true).length); // this seems shorter

//dw.setActiveWindow(activeRelatedFileURLclean);
//for(var i=1;i<relatedFiles.length;i++){
//alert(dw.getRelatedFiles(false)[i]+" ||| "+dw.getRelatedFiles(true)[i]);	
//}
//if(logFtn.ftnName != logFtn.ftnRunName){//if1
//alert(dw.canSaveAllRelatedFiles());
//alert(dw.getRelatedFiles(opnDom).toSource());
//}
/*
*/

//alert(activeRelatedFileURL);
//alert(dw.getRelatedFilesFilter(relatedFiles).toSource());//I 
//alert("fileURLBinar:"+fileURLBinar);
//dw.refreshRelatedFiles();
//alert("fileURL:"+fileURL);
//alert(relatedFiles.length);

// dom.refreshPageStyles(); // NG
//dom.refreshPage();
//dom.refreshView('code');
//dw.refreshRelatedFiles(activeRelatedFileURL);
//alert(dreamweaver.openRelatedFile(activeRelatedFileURLclean));
//dw.getDocumentDOM().refreshView('code');

//REFRESH THE RELATED FILE SHOWING IN VIEW ****************
//var getFocus = dw.getFocus(true);
//alert(getFocus);
//alert(dw.getDocumentDOM().getFocus());
//alert(getFocus);
//100030 for each(var tab in dw.getDocumentList()){//for1
//100030 if(tab.URL == fileURL){//if1

//if(!dwOpenFileInTab(fileURL)){return false;}


var getFocus = dw.getFocus(true);
// if BROWSER VIEW.
if(getFocus == 'browser' || getFocus == 'html' || getFocus == 'textView'){//if2
//var dom = dw.getActiveWindow(fileURL);
//var domView = dom && dom.getView();
//var browser = dom && dom.browser;
//alert(dom.URL);
//alert("browser:"+browser);
//alert("domView:"+domView);
//alert("domView=='split':"+(domView=="split"));
/////////////(domView=="split")? dw.refreshRelatedFiles() : null;
(browser)? browser.refreshPageStyles() : null;
}//if2
// if DESIGN VIEW.
else if(getFocus == 'document' && dw.getDocumentDOM().getFocus() == 'body'){//if3
//alert("DESIGN");
dw.getDocumentDOM().refreshView('design');
}//if3 

// If user was using textview, set tab fouus back to TEXT VIEW.
if (getFocusOfUser == 'textView'){//if4
dw.setFocus(getFocusOfUser);
}//if

if(domView=="split"){
dwGetFileDomInTab(fileURL).setView("split");
dom.setView("split");

}

//100030 return LogFtnReturn(logFtn);
//100030 }//if1
//100030}//for1

//100030return false;
}


function dwRefreshStyleInTabWorksWithDesignView(fileURL){
// FUNCTION:
//• dwRefreshStyleInTab- Refreshes the file style in a dreamweaver tab.
// DESCRIPTION:
//• Refreshes the page without changing the user's scrollbar positions.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to open in a new tab.
// RETURNS:
//• boolean- If file opens in a tab it will refresh it and return true. If the file is open in a tab, and refreshing fails it will return false.

// browser.refreshPageStyles();
// browser.refreshPage();
// dw.refreshRelatedFiles();

var logFtn=LogFtn(new Error(),1,1,1,-1);

for each(var tab in dw.getDocumentList()){//for1
if(tab.URL == fileURL){//if1

if(!dwOpenFileInTab(fileURL)){return false;}

var getFocus = dw.getFocus(true);
// if BROWSER VIEW.
if(getFocus == 'browser' || getFocus == 'html' || getFocus == 'textView'){//if2
var dom = dw.getActiveWindow(fileURL);
var browser = dom && dom.browser;
(browser)? browser.refreshPageStyles() : null;
}//if2
// if DESIGN VIEW.
else if(getFocus == 'document' && dw.getDocumentDOM().getFocus() == 'body'){//if3
//alert("DESIGN");
dw.getDocumentDOM().refreshView('design');
}//if3

// If user was using textview, set tab fouus back to TEXT VIEW.
if (getFocus == 'textView'){//if4
dw.setFocus(getFocus);
}//if

return LogFtnReturn(logFtn);
}//if1
}//for1

return false;

}


function dwRefreshStyleInTabHackAttemp1(fileURL){
// FUNCTION:
//• dwRefreshStyleInTab- Refreshes the file style in a dreamweaver tab.
// DESCRIPTION:
//• Refreshes the page without changing the user's scrollbar positions.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to open in a new tab.
// RETURNS:
//• boolean- If file opens in a tab it will refresh it and return true. If file is not open in a tab or the page fails to refresh, it will return false.

// browser.refreshPage();
// dw.refreshRelatedFiles();
var logFtn=LogFtn(new Error(),1,1,1,-1);
if(!dwOpenFileInTab(fileURL)){return false;}

var dom = dw.getActiveWindow(fileURL);
var domView = dom && dom.getView();
var browser = dom && dom.browser;
var fileURLBinar = fileURL.replace(/ /g,"%20");
var activeRelatedFileURL = dw.getActiveRelatedFilePath();
var activeRelatedFileURLclean = activeRelatedFileURL.replace(/\%20/g," ");
var relatedFiles = dw.getRelatedFiles(false);
//browser.refreshPageStyles();
//dw.getDocumentDOM().refreshView('code');



//We need to change and activeRelatedFile showing to the source file before
//refreshing. This was needed because DW related files will not update
//any CSS files and radomly some other files unless it is showing the
// the Source Code in the textview of a split view.
if(domView=="split"){
//getPropDump(dw);
//dw.setActiveRelatedFilePath(fileURL);
//dw.setActiveRelatedFile(fileURL);// setActive
//return true;
}
return true;
//var textView = (dom.refreshView('design');
//dom.refreshView('design');
//alert(dom.URL);

//alert(activeRelatedFileURL +" ||| "+activeRelatedFileURLclean);
//alert(dw.getRelatedFiles(false).toSource()); // this seems longer
//alert(dw.getRelatedFiles(true).toSource()); // this seems shorter
//alert(dw.getRelatedFiles(false).length); // this seems longer
//alert(dw.getRelatedFiles(true).length); // this seems shorter

//dw.setActiveWindow(activeRelatedFileURLclean);
//for(var i=1;i<relatedFiles.length;i++){
//alert(dw.getRelatedFiles(false)[i]+" ||| "+dw.getRelatedFiles(true)[i]);	
//}
//REFRESH ALL RELATED FILES NOT SHOWING IN VIEW ****************
//if(logFtn.ftnName != logFtn.ftnRunName){//if1
//alert(dw.canSaveAllRelatedFiles());
//alert(dw.getRelatedFiles(opnDom).toSource());
//}
/*

//alert(activeRelatedFileURL);
//alert(dw.getRelatedFilesFilter(relatedFiles).toSource());//I 
//alert("fileURLBinar:"+fileURLBinar);
//dw.refreshRelatedFiles();
//alert("fileURL:"+fileURL);
//alert(relatedFiles.length);
for each(var relatedFileURL in relatedFiles){//for1
//alert(relatedFileURL);
//dw.refreshRelatedFiles(relatedFileURL.replace(/\%20/g," "));

if(relatedFileURL!=fileURLBinar){
dw.refreshRelatedFiles(relatedFileURL);
}
}
*/

// dom.refreshPageStyles(); // NG
//dom.refreshPage();
//dom.refreshView('code');
//dw.refreshRelatedFiles(activeRelatedFileURL);
//alert(dreamweaver.openRelatedFile(activeRelatedFileURLclean));
//dw.getDocumentDOM().refreshView('code');

//REFRESH THE RELATED FILE SHOWING IN VIEW ****************
var getFocus = dw.getFocus(true);
//alert(getFocus);
//alert(dw.getDocumentDOM().getFocus());
//alert(getFocus);
for each(var tab in dw.getDocumentList()){//for1
if(tab.URL == fileURL){//if1

//if(!dwOpenFileInTab(fileURL)){return false;}


var getFocus = dw.getFocus(true);
// if BROWSER VIEW.
if(getFocus == 'browser' || getFocus == 'html' || getFocus == 'textView'){//if2
var dom = dw.getActiveWindow(fileURL);
var domView = dom && dom.getView();
var browser = dom && dom.browser;
//alert(dom.URL);
//alert("browser:"+browser);
//alert("domView:"+domView);
//alert("domView=='split':"+(domView=="split"));
/////////////(domView=="split")? dw.refreshRelatedFiles() : null;
(browser)? browser.refreshPageStyles() : null;
}//if2
// if DESIGN VIEW.
else if(getFocus == 'document' && dw.getDocumentDOM().getFocus() == 'body'){//if3
//alert("DESIGN");
dw.getDocumentDOM().refreshView('design');
}//if3 

// If user was using textview, set tab fouus back to TEXT VIEW.
if (getFocus == 'textView'){//if4
dw.setFocus(getFocus);
}//if

return LogFtnReturn(logFtn);
}//if1
}//for1

return false;
}


function dwSaveFileInTab(fileURL){
// FUNCTION:
//• dwSaveFileInTab- Saves file in a dreamweaver tab.
// DESCRIPTION:
//• If the fileURL is open in a tab, and needs saving, and it exist in the file system, it will be saved to the file system.
// ARGUMENTS:
//• fileURL- Is the full url of the file U wish to save in an open tab.
// RETURNS:
//• boolean- If fileURL is saved it will return true. If saving fileURL fails, it will return false. Otherwise it will return true.
var logFtn=LogFtn(new Error(),1,1,1,-1);
for each(var tab in dw.getDocumentList()){
if(tab.URL == fileURL && dwCanSaveFileInTab(fileURL)){
return dw.saveDocument(fileURL) && LogFtnReturn(logFtn);
}
}
return LogFtnReturn(logFtn);
}



function openTestFile(){
//NOTE this could be removed from the final build
// But it should stay in the development build all the time

var elm = document.getElementById("openTestFileElm"); 
var sel = elm.options[elm.selectedIndex];
var selnner = sel.innerHTML;
var selVal = sel.value;

//run test1 ftn
if(selVal=="runTestFtn"){
test1();
}
//run saveWuiAsBuild
else if(selVal=="saveWuiAsBuild"){
saveWuiAsBuild();
}
//run saveFileAsBuild
else if(selVal=="saveFileAsBuild"){
saveFileAsBuild();
}
//Open a Log File
else if(selnner.indexOf("Logs")>-1){//if1
var openAllLogFiles = selVal.indexOf("logfileAll")>-1;
var logFolder = wui.logs+"ftn/";
var logFileURLs= dwFileExist(logFolder) && dwFileListFolder(logFolder+"*.html","files");
var i = 1;
for each(var logFileUrl in logFileURLs){//for1
if(!openAllLogFiles&&i<logFileURLs.length){i++;continue;}//if2//if2
if(dwOpenFileInTab(logFolder+logFileUrl)){//if3
var dom = dw.getDocumentDOM();
var view = dom.getView();
var designViewMode = dom.getDesignViewMode();
(view != "design")? dom.setView("design") : null;
(designViewMode != "live")? dom.setDesignViewMode("live") : null;
(dom)? dreamweaver.releaseDocument(dom) : null; // this help release some memory
}//if3
}//for1
}//if1
// Open a file added to select options
else if(selnner.indexOf("wui/")>-1){//if2
var compileFileURL = wui.path+selVal;
if(dwFileExist(compileFileURL) && dwOpenFileInTab(compileFileURL)){
(dw.getFocus(true) == "textView")? null : dw.setFocus(dw.getFocus(true));
}
else{
alert("no dumpCode files exist at:"+compileFileURL);
}
}//if2
// open a code dump file
else if(writeTestingPageIsOn){//elseIf3
var testFileURL = wui.logs+"codedump/"+selVal;
if(dwFileExist(testFileURL)&& dwOpenFileInTab(testFileURL)){
(dw.getFocus(true) == "textView")? null : dw.setFocus(dw.getFocus(true));
}
else{
alert("no dumpCode files exist at:"+testFileURL);
}
}//elseIf3

//reset menu back to first option
elm.selectedIndex = 0;
}


function parseLocalFolderURL(folderUrl){
// folderUrl most be a string of a Local folder in the currently selected site
// returns an array of the follow info about the local folderUrl
var logFtn=LogFtn(new Error(),1,1,1,-1);

var a = {};

//FILE PATH
// filePath is file://xxx/xxx If the folderUrl string has a foward slash "/"  at its end, then it will be removed.
a.filePath = (folderUrl.lastIndexOf("/")==folderUrl.length-1)? notBlank(folderUrl.substring(0,folderUrl.lastIndexOf("/"))) || "" : notBlank(folderUrl) || "";
// hasFilePath will be true If it has a filePath or it will be false
a.hasFilePath = notBlank(a.filePath) && true || false;

//IS INFO
// isSiteRoot will be true If the folderUrl is the current site Root folder, if not it will be false 
a.isSiteRoot = a.hasFilePath && siteRoot && (a.filePath == siteRoot || a.filePath+"/" == siteRoot);
// isSiteLocated will be true if the folderUrl is located in currently selected site
a.isSiteLocated = a.hasFilePath && a.filePath.indexOf(siteRoot)==0;

//SITE PATH
// sitePath is the Url part starting from the siteRoot folder to the folder(ie. news/today ) if it has none, it returns blank
a.sitePath = a.isSiteLocated && a.filePath.substring(siteRoot.length) || "";
// hasSitePath will be true If it has a sitePath or it will be false
a.hasSitePath = notBlank(a.sitePath) && true || false;

//RELATIVE PATH
// relativePath is the relative path with the folder name, if is not a local folder in the site then it will return a blank (ie ../foldername )
a.relativePath = "";
// relativeLinks is the relative path withOut the folder name( i.e. "../" or "../../" ,etc..), if is not a local folder in the site then it will return a blank 
a.relativeLinks = "";
// relativeLinkAll is relative Links which the folder name is also replaced with a relative link(ie this: "../folerName" is now this:  "../../" )
a.relativeLinkAll= "";
// if it has a RelativePath return true, otherwise return false
a.hasRelativePath = a.hasSitePath && !a.isSiteRoot && a.sitePath.indexOf("/")>-1;

//NAME
a.folderName = "";
a.hasFolderName = false;

//SET THE RELATIVE PATH AND RELATIVE LINKS
//else if folderUrl is nested one or more deep in the site folder, then get and set the relativePath, relativeLinks and hasRelativePath
if(a.hasRelativePath){
for(var rel in a.sitePath.match(/\//g)){
a.relativeLinks += "../";
}
}

//SET THE FOLDER NAME
//has relative links
if(a.hasRelativePath && a.hasSitePath){
a.folderName = a.sitePath.substring(a.sitePath.lastIndexOf("/")+1);
a.hasFolderName = notBlank(a.folderName) && true || false;
a.relativePath = a.relativeLinks + a.folderName;
a.relativeLinkAll = a.relativeLinks + (a.hasFolderName && "../" || "");
}
// has just a folderName
else if(a.hasSitePath){
a.folderName = a.sitePath;
a.hasFolderName = notBlank(a.folderName) && true || false;
a.relativeLinkAll = (a.hasFolderName && "../" || "");
}

return LogFtnReturn(logFtn) && a;
}


function removeBlankSpaces(valu){
//removes Blank spaces
var valuX = valu.toString();
if(isBlank(valuX)){return "";}
else{
return valuX.replace(/ /g,"");
}
}

function removeDbBlankSpaces(valu){
//remove all double blank spaces and replaces them with single blank spaces
if(isBlank(valu)){
return "";
}
else{
valu = valu.toString();
while(valu.indexOf("  ")>-1){
valu = valu.replace(/  /g," ");
}
return valu;
}
}

function removeEndBlankSpaces(valu){
// removes and returns val with out end blank spaces
// return this.replace(/^\s+/,'').replace(/\s+$/,'');
// NOTE NEEDED // THE FOLLOWING LINE NEEDS TESTING
// this could replace using the while loops // the while loops may be faster
// valu.replace(/(^\s+|\s+$)/g, ""); // removes end blank spaces

//if blank then return a blank value
if(isBlank(valu)){
return "";
}
// or remove any blank ends
else{
valu = valu.toString();
// this removes any blank spaces at the begining
while (valu.indexOf(" ",0)==0){ valu =valu.slice(1);}
// this remove any blank spaces at the end
var  valuLength = valu.length;
while (valuLength > 0 && valu.lastIndexOf(" ",valuLength) == valuLength-1){
valu =valu.slice(0,-1);
valuLength = valu.length;
} 
return valu;
}
}

function removeEndQuoteMarks(valu){
// removes and returns a string with out QuoteMark Ends
valu = notBlank(valu) && valu.toString();
if(valu){
//remove the double or single quote mark at the end of the valu string
if(valu.charAt(valu.length-1)=="\"" || valu.charAt(valu.length-1)=="'"){
valu = valu.substring(0,valu.length-1);
}
//remove the double or single quote mark at the beginning of the valu string
if(valu.indexOf("\"") == 0 ||valu.indexOf("'") == 0){
valu = valu.substring(1);
}
}
return valu || "";
}

function runFnctn(ths,ctg,ftnToRunName,ftnToRunAttrib,itemId){
// DW10 does not seem to need a timeout for most things on the mac. Only for treecontrols when they R first selected. which needs alot of time. After one is selected it needs much less time. But keeping a timeout just seem smart, for now. Maybe sniffing out some functions to speed things up is a options i.e. (functionName == "Props")? timeOutFtn2 = 0 : and etc...

// functionIsRunning
// When functionIsRunning it's true.  When a function is not running, it's false.
// If a function is fired during one running, this will cancel that action or wait until it's finished.
// This is needed to prevent user from double clicking the same action twice, while a timeout is running.
if(functionIsRunning && !itemId){//if1
var logFtn=LogFtn(new Error(),1,1,1,-1);
LogFtnReturn(logFtn);
return;
}//if1


// No functionIsRunning
// function is running for the first time
if(!functionIsRunning && !itemId ){//if1
// check and set if the user's logging is on or off 
logErrOn = getVformElmById("LogErrOverRideBtn").checked;
logFtnOn = getVformElmById("LogFtnOverRideBtn").checked;


// remove all log files before starting the action
if(logErrOn||logFtnOn){//if2
var hasLogFolder = dwFileExist(wui.logs+"ftn/");
var deleteLogs =  hasLogFolder && DWfile.remove(wui.logs+"ftn/");
(hasLogFolder && !deleteLogs)? logError(new Error("pemission to set log files failed")) : null;
}//if2

// logFtn needs to be below the logErrOn || logFtnOn remove all log files above.
var logFtn=LogFtn(new Error(),1,1,1,-1);


// Since we need to use a timeout below we need to save the fired element info to a global var so other ftns can use it later
// NOTE this could go into a private ftn
firedElm.id =  ths.getAttribute("id") || false;
firedElm.hashVal = ths.getAttribute("hash_val") || false;
firedElm.tagName = ths.tagName.toLowerCase() || false;
functionIsRunning = true;
changedFiles = [];

// if no site is picked or it has changed or the stacksite folder does not exist, then run setProgram
// while alerting user of the problem and opening the stacksite's floater window, with message in browser
// NOTE: I believe the dwFileExist(siteRoot+"stacksite") will need to be removed below. I
// think it really should only test if the siteRoot folder exist. If the user moves the stacksite folder
// I really have no good way to know if they removed it or deleted it, or if they r creating a new site
// for now I'm testing for both siteroot and stackroot
// if it has a siteRoot and stacksite folder
// NOTE code test for site.getSiteForURL(aDocURI)
if(dwFileExist(siteRoot) && dwFileExist(siteRoot+"stacksite") || firedElm.id.indexOf("mbOptMnuElm")>-1 || firedElm.id =="smbSiteRefreshElm" || firedElm.id=="sdnTreeElm"){//if3
null;
}//if3
// if it has No siteRoot and/or stacksite folder
else{//else3
var sdn = getTree(catg.sdn);
var msg = sdn.selNode.@n_name + " site folder could not be found at: " + siteRoot;
//alert(msg);
var runFns= setProgram() && dwChangeFileInTab("sdn",false,msg,false,true) && setVForm("sdn",1);
return runFns && LogFtnReturn(logFtn);
}//else3

// set a time needed for the timeout
var timeOutFtn2 = (dwApp.isMac)? 100 :100;
if(firedElm.tagName == "mm:treecontrol"){//if4
timeOutFtn2 = (parseInt(ths.getAttribute("unclicked"))== 0)? 2000 : 2000;
}//if4
ftnToRunAttrib = ftnToRunAttrib && ftnToRunAttrib.toSource() || "";
setTimeout("runFnctn('','"+ctg+"','"+ftnToRunName+"','"+ftnToRunAttrib+"','"+firedElm.id+"')",timeOutFtn2);
return LogFtnReturn(logFtn);
}//if1

// Run the Function
else{//else7
var logFtn=LogFtn(new Error(),1,1,1,-1);
ctg = catg[ctg] || logError(new Error());
if(!ctg){return logError(new Error());};
var vForm = document.getElementById("vForm");
var vFormCat1 = vForm.childNodes[0].getAttribute("cat1");
var inputElms = vForm.getElementsByTagName("input");
//Set the input text element values so innerHTML can see them in the Value attributes
for(var i = 0; i<inputElms.length; i++){
var inputElm = inputElms[i];
if(inputElm && inputElm.type && inputElm.getAttribute("type").toLowerCase() == "text"){
inputElm.value = inputElm.value || "";
}
}
//if it's a treecontrol, find the selected node and put it's id in a attrib on the tree control, or set it to tree 00.
if(firedElm.tagName == "mm:treecontrol"){
var vTree = getVformTree(ctg.pF);
vTree.unclicked = 1;
}

// put a copy of the current visual floater window of HTML into the var of XML.
// It would be great to find away to get it to accept the mm: namespace.
// So far, Everything I tried to accept the mm: namespace has failed.  Need to ask DW if it's possible.
var htmlCode = (vForm.innerHTML).replace(/mm:tree/g,"zztree");
htmlCode = htmlCode.replace(/selected>/g,'selected="true">');
if(ctg.a == "b"&&controlBrowserOn){// for borders bc they have a browsercontrol in it
htmlCode = htmlCode.replace(/mm:browser/g,"zzbrowser");
}

zForm[vFormCat1] = new XML(htmlCode);
//writeTestingPage(true,"runFnctnPart2zForm.js","var x ="+htmlCode);

//I try to do this in one, but it does not like doing conditions on ftnToRunAttrib. I'll try later to get it to one. 
if(!ftnToRunAttrib){
//alert("1. ftnToRunAttrib: "+ftnToRunAttrib);
setTimeout(ftnToRunName+"('"+ctg.pF+"')",0);
}
else{
//alert("2. ftnToRunAttrib: "+ftnToRunAttrib);
setTimeout(ftnToRunName+"('"+ctg.pF+"',"+ftnToRunAttrib.toSource()+")",0);
}

return LogFtnReturn(logFtn);
}//else7

//NOTE: the stuff below is for testing while developing, can be removed on beta releases
//if(ctg.pF=="wdn"){
//alert(document.getElementById("vForm").innerHTML);
//writeTestingPage(true,"runFnctnPart2zForm.js","var x ="+document.getElementById("vForm").innerHTML);
//}

}

function saveFileInfo(ctg,typeNum){//not used
// dnName in many files it's using the var dnName for name 
var logFtn=LogFtn(new Error(),1,1,1,-1);
var code = <x><version>{dn.selNode.@n_version + "StackSite"}</version>
<name>{dn.selNode.@n_name || "undefined"}</name> 
</x>;
}

function setInnerHTML(elm,html){
//NOTE THIS NEEDS TO GO IN A FRAMEWORK for sites or be used for the browser control
var logFtn=LogFtn(new Error(),1,1,1,-1);

// find out if this ftn is being called by itself
var isFtnCalledByItSelf = logFtn.ftnName == logFtn.ftnRunName;

if(!isFtnCalledByItSelf && (!elm || typeof html !== 'string')){return null;}

// if the element has any desendant elements, than set them
for each(var elm in elm.children){
setInnerHTML(elm);
} 

// Break circular references.
var a = elm.attributes, i, l, n, c;
if (a) {
l = a.length;
for (i = 0; i <l; i += 1) {
n = a[i].name;
if (typeof elm[n] === 'function'){elm[n] = null;}
}
}




}

/*
var elmChildren = 
       
// Break circular references.
   9.
          (function (o) {
  10.
       
  11.
              var a = o.attributes, i, l, n, c;
  12.
              if (a) {
  13.
                  l = a.length;
  14.
                  for (i = 0; i <l; i += 1) {
  15.
                      n = a[i].name;
  16.
                      if (typeof o[n] === 'function') {
  17.
                          o[n] = null;
  18.
                      }
  19.
                  }
  20.
              }
  21.
       
  22.
              a = o.childNodes;
  23.
       
  24.
              if (a) {
  25.
                  l = a.length;
  26.
                  for (i = 0; i <l; i += 1) {
  27.
                      c = o.childNodes[i];
  28.
       
  29.
                      // Purge child nodes.
  30.
                      arguments.callee(c);
  31.
       
  32.
                      // Removes all listeners attached to the element via YUI's addListener.
  33.
                      YAHOO.util.Event.purgeElement(c);
  34.
                  }
  35.
              }
  36.
       
  37.
          })(el);
  38.
       
  39.
          // Remove scripts from HTML string, and set innerHTML property
  40.
          el.innerHTML = html.replace(/<script[^>]*>((.|[\r\n])*?)<\\?\/script>/ig, "");
  41.
       
  42.
          // Return a reference to the first child
  43.
          return el.firstChild;
  44.
      };
	  
	  */
	  
function treeColNeedsUpdate(ctg){
// this sets a gobal var to true to let the updating col function know to update the cols
// it's needed this way because some code has it in strings with conditions 
var logFtn=LogFtn(new Error(),1,1,1,-1);
return (colsNeedUpdating = true) && LogFtnReturn(logFtn);
//0278 return true;
}

function writeCompilePage(isOn,fileName,theContent){
if(isOn && writeCompilePageIsOn){
alert("Compile Wui will finish now.");
DWfile.write(wui.path+fileName,theContent);

//Remove the option if that page exist already and add it to the end
var elm = document.getElementById("openTestFileElm");
var elmOptions = elm.options;
var elmOptionsLength = elmOptions.length;
for(var i=0;i<elmOptionsLength;i++){//for1
if(elmOptions[i].value == fileName){
(elmOptions[i].value == fileName)? elmOptions[i].outerHTML = "" : null;
i = elmOptionsLength;
}
}//for1

var newOption = "<option value='"+fileName+"'>"+"wui/"+fileName+"</option>";
elm.innerHTML = elm.innerHTML + newOption;
}
}

function writeFileToStackSite(X,theContent){
// this return true if file is written, false if not. 
// X most have a foward slash in front of it.
// Note maybe it's better to move this code back into the callee ftns
var logFtn=LogFtn(new Error(),1,1,1,-1);
var isWritten = DWfile.write(stackRoot+X,theContent);
(isWritten)? changedFiles.push(stackRoot+X) : null;
return LogFtnReturn(logFtn) && isWritten || logFtnError(new Error("failed writeFileToStackSite"));
}

function writeTestingPage(isOn,fileName,theContent){
if(isOn && writeTestingPageIsOn){
DWfile.write(wui.logs+"codedump/"+fileName,theContent);
//Remove the option if that page exist already and add it to the end
var elm = document.getElementById("openTestFileElm");
var elmOptions = elm.options;
var elmOptionsLength = elmOptions.length;
for(var i=0;i<elmOptionsLength;i++){//for1
if(elmOptions[i].value == fileName){
(elmOptions[i].value == fileName)? elmOptions[i].outerHTML = "" : null;
i = elmOptionsLength;
}
}//for1

var newOption = "<option value='"+fileName+"'>"+fileName+"</option>";
elm.innerHTML = elm.innerHTML + newOption;
}
}


</script>
<script language="JavaScript">
//alert(document.max_script_run_time);
function test1(){
//alert(getTreeNodeFileList(siteRoot,"",'Site'));
//var script = "dw.printDocument(dw.convertURIToFilePath('" + files.fsName + "'));"
//		dw.executeScript(script);
//alert(window.container);
//alert(Components);
//document.Security.PrivilegeManager.EnablePrivilege('UniversalXPConnect');
//var getDom = dw.getDocumentDOM();
//var getView = getDom.getView();
//var designViewMode = getDom.getDesignViewMode();
//(getView != "design")? getDom.setView("design") : null;
//(designViewMode != "live")? getDom.setDesignViewMode("live") : null;
//var tdn =  getTree(catg.tdn);
//writeTestingPage(true,"tdnTree.txt",tdn.control.toXMLString());
}

function setLangOnArray(arry,lang){
// currently used for the compiler only
// Looks through an array and changes any langs it finds
// arry: value can be any type of single or multi-nested array (ie: this is ok: ['a','b',7] or [['_a','b'],[7,9.0]] this is not: {hi:'_Hi'} )
// lang: must be a two letter value of a language (ie: en(english) or fr(french))
// returns: a lang version of the array, or false if an error occured 
try{//try1
var noError = true;
//loop the array
for(var arryHash in arry){//for1
var arryItem = arry[arryHash];
//if arryItem in the array is ann array then recuse it
if(isArray(arryItem)){//if1
noError = setLangOnArray(arryItem,lang) && true;
}//if1
//if arryItem is labeled to use a different language then
else if(arryItem.toString().indexOf("_")== 0){//else1
// change it if it exist in the lang lib
if(arryItem in bLang[lang]){//if2
arry[arryHash] = bLang[lang][arryItem];
}//if2
// or if its unable too because its missing in the lang lib
else{//else3
//create an error
noError = logError(new Error(arryItem + "in arry:"+ arry.toSource() +" is missing in bLang." +lang ));
}//else3
}//else1
}//for1
return noError && arry;
}//try1
catch(err){//catch1
return logError(err,true);
}//catch1
}

function compileWui(lang){
// I tried to use: dw.runCommand("stop_js_run_alert.htm");
// to stop the script has been running for awhile alert from happening during the
// running of this ftn, which does not seem to reset the JS branch count back to zero,
// which I was told it would in cs4 Anyway, it's not really needed, but maybe it can be used in cs5
// if they don't have something else to solve this
//dw.runCommand("stop_js_run_alert.htm");

logErrOn = getVformElmById("LogErrOverRideBtn").checked;
logFtnOn = getVformElmById("LogFtnOverRideBtn").checked;

// check if this lang exist for this compile
if(lang in bLang){
compileWui.lang = lang;
}
// Needs Work to be able to change the lang here and to through an error if the lang can not be loaded or found
else{
return logError(new Error("The compile lang:+"+lang +" is missing in bLang"));
}

// remove all log files before starting
if(logErrOn||logFtnOn){
var hasLogFolder = dwFileExist(wui.logs+"ftn/");
var deleteLogs =  hasLogFolder && DWfile.remove(wui.logs+"ftn/");
if(hasLogFolder && !deleteLogs){ return logError(new Error("pemission to set log files failed"))};
}

//create the first logFtn
var logFtn=LogFtn(new Error(),1,1,1,-1,"compileWui:"+lang);


// Set the Nav arrays and put them in the hashArray
// if I include other libs I'll need to call and set this from a file
var bHash = {val:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,false,[[false,0,0]]," "],
// nav: [MenuName,formChar,MenuSortOrder]
nav: [
["_About","z",3],
["_Photos","b",1],
["_BtnIcons","i",1],
["_Pref","p",2],
["_MenuArrays","m",1],
["_Pages","w",1],
["_Scripts","j",1],
["_Sites","s",1],
["_Snipits","n",1],
["_Templetes","t",1],
],

};// bHash

// Set the hash array and each element in the XML library 
var requiredAttribs= null;
var requiredParent = null;

//set each element in the XML library
var compileThisLib = new XML(unCopliledLib.toXMLString());

// Step-1 First it needs to remove anything that is not a element in the compileThisLib library
// delete needs to be done the following way to work
for each(var elm in compileThisLib..*){//for1
if(elm.nodeKind()!="element"){//if1
delete elm.parent().*[elm.childIndex( )];
}//if1
}//for1


// Step-2  Set the lang on attributes with strings
for each(var elm in compileThisLib..*){//for1
if(elm.hasOwnProperty("@hashVal")){continue;}//if1
for each(var xAttrib in elm.attributes()){//forAX
if(xAttrib.indexOf("_")== 0 && xAttrib.name() in attribLibSettings && attribLibSettings[xAttrib.name()][0]=="string"){//if2
if(xAttrib in bLang[lang]){//if3
elm.@[xAttrib.name()] = bLang[lang][xAttrib];
}//if3
else{//else3
return logError(new Error(xAttrib+" in bLang." +lang+" is missing for attribute:"+ xAttrib.name()+" on xml node:"+elm.toXMLString()));
}//else3
}//if2
}//forAX
}//for1


// Step-3  Set the lang on attributes with arrays
for each(var elm in compileThisLib..*){//for1
if(elm.hasOwnProperty("@hashVal")){continue;}//if1
for each(var xAttrib in elm.attributes()){//forAX
if(xAttrib.name() in attribLibSettings && attribLibSettings[xAttrib.name()][0]=="array"){//if2
if(isBlank(xAttrib)){continue;}
var newArray = (xAttrib.indexOf(attribLibSettings[xAttrib.name()][3])>-1)? setLangOnArray(xAttrib.split(attribLibSettings[xAttrib.name()][3]),lang) : setLangOnArray([xAttrib],lang);
if(newArray!==false){
//alert(newArray.toSource());
elm.@[xAttrib.name()] = newArray.join(attribLibSettings[xAttrib.name()][3]);
}
//stop compiler and log an error if the newArray value is a bolean false, which means newArray had a problem setting lang in it.
else{
return logError(new Error("newArray:" +lang+" is missing for attribute:"+ xAttrib.name()+" on xml node:"+elm.toXMLString()));
}
}//forAX
}//if1
}//for1

// Step-3-a  Set the lang on attributes with arrayEval and sort
for each(var elm in compileThisLib..*){//for1
if(elm.hasOwnProperty("@hashVal")){continue;}//if1
for each(var xAttrib in elm.attributes()){//forAX
if(xAttrib.name() in attribLibSettings && attribLibSettings[xAttrib.name()][0]=="arrayEval"){//if2
if(isBlank(xAttrib)){continue;}
var newArray = setLangOnArray(eval("["+xAttrib+"]"),lang);
//100021 var newArray = (xAttrib.indexOf("[")>-1)? setLangOnArray(eval("["+xAttrib+"]"),lang) : setLangOnArray([[false,0,0]],lang);
if(newArray){
//sort
newArray.sort(sortArray([2,0,2]));
elm.@[xAttrib.name()] = newArray.toSource();
}
//stop compiler and log an error if the newArray value is a bolean false, which means newArray had a problem setting lang in it.
else{
return logError(new Error("newArray:" +lang+" is missing for attribute:"+ xAttrib.name()+" on xml node:"+elm.toXMLString()));
}
}//forAX
}//if1
}//for1


// Step-4 Set the lang on the nav array and sort it
for each(var a in bHash.nav){//for1
if(a[0].indexOf("_")== 0){//if2
if(a[0] in bLang[lang]){//if3
a[0] = bLang[lang][a[0]];
}//if3
else{//else3
return logError(new Error(a[0]+" in bLang." +lang+" is missing for bHash.nav item:"+ a.toSource()));
}//else3
}//if2
}//for1
bHash.nav.sort(sortArray([2,0,2]));


//test writeTestingPage(true,"langTest.text",compileThisLib.toXMLString());
//test alert(compileThisLib.toXMLString());
//test return;






for each(var elm in compileThisLib..*){//for1
var elmNam = elm.name();
var newHash = [];
if(elmNam=="div"||elmNam=="lib"||elmNam=="tree"||elmNam=="set"||elmNam=="visual"||elmNam=="hidden"){continue;}//if1//if1

// if it does have a hash attribute, then skip and continue to process the next element.
// otherwise create a array of required attrib names for element and if needed, add it to the hash array.
// On the finally build hashes will be done, so this is really only for my development, and maybe to merge others lib into stacksite from other developers interested in building it into stacksite. This would require namesspace XML using there web address. Basically a library addon system for them. Version 2 should have this not version one.
if(elm.hasOwnProperty("@hashVal")){continue;}//if1//if1

else if((elmNam=="elements"||elmNam=="nodes"||elmNam=="optcol") && elm.hasOwnProperty("@id")){//if2
//0303 else if(elm.hasOwnProperty("@requiredAttribs") && elm.hasOwnProperty("@id")){//if2
requiredAttribs = [];
requiredParent = elm;
for each(var xAttrib in elm.attributes()){//forAX set each attribute on the element
var xAttribNam = xAttrib.name()+"";
// adding them will allow them to be removed later, and not added to the hash array
if(xAttribNam!="id"&&xAttribNam!="sortChildren"&&xAttribNam!="sortChildrenBy"&&xAttribNam!="sortOrder"){//ifAN 
requiredAttribs.push(xAttribNam);
}//ifAN
}//forAX
requiredAttribs = requiredAttribs.sort();
//Note this could be hashed too, if some of the elms turn out to have the attrib group of names
bHash[elm.@id] = requiredAttribs;
}//if2
else{//if3 Throw an error if it's missing it's id attribute
if(!elm.hasOwnProperty("@id")&&!notBlank(elm.@id)){return logError(new Error("Missing the id attribute on:"+elm.toXMLString()))}//ifEr
}//if3


//find and set any refTags that may be used to find a attrib multiple times.
var requiredParentRefTag = false;
if(elm.hasOwnProperty("@refTag")){//ifZ
if(elm.@refTag=="~parent"){//ifC
requiredParentRefTag = elm.parent().copy( );
}//ifC
else{//else3
for each(var getElm in requiredParent..*){//for77
if(getElm.@id==elm.@refTag){requiredParentRefTag = getElm.copy( );break}
}//for77
}//else3
if(!requiredParentRefTag){return logError(new Error("requiredParentRefTag Missing for Attrib: refTag on elm:" +elm.toXMLString()));}//ifEr
}//ifZ
// create a array of numbers which each number points, or points and creates a needed value in the hash array.
for each(var attribName in requiredAttribs){//for2
// then check for error, and stop the program load if it can't find the setting info for this attribName.
var attrib = attribLibSettings[attribName] || logError(new Error("missing attrib:a["+attribName+"]"));
var attribType = attrib[0] || logError(new Error("missing attribType: "+attribName));
var attribRtnAction = attrib[1] || logError(new Error("missing attribRtnAction: "+attribName)); //return action
var attribMissingAction = attrib[2] || logError(new Error("missing attribMissingAction: "+attribName));
if(!attribType||!attribRtnAction||!attribMissingAction){return false;}//ifEr

// If it has a ref to another element's attribute value then use that, otherwise use elm's attrib value:
var hasAttrib = elm.hasOwnProperty("@"+attribName);
var attribVal = (hasAttrib && elm.@[attribName]).toString();
var refElm = false;
if(hasAttrib && attribVal[0] != "~"){//if1
refElm = elm;
}//if1
else if(hasAttrib && attribVal[0] == "~"){//if2
refElm=(attribVal =="~parent")? elm.parent().copy( ) : elm.parent().copy( ).elements( ).(@id==attribVal.substring(1));
//if(refElm.length()>1){refElm=refElm[0];}// if it finds more than one elm with this id then use the first one it finds
if(refElm.length()!=1){return logError(new Error("refElm Missing for Attrib:"+attribName+" on elm:" +elm.toXMLString()));}//ifEr
}//if2

// If attribute exist use it's value, else check if it does require one, or throw an error for being missing..
if((refElm||requiredParentRefTag)&& (refElm||requiredParentRefTag).hasOwnProperty("@"+attribName)){//if1
attribVal = (refElm||requiredParentRefTag).@[attribName].toString();
}//if1
else{//else2
attribRtnAction = (attribMissingAction=="boolean")?"boolean": (attribMissingAction=="blank")?"blank": false;
if(!attribRtnAction){//ifEr
return logError(new Error("Value is Missing for Attrib:"+attribName+" on elm='"+(refElm||elm).toXMLString()+"'"));
}//ifEr
attribVal = " ";
}//else2

//Check if the attribute value requires a value. If it does and it's blank, then throw an error.
attribVal = notBlank(attribVal);
if(!attribVal&&attribRtnAction=="error"){return logError(new Error(" Missing attribute:"+attribName+" Value with elm id:"+elm.@id));}//ifEr


//set the Attrib Return Action
if(attribType=="string"){//ifs1
//(preFix=="wde"&&attribName=="eSZ")?alert("0. attribVal:"+attribVal): null;
if(attribVal){//ifs2
//(preFix=="wde"&&attribName=="eSZ")?alert("1. attribVal:"+attribVal): null;
}//ifs2
else if(attribRtnAction=="blank"){//else3
//(preFix=="wde"&&attribName=="eSZ")?alert("2. attribVal:"+attribVal): null;
attribVal = " ";
}//else3
else{//else4 // boolean
//(preFix=="wde"&&attribName=="eSZ")?alert("3. attribVal:"+attribVal): null;
attribVal = false;
}//else4
}//ifs1
else if(attribType=="arrayEval"){//elseifs0
//(preFix=="wde"&&attribName=="eSZ")?alert("0. attribVal:"+attribVal): null;
if(attribVal){//ifs2
attribVal = eval(attribVal);
//(preFix=="wde"&&attribName=="eSZ")?alert("1. attribVal:"+attribVal): null;
}//ifs2
else if(attribRtnAction=="blank"){//else3
//(preFix=="wde"&&attribName=="eSZ")?alert("2. attribVal:"+attribVal): null;
attribVal = " ";
//lib[attribName+"_Lgth"] = 0; 
}//else3
else{//else4 // boolean
//(preFix=="wde"&&attribName=="eSZ")?alert("3. attribVal:"+attribVal): null;
attribVal = false;
//lib[attribName+"_Lgth"] = 0; 
}//else4
}//elseifs0
else if(attribType=="array"){//elseifs1
//(preFix=="wde"&&attribName=="eSZ")?alert("0. attribVal:"+attribVal): null;
if(attribVal){//ifs2
//(preFix=="wde"&&attribName=="eSZ")?alert("1. attribVal:"+attribVal): null;
var splitWith = attrib[3] || logError(new Error("missing attribArraySplitChar: "+attribName));
if(!splitWith){return false;}
attribVal = (attribVal.indexOf(splitWith)>-1)? attribVal.split(splitWith) : [attribVal];
//lib[attribName+"_Lgth"] = lib[attribName].length; 
//(attribName=="cssSelectorNames")?alert(lib[attribName]): null;
//(attribName=="cssSelectorNames")?alert(lib[attribName]["lngth"]): null;
}//ifs2
else if(attribRtnAction=="blank"){//else3
//(preFix=="wde"&&attribName=="eSZ")?alert("2. attribVal:"+attribVal): null;
attribVal = " ";
//lib[attribName+"_Lgth"] = 0; 
}//else3
else{//else4 // boolean
//(preFix=="wde"&&attribName=="eSZ")?alert("3. attribVal:"+attribVal): null;
attribVal = false;
//lib[attribName+"_Lgth"] = 0; 
}//else4
}//elseifs1
else if(attribType=="number"){//elseifs2
if(parseInt(attribVal).toString() == attribVal){//if1
attribVal = parseInt(attribVal);
}//if1
else if(parseFloat(attribVal).toString() == attribVal){//else2
attribVal = parseFloat(attribVal);
}//else2
else if(attribRtnAction=="blank"){//else3
attribVal = " ";
}//else3
else if(attribRtnAction=="boolean"){//else4
attribVal = false;
}//else4
else{//else5
attribVal = null;
return logError(new Error(" Missing attribute:"+attribName+" Number with elm id:"+elm.@id));
}//else5
}//elseifs2


//add attrib hash number to the newHash array and attrib value to gobal zHash array if it does not exist
// note  bHV instanceof Array works too, but constructor seems faster
var i = 0; //count i
var attribValConstructor = attribVal.constructor;
var attribValSource = attribVal.toSource();
for each(var bHV in bHash.val){//ForHash
if(attribValConstructor===bHV.constructor&&attribValSource===bHV.toSource()){break;}
i++;
}//ForHash
// if a hash value does not exist create a new one
if(i==bHash.val.length){
bHash.val.push(attribVal);
newHash.push(i);
}
// else give it the hash number of the same one it found to match
else{
newHash.push(i);
}
}//for2


//add hashVal attrib to elm and newHash array to bHash.val if it does not exist.
var newHashConstructor = newHash.constructor;
var newHashSource = newHash.toSource();
var i = 0;
for each(var bHV in bHash.val){//ForHash
if(newHashConstructor===bHV.constructor&&newHashSource===bHV.toSource()){break;}
i++;
}//ForHash
// if a hash value does not exist create a new one
if(i==bHash.val.length){
bHash.val[i] = newHash; 
elm.@hashVal = i;
}
// else give it the hash number of the same one it found to match
else{
elm.@hashVal = i;
}

//dw.runCommand("stop_js_run_alert.htm");

}//for1


//sort any required XML node. The code below sorts e4x XML nodes
//  and it was tricky to get to work. Any changes to the code below will need 
// carefull consideration and testing.  So far it works as is, but if it ever
// breaks, and it can't be fixed using this code, it will need to be rewritten
//var currentCatg = "";
//var newCompileThisLib = "";
var attribNames = "";
//loop each element
for each(var elm in compileThisLib..*){//for1
var elmNam = elm.name();

// if element has a attribute named requiredAttribs, set the currentCatg to it's attribute id
if((elmNam=="elements"||elmNam=="nodes"||elmNam=="optcol") && elm.hasOwnProperty("@id")){//if1
//0303 if(elm.hasOwnProperty("@requiredAttribs") && elm.hasOwnProperty("@id")){//if1
//currentCatg = elm.@id;
attribNames = bHash[elm.@id];
}//if1

// if the element's child nodes need sorting, starts here
// if the element's sortChildrenBy attrib exist, then:
var sortElm = elmNam=="cat"||elmNam=="float"||elmNam=="gp"||elmNam=="nodes"||elmNam=="optcol"||elmNam=="visual";
if((sortElm||elm.hasOwnProperty("@sortChildrenBy"))&&!elm.hasOwnProperty("@sortChildren")&&elm.@sortChildren=="true"){//if1

//sortElmByAttrib r the xml tagName:[attributeNames] to be sorted
var sortElmByAttrib = {cat:["vV"],float:["vV","sortOrder"],gp:["vV"],nodes:["vV"],optcol:["vV"],visual:["vV"],};

// extract it's value and put it into a array 
if(elm.hasOwnProperty("@sortChildrenBy")){
var sortAttribs = (elm.@sortChildrenBy.indexOf("|")>-1)? elm.@sortChildrenBy.split("|") : [elm.@sortChildrenBy];
}
else{
var sortAttribs = sortElmByAttrib[elmNam];
}
// build the sort sequence from the sortAttribs.
var sortSequence = [];
for (var i in sortAttribs){sortSequence.push(i);}//for2////for2

// create a array to hold each child node's attribute values to sort with, and a copy of the child node
var childrenArr = [];
var hash = {};
// loop each element's child node
for each(var childElm in elm.children()){//for3
// create a array which holds the child node's
var newAttribArr = [];
// if the child node has a hashVal then:
if(childElm.hasOwnProperty("@hashVal")){//if2
// get and set the attribute hashVal for the child node
var attribHashes = bHash.val[parseInt(childElm.@hashVal)];
// alert("attribHashes:"+attribHashes.toSource());
for(var i in attribNames){//for4
hash[attribNames[i]] = bHash.val[attribHashes[i]];
}////for4
}//if2
//alert("hash:"+hash.toSource());

// get and set the childrenArr
for (var i in sortAttribs){//for6
// get value from hash if it exist
var attrib = hash[sortAttribs[i]] || false;
//alert("attrib:"+attrib);
// if hash does not exist, try getting the value from the child node
if(!attrib && childElm.hasOwnProperty("@"+sortAttribs[i])){
attrib = childElm.@[sortAttribs[i]];
//alert("1.attrib:"+attrib);
//alert("typeof attrib == 'string':"+(typeof attrib == "string"));
//alert("attrib.indexOf('_')== 0:"+(attrib.indexOf("_")== 0));
//alert("attrib.length>1:"+(attrib.length>1));
//alert("attrib.toString().length:"+(attrib.toString().length));
if(attrib.indexOf("_")== 0 && attrib.toString().length>1){//if2
if(!attrib&&attrib !="_n_"){return logError(new Error("Lang:"+lang+" val:"+attrib+ " missing"));}//ifER
attrib = bLang[lang][attrib];
//alert("2.attrib:"+attrib);
//alert("3.attrib:"+attrib);
}//if2
}
newAttribArr.push(attrib || " ");
}//for6
newAttribArr.push(childElm);
//newAttribArr.push(childElm.copy());
childrenArr.push(newAttribArr);
}//for3

// delete needs to be done the following way to work
//alert("1.elm.toXMLString():"+elm.toXMLString());
for each(var childElm in elm.children()){//for5
delete childElm.parent().*[childElm.childIndex()];
}//for5
//alert("2.elm.toXMLString():"+elm.toXMLString());

//sort
//alert("sortAttribs:"+sortAttribs.toSource());
//alert("sortSequence:"+sortSequence.toSource());
//alert("childrenArr:"+childrenArr.toSource());
//if it's needs to sort by more than one attribute
//alert("sortSequence.length:"+(sortSequence.length));
if(sortSequence.length==1){
//alert("1.childrenArr.toSource():"+childrenArr.toSource());
childrenArr.sort();
//alert("2.childrenArr.toSource():"+childrenArr.toSource());
}
else if(sortSequence.length>1){
childrenArr.sort(sortArray(sortSequence));
}

for(var i in childrenArr){//for7
//I think it will need to copy it from the array
//alert("childrenArr[i].toSource:"+childrenArr[i].toSource())
//alert("1. childrenArr[i].length:"+childrenArr[i].length);
//alert("2. childrenArr[i].length-1:"+(childrenArr[i].length-1));
//alert("3. (parseInt(childrenArr[i].length)-1):"+(parseInt((childrenArr[i].length)-1)));

//alert("childrenArr[i][childrenArr[i].length-1]:"+childrenArr[i][childrenArr[i].length-1]);
elm.appendChild(childrenArr[i][(childrenArr[i].length)-1]);
//elm.appendChild(childrenArr[i][(parseInt(childrenArr[i].length))-1].copy());
}//for7
//alert("3.elm.toXMLString():"+elm.toXMLString());
//newCompileThisLib = new XML(compileThisLib.toXMLString());
//wln.control.appendChild(newNodes.children());

//compileThisLib = compileThisLib.
}//if1
}//for1



//remove all unneeded attribs on the xmlEx4 array
for each(var e in compileThisLib..*){//for1
//if(e.nodeKind()=="element" && e.@id == "bdn"){
//alert("1.e.toXMLString():"+e.toXMLString());
//}
if(e.nodeKind()=="element"){for each(var a in e.@*){if(a.name()!="id"&& a.name()!="hashVal"){delete e.@[a.name()];}}}
//if(e.nodeKind()=="element" && e.@id == "bdn"){
//alert("2.e.toXMLString():"+e.toXMLString());
//}
}//for1

//alert(compileThisLib.toSource());
//create unique id numbers for the wpn lib nodes within the all set elements, and for developing proposes only, create a new attribute named oldid which contains the orginal id value. The oldId is only used to help develop the program, and can be removed for the beta and final versions of the program.
var ctg = catg.wpn;
//alert(compileThisLib.float[0].toXMLString());
var getLibSets  = compileThisLib.float[0].*.(@id==ctg.a)[0].*.(@id==ctg.a+ctg.b)[0].*.(@id==ctg.pF)[0].set;
for each(var set in getLibSets){//for1
var count = 0;
for each(var elm in set..*){//for2
var elmNam = elm.name();
if(elm.nodeKind()=="element"&&elmNam!="visual"&&elmNam!="hidden"){//if1
//!IMPORTANT ####################################################
//The following line with oldid gets uncommented for the beta and final public builds of the program
elm.@oldid = elm.@id;
elm.@id = count++;
}//if1
}//for2
}//for1

//dw.runCommand("stop_js_run_alert.htm");
//write the new page
var compilePage = bHash.toSource();
compilePage = compilePage.substring(1,compilePage.length-1);
compilePage = compilePage.replace(/, /g,",");

//build the zLang array of words which the program will need for variou things. These R words outside the Hash and lib.
var wordArrVals = ["_Ok","_None","_Arrow01Down","_NoneWbrakets","_NoneSelected","_loadingPreview","_PreviewCol","_Top","_RT","_Bot","_LT","_HorizontalOneLetter","_VerticalOneLetter","_message4holdPage","_couldNotBeFound","_Page","_Snipit","_PleaseSelectAFolderToPlaceNewDuplicateIn","_PleaseSelectAFolderToPlaceNewPageIn","_Cancel","_FolderName","_MenuName","_UntitledDocument","_alert0001","_alert0002","_alert0003","_alert0004","_messagepage","_messagePleaseWait","_NonNumbersAreNotAllowInSizeField","_Clear","_ClearWbrakets"];

var wordArr = {};
for each(var word in wordArrVals){
wordArr[word] = bLang[lang][word];
}
wordArr = wordArr.toSource();
wordArr = wordArr.substring(1,wordArr.length-1);

// for development this is set to true, but it should be set to false on beta and final builds
XML.prettyPrinting = true;

//writeTestingPage(true,lang+"HashAr.txt", "var zHash="+compilePage+"; var zLib="+compileThisLib.toXMLString()+";");
writeCompilePage(true,"lang/"+lang+"/index.js","var zHash="+compilePage+"; var zLib="+compileThisLib.float[0].toXMLString()+"; var zLang="+wordArr+";");
return LogFtnReturn(logFtn);

}

function saveWuiAsBuild(){
// this ftn is used only for developing stacksite. Needs to be removed on beta and user builds 
var saveFolderUrl = wui.path+"pastBuilds_wui/";
var pastFiles=dwFileExist(saveFolderUrl)&&dwFileListFolder(saveFolderUrl+"*wui.html","files")||false;
var currentBuildFileUrl= dwFileExist(wui.configpath+"Floaters/"+wui.versionName+".html",true);
var currentBuildFileCode=currentBuildFileUrl && DWfile.read(currentBuildFileUrl)||false;
var useNumber = 100001;

for each(var file in pastFiles){//for1
var filenumber = parseInt(file) || false;
(filenumber)? useNumber = filenumber + 1 : null;
}//for1

DWfile.write(saveFolderUrl+useNumber+"wui.html", currentBuildFileCode||" ");
alert("saveWuiAsBuild:" + useNumber + "wui.html has finished");
}

function saveFileAsBuild(){
// this ftn is used only for developing stacksite.
//  It needs to be removed on all beta and user builds.
var fileUrl = dw.getDocumentDOM().URL;
var folderUrl = fileUrl.indexOf(stackRoot)==0 && fileUrl.indexOf("/")>1 && fileUrl.substring(0, fileUrl.lastIndexOf("/")+1);
var sdn = getTree(catg.sdn);
var sdnSite = sdn.selNode.@n_name || false;
var sdnCurrentSite = site.getCurrentSite();
//stop if file is not part of development, or will not be placed in the correct place.
if(!folderUrl ||!sdnSite || !sdnCurrentSite || sdnCurrentSite.indexOf(wui.versionSiteName)<0 || sdnSite!=sdnCurrentSite){//if1
alert("NOT SAVED: the site named:"+wui.versionSiteName+ " most be selected before saving this file.");
return;
}//if1
var fileName = folderUrl && fileUrl.substring(fileUrl.lastIndexOf("/")+1);
var pastFiles= folderUrl && fileUrl && dwFileExist(folderUrl) && dwFileListFolder(folderUrl+"*"+fileName,"files");
var fileCode= dwFileExist(fileUrl) && DWfile.read(fileUrl);
var useNumber = 100001;

for each(var file in pastFiles){//for1
var filenumber = parseInt(file) || false;
(filenumber)? useNumber = filenumber + 1 : null;
}//for1

DWfile.write(folderUrl+useNumber+fileName, fileCode||" ");
alert("saveFileAsBuild:" + useNumber + fileName +" has finished");
//alert(folderUrl+useNumber+fileName);
}


function sortArray(arr){
// sort array
// ie call can be names or number
// Ftn attributes: 
//1. arr = should be an array in [] brackets.  Each value in this array
// should be in the order of importance of the array it is sorting.
// ie if arr = [1,0] Then the "1" repersents the second values of the array it's sorting,
// and 0 repersents the first value of the array it's sorting. Since the second values(1) come first
// it will sort the second values first, and the first values last.  The order can be changed around
// and there is no restriction on how many values in the array it is sorting, or which ones you wish to
// exclude. ie if u wish to sort and array with 4 values and want to sort the 4th values first and second last
// then arr = [3,1] 
if (arr && arr.length > 0){//if1
return function(a,b){//ftn1
for each(var prop in arr){//for1
if( a[prop] < b[prop] ){return -1;}
if( a[prop] > b[prop] ){return  1;}
}//for1
return 0;
};//ftn1
}//if1
else{
return function(a,b) { return a<=b; }
}
}

function zForm_InFo(){}//this is here so I can just jump to it 
var zForm={
b:<div namex="brdrimg">

<table id="bmbTable0" style="margin-top:0px">
<tr>
<td id="bmbTd1" width="0px"> </td>
<td id="bmbTd2"></td>
</tr>
</table>

<table id="bdnTable1">
<tr>
<td id="bdnTd1" width="0px"> </td>
<td id="bdnTd2">
<zztreecontrol id="bdnTreeElm" cat_id="bdn" style="width:375px;height:175px">
<zztreecolumn id="bdnColumn1" width="200px" value="Borders" />
<zztreecolumn id="bdnColumn2" width="150px" value="_" />
</zztreecontrol>
</td>
</tr>
</table>

<table id="bdnTable2">
<tr>
<td id="bdnTd3" width="0px"> </td>
<td id="bdnTd4" class="nowrap"><select id="bdnOptMnuElm"></select></td>
</tr>
</table>
<table id="blnTable1">
<tr>
<td id="blnTd1" width="0px"> </td>
<td id="blnTd2">
<zztreecontrol id="blnTreeElm" cat_id="bln" style="width:375px;height:150px">
<zztreecolumn id="blnColumn1" width="200px" value="Images" />
<zztreecolumn id="blnColumn2" width="150px" value="_" />
</zztreecontrol> 
</td>
</tr>
</table>

<table id="blnTable2">
<tr>
<td id="blnTd3" width="0px"> </td>
<td id="blnTd4" class="nowrap">
<select id="blnOptMnuElm"></select>
</td>
</tr>
</table>

<table id="bpnTable1" style="width:100%">
<tr>
<td id="bpnTd1" width="0px"> </td>
<td id="bpnTd2" style="text-align:center">
<div id="bpnTd2div1">Preview:</div>
<zzbrowsercontrol id="bpnTd2Browser" style="width:50%;height:100px" />
</td>
</tr>
</table>
</div>,


i:<div namex="mnuimg">

<table id="imbTable0" style="margin-top:0px">
<tr>
<td id="imbTd1" width="0px"> </td>
<td id="imbTd2"></td>
</tr>
</table>

<table id="idnTable1">
<tr>
<td id="idnTd1" width="0px"> </td>
<td id="idnTd2">
<zztreecontrol id="idnTreeElm" cat_id="idn" style="width:375px;height:150px">
<zztreecolumn id="idnColumn1" width="250px" value="Button Icons" />
<zztreecolumn id="idnColumn2" width="100px" value="_" />
</zztreecontrol> 
</td>
</tr>
</table>

<table id="idnTable2">
<tr>
<td id="idnTd3" width="0px"> </td>
<td id="idnTd4" class="nowrap">
<select id="idnOptMnuElm"></select>
</td>
</tr>
</table>
</div>,


j:<div namex="jsArray">

<table id="jmbTable0" style="margin-top:0px">
<tr>
<td id="jmbTd1" width="0px"> </td>
<td id="jmbTd2"></td>
</tr>
</table>

<table id="jdnTable1">
<tr>
<td id="jdnTd1" width="0px"> </td>
<td id="jdnTd2">
<zztreecontrol id="jdnTreeElm" cat_id="jdn" style="width:375px;height:150px">
<zztreecolumn id="jdnColumn1" width="200px" value="Scripts" />
<zztreecolumn id="jdnColumn2" width="150px" value="_" />
</zztreecontrol> 
</td>
</tr>
</table>

<table id="jdnTable2">
<tr>
<td id="jdnTd3" width="0px"> </td>
<td id="jdnTd4" class="nowrap">
<select id="jdnOptMnuElm"></select>
</td>
</tr>
</table>
</div>,


m:<div namex="menu Arrays">

<table id="mmbTable0" style="margin-top:0px">
<tr>
<td id="mmbTd1" width="0px"> </td>
<td id="mmbTd2"></td>
</tr>
</table>

<table id="mdnTable1">
<tr>
<td id="mdnTd1" width="0px"> </td>
<td id="mdnTd2">
<zztreecontrol id="mdnTreeElm" cat_id="mdn" style="width:375px;height:150px">
<zztreecolumn id="mdnColumn1" width="200px" value="Menus" />
<zztreecolumn id="mdnColumn2" width="150px" value="_" />
</zztreecontrol> 
</td>
</tr>
</table>

<table id="mdnTable2">
<tr>
<td id="mdnTd3" width="0px"> </td>
<td id="mdnTd4" class="nowrap">
<select id="mdnOptMnuElm"></select>
</td>
</tr>
</table>
</div>,


n:<div namex="snipits">

<table id="nmbTable0" style="margin-top:0px">
<tr>
<td id="nmbTd1" width="0px"> </td>
<td id="nmbTd2"></td>
</tr>
</table>

<table id="ndnTable1">
<tr>
<td id="ndnTd1" width="0px"> </td>
<td id="ndnTd2">
<zztreecontrol id="ndnTreeElm" cat_id="ndn" style="width:375px;height:150px">
<zztreecolumn id="ndnColumn1" width="200px" value="Snipits" />
<zztreecolumn id="ndnColumn2" width="150px" value="_" />
</zztreecontrol>
</td>
</tr>
</table>

<table id="ndnTable2">
<tr>
<td id="ndnTd3" width="0px"> </td>
<td id="ndnTd4" class="nowrap">
<select id="ndnOptMnuElm"></select> 
</td>
</tr>
</table>
</div>,


p:<div namex="pref">

<table id="pmbTable0" style="margin-top:0px">
<tr>
<td id="pmbTd1" width="0px"> </td>
<td id="pmbTd2"></td>
</tr>
</table>

<table id="pdnTable1">
<tr>
<td id="pdnTd1" width="0px"> </td>
<td id="pdnTd2">
<zztreecontrol id="pdnTreeElm" cat_id="pdn" style="width:375px;height:150px">
<zztreecolumn id="pdnColumn1" width="250px" value="Preferences" />
<zztreecolumn id="pdnColumn2" width="100px" value="_" />
</zztreecontrol> 
</td>
</tr>
</table>

<table id="pdnTable2">
<tr>
<td id="pdnTd3" width="0px"> </td>
<td id="pdnTd4" class="nowrap">
<select id="pdnOptMnuElm"></select>
</td>
</tr>
</table>
</div>,


s:<div namex="Sites">

<table id="smbTable0" style="margin-top:0px">
<tr>
<td id="smbTd1" width="0px"> </td>
<td id="smbTd2"></td>
</tr>
</table>

<table id="sdnTable1" style="width:100%;height:auto">
<tr>
<td id="sdnTd1" width="0px"> </td>
<td id="sdnTd2" style="width:100%">
<zztreecontrol id="sdnTreeElm"  cat_id="sdn" style="width:100%;height:50%">
<zztreecolumn id="sdnColumn1" width="175px" value="Sites" />
<zztreecolumn id="sdnColumn2" width="175px" value="_" />
</zztreecontrol> 
</td>
</tr>
</table>

<table id="sdnTable2" style="width:100%;height:auto">
<tr> 
<td id="sdnTd3" width="0px"> </td>
<td id="sdnTd4" style="width:100%" class="nowrap">
<select id="sdnOptMnuElm"></select>
</td>
</tr>
</table>

</div>,


t:<div namex="temp">

<table id="tmbTable0" style="margin-top:0px">
<tr>
<td id="tmbTd1" width="0px"> </td>
<td id="tmbTd2"></td>
</tr>
</table>

<table id="tdnTable1">
<tr>
<td id="tdnTd1" width="0px"> </td>
<td id="tdnTd2">
<zztreecontrol id="tdnTreeElm" cat_id="tdn" style="width:375px;height:150px">
<zztreecolumn id="tdnColumn1" width="200px" value="Templetes" />
<zztreecolumn id="tdnColumn2" width="150px" value="_" />
</zztreecontrol>
</td>
</tr>
</table>

<table id="tdnTable2">
<tr>
<td id="tdnTd3"></td>
<td id="tdnTd4" class="nowrap">
<select id="tdnOptMnuElm"></select> 
</td>
</tr>
</table>
</div>,


w:<div namex="wui">

<table id="wmbTable0" style="margin-top:0px">
<tr>
<td id="wmbTd1" width="0px"> </td>
<td id="wmbTd2"></td>
</tr>
</table>

<table id="wdnTable1">
<tr>
<td id="wdnTd1" width="0px"> </td>
<td id="wdnTd2">
<zztreecontrol id="wdnTreeElm" cat_id="wdn" style="width:375px;height:150px">
< zztreecolumn id="wdnColumn1" width="200px" value="Pages" />
< zztreecolumn id="wdnColumn2" width="150px" value="_" />
< zztreecolumn id="wdnColumn3" width="0px" value="" />
</zztreecontrol>
</td>
</tr>
</table>

<table id="wdnTable2">
<tr>
<td id="wdnTd3" width="0px"> </td>
<td id="wdnTd4" class="nowrap">
<select id="wdnOptMnuElm"></select> 
</td>
</tr>
</table>

<table id="wlnTable1">
<tr>
<td id="wlnTd1" width="0px"> </td>
<td id="wlnTd2">
<zztreecontrol id="wlnTreeElm" cat_id="wln" style="width:375px;height:150px">
<zztreecolumn id="wlnColumn1" width="250px" value="Document" />
<zztreecolumn id="wlnColumn2" width="100px" value="_" />
</zztreecontrol> 
</td>
</tr>
</table>

<table id="wlnTable2">
<tr>
<td id="wlnTd3" width="0px"> </td>
<td id="wlnTd4" class="nowrap">
<select id="wlnOptMnuElm"></select>
</td>
</tr>
</table>

<table id="wpnTable1">
<tr>
<td id="wpnTd1" width="0px"> </td>
<td id="wpnTd2">
<zztreecontrol id="wpnTreeElm" cat_id="wpn" style="width:375px;height:200px">
<zztreecolumn id="wpnColumn1" width="150px" value="All" />
<zztreecolumn id="wpnColumn2" width="200px" value="Properties" />
</zztreecontrol>
</td>
</tr>
</table>

<table id="wpnTable2">
<tr>
<td id="wpnTd3" width="0px"> </td>
<td id="wpnTd4" class="nowrap"><select id="wpnOptMnuElm"></select></td>
</tr>
</table>
</div>,


z:<div namex="about">

<table id="zmbTable0" style="margin-top:0px">
<tr>
<td id="zmbTd1" width="0px"> </td>
<td id="zmbTd2"></td>
</tr>
</table>

<table id="zdnTable1">
<tr>
<td id="zdnTd1" width="0px"> </td>
<td id="zdnTd2">
<zztreecontrol id="zdnTreeElm" cat_id="zdn" style="width:375px;height:175px">
<zztreecolumn id="zdnColumn1" width="200px" value="About" />
<zztreecolumn id="zdnColumn2" width="150px" value="_" />
</zztreecontrol>
</td>
</tr>
</table>

<table id="zdnTable2">
<tr>
<td id="zdnTd3" width="0px"> </td>
<td id="zdnTd4"><select id="zdnOptMnuElm"></select></td>
</tr>
</table>
</div>,

};

function unCopliledLib_InFo(){}//this is here so I can just jump to it 
var unCopliledLib = <ss>
<float id="qss">

<lib id="b" vV="_Photos" description="Photos (b)" sortOrder="1">

<tree id="bd" vV="Photo Directory Tree (bd)">

<nodes id="bdn" vV="Photo Directory Nodes (bdn)" tyNme="__" tyDes="" mvValue="0" adQty="0" iUd="0" adNds="c" oSel="addq0" oOpts="addq0" fileDelTypes="" fileNames="" fileNameTypes="" fileDups="" dName="Photo" iFile="" nLink="" nPath="" vI="">

<z id="alp" vV="__" tyNme="_All" tyDes="" mvValue="0"  adQty="0" iUd="0" adNds="0" oSel="addq0" oOpts="addq0" fileDelTypes="" fileNames="" fileNameTypes="" fileDups="" dName="_All" iFile="" vI="" nLink="" nPath="">
</z>
<z id="alb" vV="__" tyNme="_Albums" tyDes="" mvValue="0"  adQty="0" iUd="0" adNds="0" oSel="addq0" oOpts="addq0" fileDelTypes="" fileNames="" fileNameTypes="" fileDups="" dName="_Albums" iFile="" vI="" nLink="" nPath="">
<z id="2" vV="_New" tyNme="_Albums" tyDes="" mvValue="0"  adQty="u" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0|dupq0|expq0|impq0|namq0|rplq0" fileDelTypes="" fileNames="_iFile|_nFile|_uFile" fileNameTypes="rwm|rvw|rvw" fileDups="_iFile|_nFile|_uFile" dName="_unNamed" iFile="i.html" vI="" nLink="i.html" nPath=""></z>
</z>

<z id="e" vV="_ERROR" tyNme="_ERROR" tyDes="" mvValue="0" adQty="0" iUd="0" adNds="" oSel="errq0" oOpts="errq0|delq0" fileDelTypes="" fileNames="" fileNameTypes="" fileDups="" dName="_unNamed" vI="" nLink="" nPath=""></z>
</nodes>
<optcol id="bdo" vV="Photo Directory OptionCol (bdo)" colNames="_Photos|_InUseQty" colNvs="node.@n_name|node.@in_use_qty" eElms="" sortChildrenBy="vV|sortOrder">
<z id="addq0" vV="_Add" colNames="~parent" colNvs="~parent" eElms="empty04|sel17|sel0" sortOrder="1"></z>
<z id="delq0" vV="_Delete" colNames="~parent" colNvs="~parent" eElms="empty04|sel17|sel4" sortOrder="1"></z>
<z id="dupq0" vV="_Duplicate" colNames="~parent" colNvs="~parent" eElms="empty04|sel17" sortOrder="1"></z>
<z id="errq0" vV="_Repair" colNames="~parent" colNvs="~parent" eElms="empty04|sel17|inp3" sortOrder="1"></z>
<z id="expq0" vV="_Export" colNames="~parent" colNvs="~parent" eElms="empty04|sel17|sel7" sortOrder="1"></z>
<z id="impq0" vV="_Import" colNames="~parent" colNvs="~parent" eElms="empty04|sel17|sel7" sortOrder="1"></z>
<z id="namq0" vV="_Name" colNames="~parent" colNvs="~parent" eElms="empty04|sel17|inp1|inp2" sortOrder="1"></z>
<z id="rplq0" vV="_Replace" colNames="~parent" colNvs="~parent" eElms="empty04|sel17|inp3" sortOrder="1"></z>
</optcol>

<elements id="bde" vV="Photo Directory Elements (bde)" eBF="__" eID="" pIH="__" eFN="" eSZ="" dataSource="" vOPT="">
<z id="sel0" vV="addNode" eBF="Select3" eID="bdnAddElm" pIH="bdnTd4" eFN="bdn|addBDN" dataSource="" vOPT=""></z>
<z id="sel4" vV="deleteNode" eBF="Select4" eID="bdnDelElm" pIH="~sel0" eFN="bdn|deleteBDN" dataSource="" vOPT="['-',false,0],['_ToTrash','trash',1],['_ToArchive','archive',1]"></z>
<z id="sel7" vV="export" eBF="SelectX" eID="bdnExportElm" pIH="~sel0" eFN="bdn|bdnExport" dataSource="" vOPT="['_Browse',0,0]"></z>
<z id="inp1" vV="nameField" eBF="Input1" eID="bdnNameField" pIH="~sel0" eFN="" dataSource="n_name" vOPT=""></z>
<z id="inp2" vV="nameOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="bdn|nameBDN" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp3" vV="repairOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="bdn|bdnRepairOk" dataSource="" vOPT="['_Error',0,0]"></z>
<z id="empty03" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="bmbTd2" eFN="" dataSource="" vOPT=""></z>
<z id="empty04" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="bdnTd4" eFN="" dataSource="" vOPT=""></z>
<z id="sel17" vV="treeOptionMenu" eBF="TreeOptionMenu" eID="bdnOptMnuElm" pIH="~sel0" eFN="bdn|optMnuBDN" dataSource="" vOPT=""></z>
</elements>

</tree>
<tree id="bl" vV="Border Layout (bl)">

<nodes id="bln" vV="Border Layout Nodes (bln)" tyNme="__" tyDes="" mvValue="0" adQty="0" iUd="0" adNds="c" oSel="addq0" oOpts="addq0" fileNames="" iFile="" fileNameTypes="rw" fileDups="" dName="Border" vI="" nLink="" statusNum="" statusNames="">

<z id="2" vV="_Top" refTag="~parent" tyNme="_gif" tyDes="" mvValue="0" adQty="1" iUd="0" adNds="p" oSel="addq0" oOpts="addq0" fileNames="" iFile="1.gif" fileNameTypes="rw" fileDups="1.gif" dName="_Top" vI="" nLink="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="3" vV="_Bottom" refTag="2" tyNme="_gif" tyDes="" fileNames="2.gif" iFile="2.gif" fileDups="2.gif" dName="_Bottom" vI="" nLink=""></z>

<z id="4" vV="_Left" refTag="2" tyNme="_gif" tyDes="" fileNames="3.gif" iFile="3.gif" fileDups="3.gif" dName="_Left" vI="" nLink=""></z>

<z id="5" vV="_Right" refTag="2" tyNme="_gif" tyDes="" fileNames="4.gif" iFile="4.gif" fileDups="4.gif" dName="_Right" vI="" nLink=""></z>

<z id="6" vV="_TopLeft" refTag="2" tyNme="_gif" tyDes="" fileNames="5.gif" iFile="5.gif" fileDups="5.gif" dName="_TopLeft" vI="" nLink=""></z>

<z id="7" vV="_TopRight" refTag="2" tyNme="_gif" tyDes="" fileNames="6.gif" iFile="6.gif" fileDups="6.gif" dName="_TopRight" vI="" nLink=""></z>

<z id="8" vV="_BottomLeft" refTag="2" tyNme="_gif" tyDes="" fileNames="7.gif" iFile="7.gif" fileDups="7.gif" dName="_BottomLeft" vI="" nLink=""></z>

<z id="9" vV="_BottomRight" refTag="2" tyNme="_gif" tyDes="" fileNames="8.gif" iFile="8.gif" fileDups="8.gif" dName="_BottomRight" vI="" nLink=""></z>
</nodes>

<optcol id="blo" vV="Border Layout Options (blo)" colNames="_Images|_Type|_sCs|_Size" colNvs="node.@n_name|dnTagX.tyNme||node.@n_type_size" eElms="">
<z id="addq0" vV="_Add" colNames="~parent" colNvs="~parent" eElms="empty08|sel19|sel0"></z>
<z id="delq0" vV="_Delete" colNames="~parent" colNvs="~parent" eElms="empty08|sel19|sel4"></z>
<z id="ediq0" vV="_Edit" colNames="~parent" colNvs="~parent" eElms="empty08|sel19|sel6"></z>
<z id="impq0" vV="_Import" colNames="~parent" colNvs="~parent" eElms="empty08|sel19"></z>
</optcol>

<elements id="ble" vV="Border Layout Elements (ble)" eBF="__" eID="" pIH="__" eFN="" eSZ="" dataSource="" vOPT="">
<z id="sel0" vV="addNode" eBF="Select3" eID="blnAddElm" pIH="blnTd4" eFN="bln|addBLN" dataSource="" vOPT=""></z>
<z id="sel4" vV="deleteNode" eBF="Select4" eID="blnDelElm" pIH="~sel0" eFN="bln|blnDelete" dataSource="" vOPT="['-',false,0],['_ToTrash','trash',1],['_ToArchive','archive',1]"></z>
<z id="sel6" vV="Edit" eBF="Select6" eID="blnEdiElm" pIH="~sel0" eFN="bln|blnEdit" dataSource="" vOPT=""></z>
<z id="inp1" vV="nameField" eBF="Input1" eID="blnNameField" pIH="~sel0" eFN="" dataSource="n_name" vOPT=""></z>
<z id="inp2" vV="nameOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="bln|blnNameOk" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp3" vV="repairOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="bln|blnRepairOk" dataSource="" vOPT="['_Error',0,0]"></z>
<z id="empty07" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="bmbTd2" eFN="" dataSource="" vOPT=""></z>
<z id="empty08" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="blnTd4" eFN="" dataSource="" vOPT=""></z>
<z id="sel19" vV="treeOptionMenu" eBF="TreeOptionMenu" eID="blnOptMnuElm" pIH="~sel0" eFN="bln|optMnuBLN" dataSource="" vOPT=""></z>
</elements>

</tree>
</lib>

<lib id="j" vV="_Scripts" description="JavaScripts (j)" sortOrder="1">

<tree id="jd" vV="JavaScripts Directory Tree (jd)">

<nodes id="jdn" vV="JavaScripts Directory Nodes (jdn)" tyNme="__" tyDes="" mvValue="0" adQty="0" iUd="0" adNds="c" oSel="addq0" oOpts="addq0" fileDelTypes="" fileNames="" fileNameTypes="" dName="Scripts" fileDups="" iFile="" vI="" nLink="" nPath="" statusNum="" statusNames="">

<z id="1" vV="HeadLoader " tyNme="js" tyDes="Loader for Page" mvValue="0" adQty="1" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0" fileDelTypes="" fileNames="_iFile|_cFile|_gFile|_nFile|_uFile" fileNameTypes="rwm|rwm|rwm|rvw|rvw" dName="HTML Head Loader" fileDups="" iFile="" vI="" nLink="c.js" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="2" vV="bottomLoader " tyNme="js" tyDes="Loader for Page" mvValue="0" adQty="1" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0" fileDelTypes="" fileNames="_iFile|_cFile|_gFile|_nFile|_uFile" fileNameTypes="rwm|rwm|rwm|rvw|rvw" dName="HTML Bottom Loader" fileDups="" iFile="" vI="" nLink="c.js" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="3" vV="urlUpdateSearchVals" tyNme="js" tyDes="urlUpdateSearchVals" mvValue="0" adQty="1" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0" fileDelTypes="" fileNames="_iFile|_nFile|_uFile" fileNameTypes="rwm|rvw|rvw" dName="urlUpdateSearchVals" fileDups="" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="101" vV="DomBuilder" tyNme="js" tyDes="Builds the Dom" mvValue="0" adQty="1" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0" fileDelTypes="" fileNames="_iFile|_mFile|_nFile|_uFile" fileNameTypes="rwm|mfi|rvw|rvw" dName="DomBuilder" fileDups="_iFile|_mFile|_uFile" iFile="" vI="" nLink="c.js" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="501" vV="DropMenu" tyNme="js" tyDes="drop Menu Code" mvValue="0" adQty="1" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0" fileDelTypes="" fileNames="_mFile|_hFile|_nFile" fileNameTypes="mfi|rvw|rvw" dName="DropMenu" fileDups="*" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="e" vV="ERROR!" tyNme="_ERROR" tyDes="_ERROR" mvValue="0" adQty="0" iUd="0" adNds="" oSel="errq0" oOpts="delq0|errq0" fileDelTypes="" fileNames="" fileNameTypes="" dName="_unNamed" fileDups="" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>
</nodes>

<optcol id="jdo" vV="JavaScripts Directory Options (jdo)" colNames="_Scripts|_Type|_sCs|_InUseQty" colNvs="node.@n_name|dnTagX.tyNme||node.@in_use_qty" eElms="">
<z id="addq0" vV="_Add" colNames="~parent" colNvs="~parent" eElms="empty10|sel20|sel0"></z>
<z id="delq0" vV="_Delete" colNames="~parent" colNvs="~parent" eElms="empty10|sel20|sel4"></z>
<z id="namq0" vV="_Name" colNames="~parent" colNvs="~parent" eElms="empty10|sel20|inp1|inp2"></z>
<z id="errq0" vV="_ERROR" colNames="~parent" colNvs="~parent" eElms="empty10|sel20|inp3"></z>
</optcol>

<elements id="jde" vV="JavaScripts Directory Elements (jde)" eBF="__" eID="" pIH="__" eFN="" eSZ="" dataSource="" vOPT="">
<z id="sel0" vV="addNode" eBF="Select3" eID="jdnAddElm" pIH="jdnTd4" eFN="jdn|addJDN" dataSource="" vOPT=""></z>
<z id="sel4" vV="deleteNode" eBF="Select4" eID="jdnDelElm" pIH="~sel0" eFN="jdn|jdnDelete" dataSource="" vOPT="['-',false,0],['_ToTrash','trash',1],['_ToArchive','archive',1]"></z>
<z id="inp1" vV="nameField" eBF="Input1" eID="jdnNameField" pIH="~sel0" eFN="" dataSource="n_name" vOPT=""></z>
<z id="inp2" vV="nameOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="jdn|jdnNameOk" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp3" vV="repairOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="jdn|jdnRepairOk" dataSource="" vOPT="['_Error',0,0]"></z>
<z id="empty09" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="jmbTd2" eFN="" dataSource="" vOPT=""></z>
<z id="empty10" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="jdnTd4" eFN="" dataSource="" vOPT=""></z>
<z id="sel20" vV="treeOptionMenu" eBF="TreeOptionMenu" eID="jdnOptMnuElm" pIH="~sel0" eFN="jdn|optMnuJDN" dataSource="" vOPT=""></z>

</elements>

</tree>
</lib>
 

<lib id="m" vV="_MenuArrays" description="Menu (m)" sortOrder="1">

<tree id="md" vV="Menu Directory Tree (md)">

<nodes id="mdn" vV="Menu Directory Nodes (mdn)" tyNme="__" tyDes="" mvValue="0" adQty="0" iUd="0" adNds="c" oSel="addq0" oOpts="addq0" fileDelTypes="" fileNames="" fileNameTypes="" dName="Menus" fileDups="" iFile="" vI="" nLink="" nPath="" statusNum="" statusNames="">

<z id="3" vV="_Default" tyNme="_Site" tyDes="_MenuArray" mvValue="0"  adQty="1" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0|dupq0|impq0" fileDelTypes="" fileNames="_iFile|_mFile|_nFile|_uFile" fileNameTypes="rwm|mfi|rvw|rvw" dName="_Default" fileDups="_iFile|_mFile|_uFile" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="4" vV="_Page" tyNme="NotUsed" tyDes="_MenuArray" mvValue="0"  adQty="u" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0|dupq0|impq0" fileDelTypes="" fileNames="_iFile|_mFile|_nFile|_uFile" fileNameTypes="rwm|mfi|rvw|rvw" dName="_unNamed" fileDups="_iFile|_mFile|_uFile" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="5" vV="_NewCustom" tyNme="_Page" tyDes="_MenuArray" mvValue="0"  adQty="u" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0|dupq0|impq0" fileDelTypes="" fileNames="_iFile|_mFile|_nFile|_uFile" fileNameTypes="rwm|mfi|rvw|rvw" dName="_unNamed" fileDups="_iFile|_mFile|_uFile" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="e" vV="_ERROR" tyNme="_ERROR" tyDes="_ERROR" mvValue="0" adQty="0" iUd="0" adNds="" oSel="errq0" oOpts="errq0" fileDelTypes="" fileNames="" fileNameTypes="" dName="_unNamed" fileDups="" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>
</nodes>

<optcol id="mdo" vV="Menu Directory Options (mdo)" colNames="_MenuArrays|_Type|_sCs|_InUseQty" colNvs="node.@n_name|dnTagX.tyNme||node.@in_use_qty" eElms="">
<z id="addq0" vV="_Add" colNames="~parent" colNvs="~parent" eElms="empty06|sel18|sel0"></z>
<z id="delq0" vV="_Delete" colNames="~parent" colNvs="~parent" eElms="empty06|sel18|sel4"></z>
<z id="dupq0" vV="_Duplicate" colNames="~parent" colNvs="~parent" eElms="empty06|sel18"></z>
<z id="impq0" vV="_Import" colNames="~parent" colNvs="~parent" eElms="empty06|sel18"></z>
<z id="namq0" vV="_Name" colNames="~parent" colNvs="~parent" eElms="empty06|sel18|inp1|inp2"></z>
<z id="errq0" vV="_Repair" colNames="~parent" colNvs="~parent" eElms="empty06|sel18|inp3"></z>
</optcol>

<elements id="mde" vV="Menu Directory Elements (mde)" eBF="__" eID="" pIH="__" eFN="" eSZ="" dataSource="" vOPT="">
<z id="sel0" vV="addNode" eBF="Select3" eID="mdnAddElm" pIH="mdnTd4" eFN="mdm|mdnAdd" dataSource="" vOPT=""></z>
<z id="sel4" vV="deleteNode" eBF="Select4" eID="mdnDelElm" pIH="~sel0" eFN="mdm|mdnDelete" dataSource="" vOPT="['-',false,0],['_ToTrash','trash',1],['_ToArchive','archive',1]"></z>
<z id="inp1" vV="nameField" eBF="Input1" eID="mdnNameField" pIH="~sel0" eFN="" dataSource="n_name" vOPT=""></z>
<z id="inp2" vV="nameOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="mdm|mdnNameOk" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp3" vV="repairOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="mdm|mdnRepairOk" dataSource="" vOPT="['_Error',0,0]"></z>
<z id="empty05" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="mmbTd2" eFN="" dataSource="" vOPT=""></z>
<z id="empty06" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="mdnTd4" eFN="" dataSource="" vOPT=""></z>
<z id="sel18" vV="treeOptionMenu" eBF="TreeOptionMenu" eID="mdnOptMnuElm" pIH="~sel0" eFN="mdn|optMnuMDN" dataSource="" vOPT=""></z>

</elements>

</tree>

</lib>


<lib id="s" vV="_Sites" description="Site (s)" sortOrder="1">

<tree id="sd" vV="Site Directory Tree (sd)">

<nodes id="sdn" vV="Site Directory Nodes (sdn)" tyNme="__" tyDes="" mvValue="0" adQty="0" iUd="0" adNds="c" oSel="addq0" oOpts="addq0|impq0" fileDelTypes="" fileNames="" fileNameTypes="" fileDups="" dName="Site" iFile="" vI="" nLink="" nPath="" statusNum="" statusNames="">

<z id="2" vV="_DW" tyNme="_DW" tyDes="_Dreamweaver" mvValue="0"  adQty="u" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0|dupq0|impq0|namq0" fileDelTypes="" fileNames="_iFile|_nFile|_uFile" fileNameTypes="rwm|rvw|rvw" fileDups="_uFile" dName="_unNamed" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="3" vV="_SS" tyNme="_SS" tyDes="_StackSite" mvValue="0"  adQty="u" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0|dupq0|impq0|namq0" fileDelTypes="" fileNames="_iFile|_nFile|_uFile" fileNameTypes="rwm|rvw|rvw" fileDups="_uFile" dName="_unNamed" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="e" vV="_ERROR" tyNme="_ERROR" tyDes="_ERROR" mvValue="0" adQty="0" iUd="0" adNds="" oSel="errq0" oOpts="errq0" fileDelTypes="" fileNames="" fileNameTypes="" dName="_unNamed" fileDups="" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>
</nodes>

<optcol id="sdo" vV="Site Directory Options (sdo)" colNames="_Sites|_Type|_sCs|_Description" colNvs="node.@n_name|dnTagX.tyNme||dnTagX.tyDes" eElms="">
<z id="addq0" vV="_Add" colNames="~parent" colNvs="~parent" eElms="empty02|sel16|sel0|empty01|inp23"></z>
<z id="delq0" vV="_Delete" colNames="~parent" colNvs="~parent" eElms="empty02|sel16|sel4|empty01|inp23"></z>
<z id="dupq0" vV="_Duplicate" colNames="~parent" colNvs="~parent" eElms="empty02|sel16|empty01|inp23"></z>
<z id="errq0" vV="_ERROR" colNames="~parent" colNvs="~parent" eElms="empty02|sel16|inp3|empty01|inp23"></z>
<z id="impq0" vV="_Import" colNames="~parent" colNvs="~parent" eElms="empty02|sel16|empty01|inp23"></z>
<z id="namq0" vV="_Name" colNames="~parent" colNvs="~parent" eElms="empty02|sel16|inp1|inp2|empty01|inp23"></z>
</optcol>

<elements id="sde" vV="Site Directory Elements (sde)" eBF="__" eID="" pIH="__" eFN="" eSZ="" dataSource="" vOPT="">
<z id="sel0" vV="addNode" eBF="Select3" eID="sdnAddElm" pIH="sdnTd4" eFN="sdn|sdnAdd" dataSource="" vOPT=""></z>
<z id="sel4" vV="deleteNode" eBF="Select4" eID="sdnDelElm" pIH="~sel0" eFN="sdn|sdnDelete" dataSource="" vOPT="['-',false,0],['_ToTrash','trash',1],['_ToArchive','archive',1]"></z>
<z id="inp1" vV="nameField" eBF="Input1" eID="sdnNameField" pIH="~sel0" eFN="" dataSource="n_name" vOPT=""></z>
<z id="inp2" vV="nameOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="sdn|sdnNameOk" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp3" vV="repairOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="sdn|sdnRepairOk" dataSource="" vOPT="['_Error',0,0]"></z>
<z id="inp23" vV="refreshBtn" eBF="InputBtn" eID="smbSiteRefreshElm" pIH="smbTd2" eFN="sdn|refreshSDN" dataSource="" vOPT="['_reFresh',0,0]"></z>
<z id="empty01" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="smbTd2" eFN="" dataSource="" vOPT=""></z>
<z id="empty02" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="sdnTd4" eFN="" dataSource="" vOPT=""></z>
<z id="sel16" vV="treeOptionMenu" eBF="TreeOptionMenu" eID="sdnOptMnuElm" pIH="~sel0" eFN="sdn|optMnuSDN" dataSource="" vOPT=""></z>
</elements>

</tree>
</lib>


<lib id="n" vV="_Snipits" description="Snipit (n)" sortOrder="1">

<tree id="nd" vV="Snipit Directory Tree (nd)">

<nodes id="ndn" vV="Snipit Directory Nodes (ndn)" tyNme="__" tyDes="" mvValue="0" adQty="0" iUd="0" adNds="c" oSel="addq0" oOpts="addq0" fileDelTypes="" fileNames="" fileNameTypes="" dName="Snipit" fileDups="" iFile="" vI="" nLink="" nPath="" statusNum="" statusNames="">

<z id="2" vV="_New" tyNme="_hSnp" tyDes="_htmlSnipit" mvValue="0"  adQty="u" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0|dupq0|impq0|namq0" fileDelTypes="" fileNames="_iFile|_snFile|_sFile|_nFile|_uFile" fileNameTypes="rwm|rwm|sge|rvw|rvw" dName="_unNamed" fileDups="" iFile="" vI="" nLink="snipit.html" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="e" vV="_ERROR" tyNme="_ERROR" tyDes="_ERROR" mvValue="0" adQty="0" iUd="0" adNds="" oSel="errq0" oOpts="errq0" fileDelTypes="" fileNames="" fileNameTypes="" dName="_unNamed" fileDups="" iFile="" vI="" nLink="i.html" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

</nodes>

<optcol id="ndo" vV="Snipit Directory Options (ndo)" colNames="_Snipits|_Type|_sCs|_InUseQty" colNvs="node.@n_name|dnTagX.tyNme||node.@in_use_qty" eElms="">
<z id="addq0" vV="_Add" colNames="~parent" colNvs="~parent" eElms="empty12|sel21|sel0|empty11|refresh1"></z>
<z id="delq0" vV="_Delete" colNames="~parent" colNvs="~parent" eElms="empty12|sel21|sel4|empty11|refresh1"></z>
<z id="dupq0" vV="_Duplicate" colNames="~parent" colNvs="~parent" eElms="empty12|sel21|empty11"></z>
<z id="impq0" vV="_Import" colNames="~parent" colNvs="~parent" eElms="empty12|sel21|empty11"></z>
<z id="namq0" vV="_Name" colNames="~parent" colNvs="~parent" eElms="empty12|sel21|inp1|inp2|empty11|refresh1"></z>
<z id="errq0" vV="_Repair" colNames="~parent" colNvs="~parent" eElms="empty12|sel21|inp3|empty02"></z>
</optcol>

<elements id="nde" vV="Snipit Directory Elements (nde)" eBF="__" eID="" pIH="__" eFN="" eSZ="" dataSource="" vOPT="">
<z id="sel0" vV="addNode" eBF="Select3" eID="ndnAddElm" pIH="ndnTd4" eFN="ndn|addNDN" dataSource="" vOPT=""></z>
<z id="sel4" vV="deleteNode" eBF="Select4" eID="ndnDelElm" pIH="~sel0" eFN="ndn|deleteNDN" dataSource="" vOPT="['-',false,0],['_ToTrash','trash',1],['_ToArchive','archive',1]"></z>
<z id="inp1" vV="nameField" eBF="Input1" eID="ndnNameField" pIH="~sel0" eFN="" dataSource="n_name" vOPT=""></z>
<z id="inp2" vV="nameOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="ndn|nameNDN" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp3" vV="repairOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="ndn|ndnRepairOk" dataSource="" vOPT="['_Error',0,0]"></z>
<z id="refresh1" vV="snipitBtnRefresh" eBF="InputBtnHsn" eID="ndnRefreshElm" pIH="nmbTd2" eFN="ndn|refreshNDN" vOPT="['_Save',0,0]" dataSource=""></z>
<z id="empty11" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="nmbTd2" eFN="" dataSource="" vOPT=""></z>
<z id="empty12" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="ndnTd4" eFN="" dataSource="" vOPT=""></z>
<z id="sel21" vV="treeOptionMenu" eBF="TreeOptionMenu" eID="ndnOptMnuElm" pIH="~sel0" eFN="ndn|optMnuNDN" dataSource="" vOPT=""></z>


</elements>

</tree>

</lib>


<lib id="t" vV="_Templetes" description="Templete (t)" sortOrder="1">

<tree id="td" vV="Templete Directory Tree (td)">

<nodes id="tdn" vV="Templete Directory Nodes (tdn)" tyNme="__" tyDes="" mvValue="0" adQty="0" iUd="0" adNds="c" oSel="addq0" oOpts="addq0" fileDelTypes="" fileNames="" fileNameTypes="" dName="Templete" fileDups="" iFile="" vI="" nLink="" nPath="" statusNum="" statusNames="">

<z id="2" vV="_New" tyNme="_html" tyDes="_Templete" mvValue="0"  adQty="u" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0|dupq0|impq0|namq0" fileDelTypes="" fileNames="_iFile|_cFile|_gFile|_uFile|_nFile" fileNameTypes="rwm|rwm|rwm|rvw|rvw" dName="_unNamed" fileDups="_cFile|_gFile|_uFile" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="e" vV="_ERROR" tyNme="_ERROR" tyDes="_ERROR" mvValue="0" adQty="0" iUd="0" adNds="" oSel="errq0" oOpts="errq0" fileDelTypes="" fileNames="" fileNameTypes="" dName="_unNamed" fileDups="" iFile="" vI="" nLink="" nPath="" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

</nodes>

<optcol id="tdo" vV="Templete Directory Options (tdo)" colNames="_Templetes|_Type|_sCs|_InUseQty" colNvs="node.@n_name|dnTagX.tyNme||node.@in_use_qty" eElms="">
<z id="addq0" vV="_Add" colNames="~parent" colNvs="~parent" eElms="empty14|sel22|sel0"></z>
<z id="delq0" vV="_Delete" colNames="~parent" colNvs="~parent" eElms="empty14|sel22|sel4"></z>
<z id="dupq0" vV="_Duplicate" colNames="~parent" colNvs="~parent" eElms="empty14|sel22"></z>
<z id="impq0" vV="_Import" colNames="~parent" colNvs="~parent" eElms="empty14|sel22"></z>
<z id="namq0" vV="_Name" colNames="~parent" colNvs="~parent" eElms="empty14|sel22|inp1|inp2"></z>
<z id="errq0" vV="_Repair" colNames="~parent" colNvs="~parent" eElms="empty14|sel22|inp3"></z>
</optcol>

<elements id="tde" vV="Templete Directory Elements (tde)" eBF="__" eID="" pIH="__" eFN="" eSZ="" dataSource="" vOPT="">
<z id="sel0" vV="addNode" eBF="Select3" eID="tdnAddElm" pIH="tdnTd4" eFN="tdn|addTDN" dataSource="" vOPT=""></z>
<z id="sel4" vV="deleteNode" eBF="Select4" eID="tdnDelElm" pIH="~sel0" eFN="tdn|deleteTDN" dataSource="" vOPT="['-',false,0],['_ToTrash','trash',1],['_ToArchive','archive',1]"></z>
<z id="inp1" vV="nameField" eBF="Input1" eID="tdnNameField" pIH="~sel0" eFN="" dataSource="n_name" vOPT=""></z>
<z id="inp2" vV="nameOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="tdn|nameTDN" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp3" vV="repairOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="tdn|tdnRepairOk" dataSource="" vOPT="['_Error',0,0]"></z>
<z id="empty13" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="tmbTd2" eFN="" dataSource="" vOPT=""></z>
<z id="empty14" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="tdnTd4" eFN="" dataSource="" vOPT=""></z>
<z id="sel22" vV="treeOptionMenu" eBF="TreeOptionMenu" eID="tdnOptMnuElm" pIH="~sel0" eFN="tdn|optMnuTDN" dataSource="" vOPT=""></z>

</elements>

</tree>

</lib>


<lib id="w" vV="_Pages" description="Wui (w)" sortOrder="1">
<tree id="wd" vV="Wui Directory Tree (wd)">

<nodes id="wdn" vV="Wui Directory Nodes (wdn)" itemCatagory="" tyNme="__" tyDes="" mvValue="0" adQty="0" iUd="0" adNds="c" oSel="addq0" oOpts="addq0" fileDelTypes="" fileNames="" fileNameTypes="" fileDups="" iFile="" vI="" nLink="" nPath="" uScripts="" statusNum="" statusNames="">

<z id="1" vV="Home Page" itemCatagory="page" tyNme="_home_s_" tyDes="_Page" dName="_unNamed" mvValue="1"  adQty="1" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0|impq0|layq0|linq0|movq0|namq0|onoq0" fileDelTypes="" fileNames="_iFile|_nFile|_uFile|_nLink" fileNameTypes="rvw|rvw|rvw|dn" fileDups="_uFile" iFile="" vI="" nLink="index.html" nPath="" uScripts="1" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="2" vV="HTML Page" itemCatagory="page" tyNme="_htm5_s_" tyDes="_Page" dName="_unNamed" mvValue="1"  adQty="u" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0|dupq0|impq0|layq0|linq0|movq0|namq0|onoq0" fileDelTypes="" fileNames="_iFile|_nFile|_uFile|_nLink" fileNameTypes="rvw|rvw|rvw|dn" fileDups="_uFile" iFile="" vI="" nLink="index.html" nPath="" uScripts="1" statusNum="1|0|7|9" statusNames="Visual|Hidden|Locked|Offline|Trash"></z>

<z id="5" vV="New Link" itemCatagory="link" refTag="~parent" tyNme="_hLnk" tyDes="_hyperLink" dName="_unNamed" mvValue="1"  adQty="u" iUd="0" adNds="p" oSel="addq0" oOpts="addq0|delq0|dupq0|layq1|linq0|movq0|namq0|onoq0" vI=""></z>

<z id="e" vV="ERROR!" itemCatagory="err" refTag="~parent" tyNme="_Error" tyDes="_ERROR" dName="_unNamed" mvValue="1" adQty="0" iUd="0" adNds="" oSel="errq0" oOpts="errq0|delq0|layq0|onoq0" fileDelTypes="" fileNames="" fileNameTypes="" iFile="" nLink="" nPath="" vI=""></z>
</nodes>

<optcol id="wdo" vV="Wui Directory Options (wdo)" colNames="_Pages|_Type|_sCs|_Description" colNvs="node.@n_name|dnTagX.tyNme||dnTagX.tyDes" eElms="">
<z id="addq0" vV="_Add" colNames="~parent" colNvs="~parent" eElms="empty16|sel23|sel0"></z>
<z id="delq0" vV="_Delete" colNames="~parent" colNvs="~parent" eElms="empty16|sel23|sel4"></z>
<z id="dupq0" vV="_Duplicate" colNames="~parent" colNvs="~parent" eElms="empty16|sel23"></z>
<z id="errq0" vV="_Repair" colNames="~parent" colNvs="~parent" eElms="empty16|sel23|inp3"></z>
<z id="impq0" vV="_Import" colNames="~parent" colNvs="~parent" eElms="empty16|sel23"></z>
<z id="layq0" vV="_Layout" colNames="_Pages|_Type|_sCs|_Layout" colNvs="node.@n_name|dnTagX.tyNme||node.@tdn_name" eElms="empty16|sel23|sel1|sel2" ></z>
<z id="layq1" vV="_Layout" colNames="~layq0" colNvs="~layq0" eElms="empty16|sel23|txt2" ></z>
<z id="linq0" vV="_URL" colNames="_Pages|_Type|_sCs|_URL" colNvs="node.@n_name|dnTagX.tyNme||node.@n_link" eElms="empty16|sel23|inp13|inp14|inp15"></z>
<z id="movq0" vV="_Move" colNames="~parent" colNvs="~parent" eElms="empty16|sel23|bni1|bni2|bni3|bni4"></z>
<z id="movq1" vV="_Move" colNames="~parent" colNvs="~parent" eElms="empty16|sel23|txt0"></z>
<z id="namq0" vV="_Name" colNames="~parent" colNvs="~parent" eElms="empty16|sel23|inp1|inp2"></z>
<z id="onoq0" vV="_OnOff" colNames="~parent" colNvs="~parent" eElms="empty16|sel23"></z>
</optcol>

<elements id="wde" vV="Wui Directory Elements (wde)" eBF="__" eID="" pIH="__" eFN="" eSZ="" dataSource="" vOPT="">
<z id="sel0" vV="addNode" eBF="Select3" eID="wdnAddElm" pIH="wdnTd4" eFN="wdn|addWDN" dataSource="" vOPT=""></z>
<z id="sel4" vV="deleteNode" eBF="Select4" eID="wdnDelElm" pIH="~sel0" eFN="wdn|deleteWDN" dataSource="" vOPT="['-',false,0],['_ToTrash','trash',1],['_ToArchive','archive',1]"></z>
<z id="inp1" vV="nameField" eBF="Input1" eID="wdnNameField" pIH="~sel0" eFN="" dataSource="n_name" vOPT=""></z>
<z id="inp2" vV="nameOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="wdn|nameWDN" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp3" vV="repairOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="wdn|wdnRepairOk" dataSource="" vOPT="['_Error',0,0]"></z>

<z id="inp13" vV="linkField" eBF="Input1" eID="wdnLinkField" pIH="~sel0" eFN="" dataSource="n_link" vOPT=""></z>
<z id="inp14" vV="linkGetBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="wdn|wdnLinkBtnGet" dataSource="" vOPT="['_Get',0,0]"></z>
<z id="inp15" vV="linkOkBtn" eBF="InputBtn" eID="" pIH="~sel0" eFN="wdn|wdnLinkBtnOk" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="sel1" vV="layoutMnu" eBF="Select1" eID="wdnLayoutElm" pIH="~sel0" eFN="wdn|layoutWDN" dataSource="" vOPT=""></z>
<z id="sel2" vV="layoutMnuOptn" eBF="Select2" eID="wdnLayoutOptnElm" pIH="~sel0" eFN="wdn|wdnLayoutsOptn" dataSource="" vOPT="['_Arrow01Down',false,0],['_New','n',1],['_Get','g',1],['_Duplicate','d',1],['_EditName','e',1]"></z>
<z id="bni1" vV="BtnUp" eBF="InputBtn" eID="" pIH="~sel0" eFN="wdn|moveWDNup" dataSource="" vOPT="['_Arrow02Up',0,0]"></z>
<z id="bni2" vV="BtnDown" eBF="InputBtn" eID="" pIH="~sel0" eFN="wdn|moveWDNdown" dataSource="" vOPT="['_Arrow02Down',0,0]"></z>
<z id="bni3" vV="BtnLeft" eBF="InputBtn" eID="" pIH="~sel0" eFN="wdn|moveWDNleft" dataSource="" vOPT="['_Arrow02UpLT',0,0]"></z>
<z id="bni4" vV="BtnRight" eBF="InputBtn" eID="" pIH="~sel0" eFN="wdn|moveWDNright" dataSource="" vOPT="['_Arrow02DownRH',0,0]"></z>
<z id="txt0" vV="textMessage" eBF="txtMsg0" eID="" pIH="~sel0" eFN="" dataSource="" vOPT="['This Item is not Movable',0,0]"></z>
<z id="txt2" vV="textMessage" eBF="txtMsg0" eID="" pIH="~sel0" eFN="" dataSource="" vOPT="['<br />Links Do not have or use a Layout..',0,0]"></z>
<z id="empty15" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="wmbTd2" eFN="" dataSource="" vOPT=""></z>
<z id="empty16" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="wdnTd4" eFN="" dataSource="" vOPT=""></z>
<z id="sel23" vV="treeOptionMenu" eBF="TreeOptionMenu" eID="wdnOptMnuElm" pIH="~sel0" eFN="wdn|optMnuWDN" dataSource="" vOPT=""></z>
</elements>

</tree>

<tree id="wl" vV="Wui Layout Tree (wl)">
<nodes id="wln" vV="Wui Layout Nodes (wln)" subTypeNames="" subTypeChildNames="" mvValue="0" vC="" adQty="0" adNds="c" oSel="addq0" oOpts="addq0" fileDelTypes="" fileNames="" fileNameTypes="" fileDups="" iFile="" nLink="" nPath="" wpnSetElm="" wgtDefault0="zz.|1|01|0||DocInView" wgtDefault1="" wgtRuleTypes="1|0|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|wgt_name" cssSelectorType="0" cssSelectorNames="" cssDefault0="" uScripts="" siblingIndex="1" sortChildren="false">

<z id="101" vV="WINDOW" subTypeNames="Window" subTypeChildNames="" mvValue="0" vC="" adQty="1" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" fileDelTypes="" fileNames="_iFile|_cFile|_gFile|_hFile" fileNameTypes="rwm|rwm|rwm|rvw" fileDups="_cFile|_gFile" iFile="" nLink="" nPath="" wpnSetElm="win" wgtDefault0="zz.window|1|101|0||window" wgtRuleTypes="1|0|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|wgt_name" cssSelectorType="0" cssSelectorNames="" cssDefault0="" uScripts="101" siblingIndex="1">

<z id="1" vV="HTML" subTypeNames="HTML" subTypeChildNames="" mvValue="0" vC="" adQty="1" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="win" wgtDefault0="zz.html|1|1|0_HtWd100pcMaPaBd0||html" wgtRuleTypes="1|0|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|wgt_name" cssSelectorType="" cssSelectorNames="0" cssDefault0="" siblingIndex="1">

<z id="2" vV="HEAD" subTypeNames="Head" subTypeChildNames="" mvValue="0" vC="" adQty="1" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="win" wgtDefault0="zz.head|1|2|0||head" wgtRuleTypes="1|0|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|wgt_name" cssSelectorType="0" cssSelectorNames="" cssDefault0="" siblingIndex="1"></z>

<z id="3" vV="BODY" subTypeNames="Body" subTypeChildNames="Page" mvValue="0" vC="c" adQty="1" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="body" wgtDefault0="zz.body|1|3|0_boSiBo_HtWd100pcMaPaBd0||body" wgtRuleTypes="1|0|1|1|0|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|wgt_name" cssSelectorType="tagNam" cssSelectorNames="body" cssDefault0="" siblingIndex="2">

<z id="7" vV="Page" subTypeNames="w/Rows|w/Colunms" subTypeChildNames="Row|Column" mvValue="0" vC="c" adQty="1" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="page" wgtDefault0="zz.div|1|7|0_diBo_boSiBo_boOrVe||0|0|1|2|1|Page" wgtDefault1="zz.div|1|7|1_diBo_boSiBo_boOrHo||0|0|1|2|1|Page" wgtRuleTypes="1|0|1|1|0|1|1|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|uni_use_2|uni_use_3|n_bg_border|liq_width|liq_height|wgt_name" cssSelectorType="namElmNum" cssSelectorNames="c" cssDefault0="margin-left:auto;margin-right:auto;width:80%;height:auto;min-height:80%;border:1px solid black" siblingIndex="1" sortChildrenBy="vV">

<z id="4" vV="Box" subTypeNames="w/Rows|w/Colunms" subTypeChildNames="Row|Column" mvValue="1" vC="c"  adQty="u" adNds="p" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="box" wgtDefault0="zz.div|1|4|0_diBo_boSiBo_boOrVe||0|0|1|2|1|Box" wgtDefault1="zz.div|1|4|1_diBo_boSiBo_boOrHo||0|0|1|2|1|Box" wgtRuleTypes="1|0|1|1|0|1|1|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|uni_use_2|uni_use_3|n_bg_border|liq_width|liq_height|wgt_name" cssSelectorType="namElmNum" cssSelectorNames="c" cssDefault0="" siblingIndex="1"></z>

<z id="20" vV="Menu" subTypeNames="w/hMenu|w/vMenu" subTypeChildNames="" mvValue="2" vC="c"  adQty="u" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="mnuBx" wgtDefault0="zz.nav|1|20|0_diBo_boSiBo_poRe_boOrHo||0|0|1|2|1|navBox" wgtDefault1="zz.nav|1|20|1_diBo_boSiBo_poRe_boOrVe||0|0|1|2|1|navBox" wgtRuleTypes="1|0|1|1|0|1|1|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|uni_use_2|uni_use_3|n_bg_border|liq_width|liq_height|wgt_name" cssSelectorType="namElmNum" cssSelectorNames="c" cssDefault0="" siblingIndex="1">

<z id="5" vV="menuItem" subTypeNames="menuItems" subTypeChildNames="" mvValue="0" vC="c|cs|ch|ca" adQty="1" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="mnuItm" wgtDefault0="zz.a|1|5|0_diBo_boSiBo_boOrHo||0|0|2|0|0|1|1|mnuItems" wgtRuleTypes="1|0|1|1|0|1|1|1|1|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|uni_use_2|uni_use_3|n_bg_border|liq_width|liq_height|n_nav_dir|n_nav_srt_lev|wgt_name" cssSelectorType="namElmNum" cssSelectorNames="c|cp|c:hover" cssDefault0="width:auto" siblingIndex="1">

<z id="30" vV="dropMenu" subTypeNames="dropMenu w/Rows|dropMenu w/Colunms" subTypeChildNames="Row|Column" mvValue="0" vC="cx"  adQty="1" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="drpMuBx" wgtDefault0="zz|1|30|0_diBo_boSiBo_boOrVe_ovHi||0|0|1|2|1|dropMenuBx" wgtDefault1="zz.div|1|30|1_diBo_boSiBo_boOrHo_ovHi||0|0|1|2|1|dropMenuBx" wgtRuleTypes="1|0|1|1|0|1|1|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|uni_use_2|uni_use_3|n_bg_border|liq_width|liq_height|wgt_name" cssSelectorType="namElmParNum+1" cssSelectorNames="x" cssDefault0="" siblingIndex="1" sortChildrenBy="vV">


<z id="35" vV="menuItems" subTypeNames="menuItems" subTypeChildNames="" mvValue="0" vC="c|cs|ch|ca" adQty="1" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="drpMuItm" wgtDefault0="zz.a|1|35|0_diBo_boSiBo_boOrHo||0|0|0|2|1|1|1|DrpMuItm" wgtRuleTypes="1|0|1|1|0|1|0|0|0|0|0|0|0|0" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|uni_use_2|uni_use_3|n_bg_border|liq_width|liq_height|n_nav_dir|n_nav_srt_lev|wgt_name" cssSelectorType="namElmParNum" cssSelectorNames="c|cp|c:hover" cssDefault0="" siblingIndex="1"></z>

<z id="34" vV="ScrollBtns" subTypeNames="" subTypeChildNames="" mvValue="0" vC="cScrollBtn" adQty="1" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="drpMuSclBtn" wgtDefault0="zz.div|1|34|0||dropScrollBtns" wgtRuleTypes="1|0|1|1|0|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|wgt_name" cssSelectorType="namElmParNum" cssSelectorNames="cScrollBtn" cssDefault0="" siblingIndex="2"></z>

</z>
</z>
</z>


<z id="50" vV="CrumbBox" subTypeNames="w/hCrumbMenu" subTypeChildNames="" mvValue="2" vC="c"  adQty="u" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="mnuBx" wgtDefault0="zz.div|1|50|0_diBo_boSiBo_boOrHo||0|0|1|2|1|BreadCumbBox" wgtRuleTypes="1|0|1|1|0|1|1|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|uni_use_2|uni_use_3|n_bg_border|liq_width|liq_height|wgt_name" cssSelectorType="namElmNum" cssSelectorNames="c" cssDefault0="" siblingIndex="1">

<z id="55" vV="CrumbItems" subTypeNames="crumbItems" subTypeChildNames="" mvValue="0" vC="c|cs|c:hover|c:active|csep" adQty="1" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="crumbMuItm" wgtDefault0="zz.a|1|55|0_diBo_boSiBo_boOrHo||0|0|0|0|0|1|1|CrumbMenuItem" wgtRuleTypes="1|0|1|1|0|1|1|1|1|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|uni_use_2|uni_use_3|n_bg_border|liq_width|liq_height|n_nav_dir|n_nav_srt_lev|wgt_name" cssSelectorType="namElmNum" cssSelectorNames="c|cb|cb:before|cl|cs|cs:before|ca:hover|ca:active" cssDefault0="" siblingIndex="1"></z>
</z>


<z id="60" vV="SnipitBox" subTypeNames="w/Snipit" subTypeChildNames="" mvValue="2" vC="c"  adQty="u" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="snipitBx" wgtDefault0="zz.div|1|60|0_diBo_boSiBo||0|0|1|2|1|SnipitBox" wgtRuleTypes="1|0|1|1|0|1|1|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|uni_use_2|uni_use_3|n_bg_border|liq_width|liq_height|wgt_name" cssSelectorType="namElmNum" cssSelectorNames="c" cssDefault0="" siblingIndex="1">

<z id="61" vV="SnipitItem" subTypeNames="snipitName" subTypeChildNames="" mvValue="3" vC="c"  adQty="u" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="snipitItm" wgtDefault0="zz|1|61|0|||snipit" wgtRuleTypes="1|0|1|1|0|0|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|uni_use_2|wgt_name" cssSelectorType="namElmNum" cssSelectorNames="c" cssDefault0="" siblingIndex="1"></z>
</z>


<z id="90" vV="ContentBox" subTypeNames="" subTypeChildNames="" mvValue="2" vC="c"  adQty="u" adNds="c" oSel="addq0" oOpts="addq0|delq0|movq0|onoq0" wpnSetElm="genBxContent" wgtDefault0="zz|1|90|0||0|0|1|2|1|contentBox" wgtRuleTypes="1|0|1|1|0|1|1|1|1|1|1" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|uni_use_2|uni_use_3|n_bg_border|liq_width|liq_height|wgt_name" cssSelectorType="namElmNum" cssSelectorNames="cy|cymoz|cm|cb|cz" cssDefault0="" siblingIndex="1"></z>

</z>
</z>
</z>
</z>

<z id="e" vV="error:unknownObject" subTypeNames="error:unknownObject" subTypeChildNames="" mvValue="0" vC="" adQty="0" adNds="" oSel="delq0" oOpts="delq0" wpnSetElm="e" wgtDefault0="zz|0|e|0||error" wgtSelectorNames="wgt_brand|n_on_off|n_type_num|n_sub_type|css_selector|wgt_name" wgtRuleTypes="1|0|1|1|0|1" cssSelectorType="0" cssSelectorNames="" cssDefault0="" siblingIndex="1"></z>
</nodes>

<optcol id="wlo" vV="Wui Layout Options (wlo)" colNames="_Document|_Class" colNvs="node.parent().@sub_type_child_name+node.@sub_type_name|node.@css_selector_number" eElms="">
<z id="addq0" vV="_Add" colNames="~parent" colNvs="~parent" eElms="empty18|sel24|sel0"></z>
<z id="delq0" vV="_Delete" colNames="~parent" colNvs="~parent" eElms="empty18|sel24|inp0"></z>
<z id="movq0" vV="_Move" colNames="~parent" colNvs="~parent" eElms="empty18|sel24|bni1|bni2|bni3|bni4"></z>
<z id="onoq0" vV="_OnOff" colNames="_Document|_OnOff" colNvs="dnTagX.vV|node.@n_on_off" eElms="empty18|sel24|inp1"></z>
</optcol>

<elements id="wle" vV="Wui Layout Elements (wle)" eBF="__" eID="" pIH="__" eFN="" eSZ="" dataSource="" vOPT="">
<z id="sel0" vV="addNode" eBF="Select3" eID="wlnAddElm" pIH="wlnTd4" eFN="wln|addWLN" dataSource="" vOPT=""></z>
<z id="inp0" vV="deleteYes" eBF="InputBtn" eID="" pIH="~sel0" eFN="wln|deleteWLN" vOPT="['_Ok',0,0]" dataSource=""></z>
<z id="inp1" vV="OnOff" eBF="Input3" eID="wlnOnBtnElm" pIH="~sel0" eFN="wln|onOffWLN" vOPT="['_On',0,0]" dataSource="nOnOff"></z>
<z id="bni1" vV="BtnUp" eBF="InputBtn" eID="" pIH="~sel0" eFN="wln|moveWLNup" dataSource="" vOPT="['_Arrow02Up',0,0]"></z>
<z id="bni2" vV="BtnDown" eBF="InputBtn" eID="" pIH="~sel0" eFN="wln|moveWLNdown" dataSource="" vOPT="['_Arrow02Down',0,0]"></z>
<z id="bni3" vV="BtnLeft" eBF="InputBtn" eID="" pIH="~sel0" eFN="wln|moveWLNleft" dataSource="" vOPT="['_Arrow02UpLT',0,0]"></z>
<z id="bni4" vV="BtnRight" eBF="InputBtn" eID="" pIH="~sel0" eFN="wln|moveWLNright" dataSource="" vOPT="['_Arrow02DownRH',0,0]"></z>
<z id="empty17" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="wmbTd2" eFN="" dataSource="" vOPT=""></z>
<z id="empty18" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="wlnTd4" eFN="" dataSource="" vOPT=""></z>
<z id="sel24" vV="treeOptionMenu" eBF="TreeOptionMenu" eID="wlnOptMnuElm" pIH="~sel0" eFN="wln|optMnuWLN" dataSource="" vOPT=""></z>
</elements>

</tree>

<tree id="wp" vV="Wui Properties Tree (wp)">

<nodes id="wpn" vV="Wui Layout Nodes (wpn)" cssRequiredDefault="" cssSelectorName="" adQty="0" mvValue="0" oSel="valq0" oOpts="valq0|addq0" pIDAN="" refSelectorPropName="" refTagIncludes="" cssProperty="" vCT="0" vDPV="" vDV="0" vOPT="" vOPT2="" wordReplace="" wgtSelectorName="">

<set id="refTags">

<z id="0" vV="refBlank"  cssRequiredDefault="" cssSelectorName="" adQty="0" mvValue="0" oSel="__" oOpts="" pIDAN="" cssProperty="" vCT="0" vDPV="" vDV="0" vOPT="" wgtSelectorName=""></z>

<z id="Gen1" vV="_General" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="7" vDV="0" pIDAN="0" mvValue="0" vCT="0" adQty="0" oSel="valq0" oOpts="valq0|addq0" vOPT=""></z>

<z id="On1" vV="_On" refTag="0" wgtSelectorName="n_on_off" cssSelectorName="" vDPV="0" vDV="0" pIDAN="1" adQty="0" mvValue="0" oSel="valqid" oOpts="valqid" vCT="0" vOPT="['NO',0,0],['YES',1,0]"></z>

<z id="Kind1" vV="_Kind" refTag="0" wgtSelectorName="n_type_num" cssSelectorName="" vDPV="0" vDV="0" pIDAN="2" adQty="0" mvValue="0" oSel="valqid" oOpts="valqid|addq0" vCT="0" vOPT=""></z>

<z id="Elm1" vV="_Type" refTag="0" wgtSelectorName="n_sub_type" cssSelectorName="" vDPV="0" vDV="0" pIDAN="3" adQty="0" mvValue="0" oSel="valqid" oOpts="valqid|addq0" vCT="0" vOPT="['Element',0,0]" ></z>

<z id="type1" vV="_Type" refTag="0" wgtSelectorName="n_sub_type" cssSelectorName="" vDPV="1" vDV="0" pIDAN="3" adQty="0" mvValue="0" oSel="valqid" oOpts="valqid|addq0" vCT="0" vOPT="['_wRows','0_diBo_boSiBo_boOrVe',0],['_wColumns','1_diBo_boSiBo_boOrHo',0]"></z>

<z id="type2" vV="_Type" refTag="0" wgtSelectorName="n_sub_type" cssSelectorName="" vDPV="1" vDV="0" pIDAN="3" adQty="0" mvValue="0" oSel="valqid" oOpts="valqid|addq0" vCT="0" vOPT="['_Vertical',0,0],['_Horizontal',1,0]"></z>

<z id="1bgc" vV="_Color" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="" pIDAN="C" adQty="0" mvValue="0" oSel="valqbgc" oOpts="valqbgc|addq0" vCT="0" vOPT="" cssProperty="background"></z>

<z id="2fc" vV="_Color" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="0" pIDAN="C" adQty="0" mvValue="0" oSel="valqbgc" oOpts="valqbgc|addq0" vCT="0" vOPT="" cssProperty="color"></z>

<z id="2ff" vV="_Fonts" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="0" oSel="valqff" oOpts="valqff|addq0" vCT="0" vOPT="" pIDAN="C" adQty="0" mvValue="0" cssProperty="font-family"></z>

<z id="2fs" vV="_Size" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="0" oSel="valqfs" oOpts="valqfs|addq0" vCT="0" vOPT="['%','%',0]" pIDAN="C" adQty="0" mvValue="0" cssProperty="font-size"></z>

<z id="2dc" vV="_Direction" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="ltr" oSel="valqdc" oOpts="valqdc|addq0" vCT="0" vOPT="['_ltr','ltr',0],['_rtl','rtl',0]" pIDAN="C1" adQty="0" mvValue="0" cssProperty="direction"></z>

<z id="txDec1" vV="_Decoration" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="0" oSel="valqdc" oOpts="valqdc|addq0" vCT="0" vOPT="['_none','none',1],['_lineThrough','line-through',2],['_underline','underline',2],['_overline','overline',2]" pIDAN="C1" adQty="0" mvValue="0" cssProperty="text-decoration"></z>

<z id="lineHt1" vV="_lineHeight" refTag="0" cssSelectorName="" vDPV="8" vDV="0" oSel="valqfs" oOpts="valqfs|addq0" vCT="0" vOPT="['%','%',0]" pIDAN="C" adQty="0" mvValue="0" cssProperty="line-height"></z>

<z id="txWrap1" vV="_Wrap" refTag="0" cssSelectorName="" vDPV="8" vDV="0" oSel="valqdc" oOpts="valqdc|addq0" vCT="0" vOPT="['_nowrap','nowrap',0]" pIDAN="C1" adQty="0" mvValue="0" cssProperty="white-space"></z>

<z id="txAlignH1" vV="_AlignHorizontal" refTag="0" cssSelectorName="" vDPV="8" vDV="0" oSel="valqdc" oOpts="valqdc|addq0" vCT="0" vOPT="['_left','left',0],['_center','center',1],['_right','right',2]" pIDAN="C1" adQty="0" mvValue="0" cssProperty="text-align"></z>

<z id="txAlignV1" vV="_AlignVertical" refTag="0" cssSelectorName="" vDPV="8" vDV="0" oSel="valqdc" oOpts="valqdc|addq0" vCT="0" vOPT="['_top','top',0],['_middle','midle',1],['_bottom','bottom',2]" pIDAN="C" adQty="0" mvValue="0" cssProperty="vertical-align"></z>

<z id="marginAlignH1" XXX="NotInUse" vV="_AlignHorizontal" refTag="0" cssSelectorName="cta" vDPV="8" vDV="0" oSel="valqdc" oOpts="valqdc|addq0" vCT="0" vOPT="['_left','left',0],['_center','center',1],['_right','right',2]" pIDAN="C1" adQty="0" mvValue="0" cssProperty="margin"></z>

<z id="BgBdrstyle1" vV="_Style" refTag="0" wgtSelectorName="n_bg_border" cssSelectorName="" vDPV="0" vDV="1" pIDAN="7" adQty="0" mvValue="0" oSel="valqid" oOpts="valqid|addq0" vCT="0" vOPT="[1,1,0]"></z>

<z id="BgBdrstyle2" vV="_Style" refTag="0" wgtSelectorName="n_bg_border" cssSelectorName="" vDPV="1" vDV="1" pIDAN="7" adQty="0" mvValue="0" oSel="valqid" oOpts="valqid|addq0" vCT="0" vOPT="['_tab',0,0],['_full',1,0],['_tubed',2,0]"></z>

<z id="BgBdrimgFdr" vV="_ImageFolder" refTag="0" wgtSelectorName="n_bg_border" cssSelectorName="" vDPV="4" vDV="" pIDAN="7_1" adQty="0" mvValue="0" oSel="valqsnn" oOpts="valqsnn|addq0" vCT="0" vOPT=""></z>

<z id="BgBdr0" vV="_Top" refTag="0" wgtSelectorName="n_bg_border" cssSelectorName="" vDPV="6" vDV="0" pIDAN="7_2_0" adQty="0" mvValue="0" oSel="valqbbi" oOpts="valqbbi|addq0" vCT="0" vOPT="['_n_',0,0],['_Image',1,1]" cssProperty=""></z>
//// none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset
<z id="BdrT" vV="_Top" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="0" pIDAN="C" adQty="0" mvValue="0" oSel="valqbdr" oOpts="valqbdr|addq0" vCT="0" vOPT="['_solid','solid',1],['_dashed','dashed',2],['_dotted','dotted',2],['_double','double',2],['_groove','groove',2],['_hidden','hidden',2],['_inset','inset',2],['_outset','outset',2],['_ridge','ridge',2]" vOPT2="['ex','ex',1],['px','px',0]" cssProperty="border-top" wordReplace="['_transparent','transparent',1],['_solid','solid',1],['_dashed','dashed',2],['_dotted','dotted',2],['_double','double',2],['_groove','groove',2],['_hidden','hidden',2],['_inset','inset',2],['_outset','outset',2],['_ridge','ridge',2]"></z>

<z id="BdcTL" vV="_TopLeft" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="0" oSel="valqbdc" oOpts="valqbdc|addq0" vCT="0" vOPT="['_HorizontalOneLetter','h',0],['_VerticalOneLetter','v',1]" vOPT2="['px','px',0],['ex','ex',1]" pIDAN="C" adQty="0" mvValue="0" refTagIncludes="BorderRadius"></z>

<z id="liqSzWd" vV="_liquidWidth" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="1" vDV="1" pIDAN="8" adQty="0" mvValue="0" oSel="valqid" oOpts="valqid|addq0" vCT="0" vOPT="['_Auto',0,0],['_Min',1,1],['_Max',2,2]"></z>

<z id="munItmSzWd1" vV="_Width" refTag="0" cssSelectorName="" vDPV="8" vDV="0" pIDAN="C" adQty="0" mvValue="0" oSel="valqfs" oOpts="valqfs|addq0" vCT="0" vOPT="['ex','ex',0]" cssProperty="width"></z>

<z id="munItmSzHt1" vV="_Height" refTag="0" cssSelectorName="" vDPV="8" vDV="0" pIDAN="C" adQty="0" mvValue="0" oSel="valqfs" oOpts="valqfs|addq0" vCT="0" vOPT="['ex','ex',0]" cssProperty="height"></z>

<z id="munItmSzWd2" vV="_Width" refTag="0" cssSelectorName="" vDPV="8" vDV="0" pIDAN="C" adQty="0" mvValue="0" oSel="valqfs" oOpts="valqfs|addq0" vCT="0" vOPT="['_auto','auto',0],['ex','ex',1]" cssProperty="width"></z>

<z id="munItmSzHt2" vV="_Height" refTag="0" cssSelectorName="" vDPV="8" vDV="0" pIDAN="C" adQty="0" mvValue="0" oSel="valqfs" oOpts="valqfs|addq0" vCT="0" vOPT="['_auto','auto',0],['ex','ex',1]" cssProperty="height"></z>

<z id="marT" vV="_Top" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="0" oSel="valqfs" oOpts="valqfs|addq0" vCT="0" vOPT="['_auto','auto',3],['ex','ex',1],['px','px',0],['%','%',2]" wordReplace="['_auto','auto',0]" pIDAN="C" adQty="0" mvValue="0" cssProperty="margin-top"></z>

<z id="marPadT" vV="_Top" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="0" oSel="valqfs" oOpts="valqfs|addq0" vCT="0" vOPT="['px','px',0],['ex','ex',1]" pIDAN="C" adQty="0" mvValue="0" cssProperty="padding-top"></z>

<z id="padT" vV="_Top" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="0" oSel="valqfs" oOpts="valqfs|addq0" vCT="0" vOPT="['px','px',0],['ex','ex',1]" pIDAN="C" adQty="0" mvValue="0" cssProperty="padding-top"></z>

<z id="bxSzeWd1" vV="_Width" refTag="0" wgtSelectorName="" cssSelectorName="" vDPV="8" vDV="0" oSel="valqfs" oOpts="valqfs|addq0" vCT="0" vOPT="['_Auto','auto',3],['ex','ex',2],['px','px',1],['%','%',0]" pIDAN="C" adQty="0" mvValue="0" cssProperty="width"></z>

</set>

<set id="e">
<visual id="v">
<cat id="gen" vV="unknown" refTag="Gen1"></cat>
</visual>
<hidden id="h"></hidden>
</set>

<set id="unknown">
<visual id="v">
<cat id="gen" vV="unknown" refTag="Gen1"></cat>
</visual>
<hidden id="h"></hidden>
</set>

<set id="win">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1"></cat>
</visual>
<hidden id="h">
<cat id="gen" vV="_General" refTag="Gen1">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
<z id="type" vV="_Type" refTag="Elm1"></z>
</cat>
</hidden>
</set>


<set id="body">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1">
<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="body"></z>
</gp>
<gp id="tx" vV="_Text" refTag="Gen1">
<z id="algnH" vV="_AlignHorizontal" refTag="txAlignH1" cssSelectorName="body"></z>
<z id="algnV" vV="_AlignVertical" refTag="txAlignV1" cssSelectorName="body"></z>
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="body"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="body"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="body"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="body"></z>
</gp>
</cat>
</visual>
<hidden id="h">
<cat id="gen" vV="_General" refTag="Gen1">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
<z id="setType" vV="_Type" refTag="Elm1"></z>
</cat>
</hidden>
</set> 


<set id="page">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1">

<gp id="set" vV="_Settings" refTag="Gen1">
<z id="type" vV="_Type" refTag="type1"></z>
</gp>

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="c"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="c" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="c" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="c" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="c" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="c" cssProperty="border-left"></z>
</gp>

<gp id="bdc" vV="_BorderCorners" refTag="BdcTL" cssSelectorName="c" cssProperty="border-radius">
<z id="tl" vV="_TopLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-left-radius"></z>
<z id="tr" vV="_TopRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-right-radius"></z>
<z id="br" vV="_BottomRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-right-radius"></z>
<z id="bl" vV="_BottomLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-left-radius"></z>
</gp>

<gp id="bdi" vV="_BorderImage" refTag="0" cssSelectorName="c" vDPV="8" vDV="0" oSel="valqbdi" oOpts="valqbdi|addq0" vOPT="" pIDAN="C" cssProperty="border-image"></gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="c" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="c" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="c" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="c" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="c" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="c" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="c" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="c" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="c" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="c" cssProperty="padding-left"></z>
</gp>

<gp id="sz" vV="_Size" refTag="Gen1">
<z id="ht" vV="_Height" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="height"></z>
<z id="wd" vV="_Width" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="width"></z>
<z id="minht" vV="_minHeight" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="min-height"></z>
<z id="minwd" vV="_minWidth" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="min-width"></z>
<z id="maxht" vV="_maxHeight" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="max-height"></z>
<z id="maxwd" vV="_maxWidth" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="max-width"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="algnH" vV="_AlignHorizontal" refTag="txAlignH1" cssSelectorName="c"></z>
<z id="algnV" vV="_AlignVertical" refTag="txAlignV1" cssSelectorName="c"></z>
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="c"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="c"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="c"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="c"></z>
</gp>
</cat>

</visual>
<hidden id="h">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
<z id="style" vV="_Style" refTag="BgBdrstyle1"></z>
</hidden>
</set>

<set id="box">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1">

<gp id="set" vV="_Settings" refTag="Gen1">
<z id="type" vV="_Type" refTag="type1"></z>
</gp>

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="c"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="c" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="c" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="c" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="c" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="c" cssProperty="border-left"></z>
</gp>

<gp id="bdc" vV="_BorderCorners" refTag="BdcTL" cssSelectorName="c" cssProperty="border-radius">
<z id="tl" vV="_TopLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-left-radius"></z>
<z id="tr" vV="_TopRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-right-radius"></z>
<z id="br" vV="_BottomRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-right-radius"></z>
<z id="bl" vV="_BottomLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-left-radius"></z>
</gp>

<gp id="bdi" vV="_BorderImage" refTag="0" cssSelectorName="c" vDPV="8" vDV="0" oSel="valqbdi" oOpts="valqbdi|addq0" vOPT="" pIDAN="C" cssProperty="border-image"></gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="c" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="c" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="c" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="c" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="c" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="c" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="c" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="c" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="c" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="c" cssProperty="padding-left"></z>
</gp>

<gp id="sz" vV="_Size" refTag="Gen1">
<z id="ht" vV="_Height" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="height"></z>
<z id="wd" vV="_Width" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="width"></z>
<z id="minht" vV="_minHeight" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="min-height"></z>
<z id="minwd" vV="_minWidth" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="min-width"></z>
<z id="maxht" vV="_maxHeight" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="max-height"></z>
<z id="maxwd" vV="_maxWidth" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="max-width"></z>

<z id="liWd" vV="_liquidWidth" refTag="liqSzWd" pIDAN="8" wgtSelectorName="liq_width"></z>
<z id="liHt" vV="_liquidHeight" refTag="liqSzWd" pIDAN="9" wgtSelectorName="liq_height"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="algnH" vV="_AlignHorizontal" refTag="txAlignH1" cssSelectorName="c"></z>
<z id="algnV" vV="_AlignVertical" refTag="txAlignV1" cssSelectorName="c"></z>
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="c"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="c"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="c"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="c"></z>
</gp>
</cat>

</visual>
<hidden id="h">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
<z id="BBstyle" vV="_Style" refTag="BgBdrstyle1"></z>
</hidden>
</set>


<set id="mnuBx">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1">

<gp id="algn" vV="_AlignContent" refTag="Gen1">
<z id="h" vV="_Horizontal" refTag="txAlignH1" refTagIncludes="MozAlign" cssSelectorName="c"></z>
<z id="v" vV="_Vertical" refTag="txAlignV1" refTagIncludes="MozAlign" cssSelectorName="c"></z>
</gp>

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="c"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="c" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="c" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="c" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="c" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="c" cssProperty="border-left"></z>
</gp>

<gp id="bdc" vV="_BorderCorners" refTag="BdcTL" cssSelectorName="c" cssProperty="border-radius">
<z id="tl" vV="_TopLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-left-radius"></z>
<z id="tr" vV="_TopRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-right-radius"></z>
<z id="br" vV="_BottomRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-right-radius"></z>
<z id="bl" vV="_BottomLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-left-radius"></z>
</gp>

<gp id="bdi" vV="_BorderImage" refTag="0" cssSelectorName="c" vDPV="8" vDV="0" oSel="valqbdi" oOpts="valqbdi|addq0" vOPT="" pIDAN="C" cssProperty="border-image"></gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="c" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="c" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="c" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="c" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="c" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="c" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="c" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="c" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="c" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="c" cssProperty="padding-left"></z>
</gp>

<gp id="sz" vV="_Size" refTag="Gen1">
<z id="ht" vV="_Height" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="height"></z>
<z id="wd" vV="_Width" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="width"></z>
<z id="minht" vV="_minHeight" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="min-height"></z>
<z id="minwd" vV="_minWidth" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="min-width"></z>
<z id="maxht" vV="_maxHeight" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="max-height"></z>
<z id="maxwd" vV="_maxWidth" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="max-width"></z>

<z id="liWd" vV="_liquidWidth" refTag="liqSzWd" pIDAN="8" wgtSelectorName="liq_width"></z>
<z id="liHt" vV="_liquidHeight" refTag="liqSzWd" pIDAN="9" wgtSelectorName="liq_height"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="c"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="c"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="c"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="c"></z>
</gp>
</cat>

</visual>
<hidden id="h">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
<z id="type" vV="_Type" refTag="Elm1"></z>
<z id="BBstyle" vV="_Style" refTag="BgBdrstyle1"></z>
</hidden>
</set>


<set id="mnuItm">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1">

<gp id="set" vV="_Settings" refTag="Gen1">
<z id="style" vV="_Style" refTag="BgBdrstyle2"></z>
<z id="type" vV="_Type" refTag="type2" vOPT="['_Vertical',0,0],['_Horizontal',1,0]"></z>
<z id="nd" vV="_UseMenuArray" refTag="0" wgtSelectorName="n_nav_dir" cssSelectorName="" vDPV="10" vDV="1" pIDAN="10" oSel="valqsnn" oOpts="valqsnn|addq0" vOPT="" cssProperty=""></z>
<z id="nsl" vV="_StartMenuAtLevel" refTag="0" wgtSelectorName="n_nav_srt_lev" cssSelectorName="" vDPV="1" vDV="1" pIDAN="11" oSel="valqid" oOpts="valqid|addq0" vOPT="['','',0],[1,1,1],[2,2,2],[3,3,3],[4,4,4],[5,5,5],[6,6,6],[7,7,7],[8,8,8],[9,9,9]"></z>
</gp>

<gp id="algn" vV="_Align" refTag="Gen1">
<z id="menu" vV="_Menu" refTag="0" cssSelectorName="cta" refTagIncludes="MarginAlignHV" refSelectorPropName="ctd" vDPV="8" vDV="0" oSel="valqdc" oOpts="valqdc|addq0" vOPT="['_TopLeft','0px auto 0px 0px',0],['_TopCenter','0px auto 0px auto',1],['_TopRight','0px 0px 0px auto',2],['_MiddleLeft','auto auto auto 0px',3],['_MiddleCenter','auto auto auto auto',4],['_MiddleRight','auto 0px auto auto',5],['_BottomLeft','auto auto 0px 0px',6],['_BottomCenter','auto auto 0px auto',7],['_BottomRight','auto 0px 0px auto',8]" pIDAN="C1" cssProperty="margin"></z>
<z id="muItm" vV="_MenuItems" refTag="0" cssSelectorName="ce" refTagIncludes="MarginAlignHV" refSelectorPropName="cetd" vDPV="8" vDV="0" oSel="valqdc" oOpts="valqdc|addq0" vOPT="['_TopLeft','0px auto 0px 0px',0],['_TopCenter','0px auto 0px auto',1],['_TopRight','0px 0px 0px auto',2],['_MiddleLeft','auto auto auto 0px',3],['_MiddleCenter','auto auto auto auto',4],['_MiddleRight','auto 0px auto auto',5],['_BottomLeft','auto auto 0px 0px',6],['_BottomCenter','auto auto 0px auto',7],['_BottomRight','auto 0px 0px auto',8]" pIDAN="C1" cssProperty="margin"></z>
</gp>

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="c"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="c" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="c" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="c" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="c" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="c" cssProperty="border-left"></z>
</gp>

<gp id="bdc" vV="_BorderCorners" refTag="BdcTL" cssSelectorName="c" cssProperty="border-radius">
<z id="tl" vV="_TopLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-left-radius"></z>
<z id="tr" vV="_TopRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-right-radius"></z>
<z id="br" vV="_BottomRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-right-radius"></z>
<z id="bl" vV="_BottomLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-left-radius"></z>
</gp>

<gp id="bdi" vV="_BorderImage" refTag="0" cssSelectorName="c" vDPV="8" vDV="0" oSel="valqbdi" oOpts="valqbdi|addq0" vOPT="" pIDAN="C" cssProperty="border-image"></gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="c" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="c" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="c" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="c" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="c" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="c" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="c" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="c" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="c" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="c" cssProperty="padding-left"></z>
</gp>

<gp id="sz" vV="_Size" refTag="Gen1">
<z id="ht" vV="_Height" refTag="munItmSzHt1" cssSelectorName="c"></z>
<z id="wd" vV="_Width" refTag="munItmSzWd2" cssSelectorName="c" cssRequiredDefault="auto"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="algnH" vV="_AlignHorizontal" refTag="txAlignH1" cssSelectorName="c"></z>
<z id="algnV" vV="_AlignVertical" refTag="txAlignV1" cssSelectorName="c"></z>
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="c"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="c"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="c"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="c"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="c"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="c"></z>
<z id="wrap" vV="_Wrap" refTag="txWrap1" cssSelectorName="c"></z>
</gp>

</cat>

<cat id="pth" vV="_onPath" refTag="Gen1">

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="cp"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="cp" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="cp" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="cp" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="cp" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="cp" cssProperty="border-left"></z>
</gp>

<gp id="bdc" vV="_BorderCorners" refTag="BdcTL" cssSelectorName="cp" cssProperty="border-radius">
<z id="tl" vV="_TopLeft" refTag="BdcTL" cssSelectorName="cp" cssProperty="border-top-left-radius"></z>
<z id="tr" vV="_TopRight" refTag="BdcTL" cssSelectorName="cp" cssProperty="border-top-right-radius"></z>
<z id="br" vV="_BottomRight" refTag="BdcTL" cssSelectorName="cp" cssProperty="border-bottom-right-radius"></z>
<z id="bl" vV="_BottomLeft" refTag="BdcTL" cssSelectorName="cp" cssProperty="border-bottom-left-radius"></z>
</gp>

<gp id="bdi" vV="_BorderImage" refTag="0" cssSelectorName="cp" vDPV="8" vDV="0" oSel="valqbdi" oOpts="valqbdi|addq0" vOPT="" pIDAN="C" cssProperty="border-image"></gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="cp" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="cp" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="cp" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="cp" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="cp" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="cp" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="cp" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="cp" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="cp" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="cp" cssProperty="padding-left"></z>
</gp>

<gp id="sz" vV="_Size" refTag="Gen1">
<z id="ht" vV="_Height" refTag="munItmSzHt1" cssSelectorName="cp"></z>
<z id="wd" vV="_Width" refTag="munItmSzWd1" cssSelectorName="cp"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="algnH" vV="_AlignHorizontal" refTag="txAlignH1" cssSelectorName="cp"></z>
<z id="algnV" vV="_AlignVertical" refTag="txAlignV1" cssSelectorName="cp"></z>
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="cp"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="cp"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="cp"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="cp"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="cp"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="cp"></z>
<z id="wrap" vV="_Wrap" refTag="txWrap1" cssSelectorName="cp"></z>
</gp>

</cat>

<cat id="hov" vV="_onHover" refTag="Gen1">

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="c:hover"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="c:hover" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="c:hover" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="c:hover" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="c:hover" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="c:hover" cssProperty="border-left"></z>
</gp>

<gp id="bdc" vV="_BorderCorners" refTag="BdcTL" cssSelectorName="c:hover" cssProperty="border-radius">
<z id="tl" vV="_TopLeft" refTag="BdcTL" cssSelectorName="c:hover" cssProperty="border-top-left-radius"></z>
<z id="tr" vV="_TopRight" refTag="BdcTL" cssSelectorName="c:hover" cssProperty="border-top-right-radius"></z>
<z id="br" vV="_BottomRight" refTag="BdcTL" cssSelectorName="c:hover" cssProperty="border-bottom-right-radius"></z>
<z id="bl" vV="_BottomLeft" refTag="BdcTL" cssSelectorName="c:hover" cssProperty="border-bottom-left-radius"></z>
</gp>

<gp id="bdi" vV="_BorderImage" refTag="0" cssSelectorName="c:hover" vDPV="8" vDV="0" oSel="valqbdi" oOpts="valqbdi|addq0" vOPT="" pIDAN="C" cssProperty="border-image"></gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="c:hover" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="c:hover" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="c:hover" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="c:hover" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="c:hover" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="c:hover" cssProperty="padding-left"></z>
</gp>

<gp id="sz" vV="_Size" refTag="Gen1">
<z id="ht" vV="_Height" refTag="munItmSzHt1" cssSelectorName="c:hover"></z>
<z id="wd" vV="_Width" refTag="munItmSzWd1" cssSelectorName="c:hover"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="algnH" vV="_AlignHorizontal" refTag="txAlignH1" cssSelectorName="c:hover"></z>
<z id="algnV" vV="_AlignVertical" refTag="txAlignV1" cssSelectorName="c:hover"></z>
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="c:hover"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="c:hover"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="c:hover"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="c:hover"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="c:hover"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="c:hover"></z>
<z id="wrap" vV="_Wrap" refTag="txWrap1" cssSelectorName="c:hover"></z>
</gp>

</cat>
</visual>
<hidden id="h">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
</hidden>
</set>


<set id="drpMuBx">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1">

<gp id="algn" vV="_AlignContent" refTag="Gen1">
<z id="h" vV="_Horizontal" refTag="txAlignH1" refTagIncludes="MozAlign" cssSelectorName="x"></z>
<z id="v" vV="_Vertical" refTag="txAlignV1" refTagIncludes="MozAlign" cssSelectorName="x"></z>
</gp>

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="x"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="x" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="x" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="x" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="x" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="x" cssProperty="border-left"></z>
</gp>

<gp id="bdc" vV="_BorderCorners" refTag="BdcTL" cssSelectorName="x" cssProperty="border-radius">
<z id="tl" vV="_TopLeft" refTag="BdcTL" cssSelectorName="x" cssProperty="border-top-left-radius"></z>
<z id="tr" vV="_TopRight" refTag="BdcTL" cssSelectorName="x" cssProperty="border-top-right-radius"></z>
<z id="br" vV="_BottomRight" refTag="BdcTL" cssSelectorName="x" cssProperty="border-bottom-right-radius"></z>
<z id="bl" vV="_BottomLeft" refTag="BdcTL" cssSelectorName="x" cssProperty="border-bottom-left-radius"></z>
</gp>

<gp id="bdi" vV="_BorderImage" refTag="0" cssSelectorName="x" vDPV="8" vDV="0" oSel="valqbdi" oOpts="valqbdi|addq0" vOPT="" pIDAN="C" cssProperty="border-image"></gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="x" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="x" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="x" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="x" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="x" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="x" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="x" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="x" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="x" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="x" cssProperty="padding-left"></z>
</gp>

<gp id="sz" vV="_Size" refTag="Gen1">
<z id="ht" vV="_Height" refTag="bxSzeWd1" cssSelectorName="x" cssProperty="height"></z>
<z id="wd" vV="_Width" refTag="bxSzeWd1" cssSelectorName="x" cssProperty="width"></z>
<z id="minht" vV="_minHeight" refTag="bxSzeWd1" cssSelectorName="x" cssProperty="min-height"></z>
<z id="minwd" vV="_minWidth" refTag="bxSzeWd1" cssSelectorName="x" cssProperty="min-width"></z>
<z id="maxht" vV="_maxHeight" refTag="bxSzeWd1" cssSelectorName="x" cssProperty="max-height"></z>
<z id="maxwd" vV="_maxWidth" refTag="bxSzeWd1" cssSelectorName="x" cssProperty="max-width"></z>

<z id="liWd" vV="_liquidWidth" refTag="liqSzWd" pIDAN="8" wgtSelectorName="liq_width"></z>
<z id="liHt" vV="_liquidHeight" refTag="liqSzWd" pIDAN="9" wgtSelectorName="liq_height"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="x"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="x"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="x"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="x"></z>
</gp>
</cat>

</visual>
<hidden id="h">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
<z id="type" vV="_Type" refTag="Elm1"></z>
<z id="BBstyle" vV="_Style" refTag="BgBdrstyle1"></z>
</hidden>
</set>


<set id="drpMuItm">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1">

<gp id="set" vV="_Settings" refTag="Gen1">
<z id="style" vV="_Style" refTag="BgBdrstyle2"></z>
<z id="type" vV="_Type" refTag="type2" vOPT="['_Vertical',0,0],['_Horizontal',1,0]"></z>
<z id="nd" vV="_UseMenuArray" refTag="0" wgtSelectorName="n_nav_dir" cssSelectorName="" vDPV="10" vDV="1" pIDAN="10" oSel="valqsnn" oOpts="valqsnn|addq0" vOPT="" cssProperty=""></z>
<z id="nsl" vV="_StartMenuAtLevel" refTag="0" wgtSelectorName="n_nav_srt_lev" cssSelectorName="" vDPV="1" vDV="1" pIDAN="11" oSel="valqid" oOpts="valqid|addq0" vOPT="['','',0],[1,1,1],[2,2,2],[3,3,3],[4,4,4],[5,5,5],[6,6,6],[7,7,7],[8,8,8],[9,9,9]"></z>
</gp>

<gp id="algn" vV="_AlignMenuItems" refTag="Gen1">
<z id="h" vV="_Horizontal" refTag="txAlignH1" cssSelectorName="cy"></z>
<z id="v" vV="_Vertical" refTag="txAlignV1" cssSelectorName="cy"></z>
</gp>

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="c"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="c" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="c" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="c" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="c" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="c" cssProperty="border-left"></z>
</gp>

<gp id="bdc" vV="_BorderCorners" refTag="BdcTL" cssSelectorName="c" cssProperty="border-radius">
<z id="tl" vV="_TopLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-left-radius"></z>
<z id="tr" vV="_TopRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-right-radius"></z>
<z id="br" vV="_BottomRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-right-radius"></z>
<z id="bl" vV="_BottomLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-left-radius"></z>
</gp>

<gp id="bdi" vV="_BorderImage" refTag="0" cssSelectorName="c" vDPV="8" vDV="0" oSel="valqbdi" oOpts="valqbdi|addq0" vOPT="" pIDAN="C" cssProperty="border-image"></gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="c" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="c" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="c" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="c" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="c" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="c" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="c" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="c" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="c" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="c" cssProperty="padding-left"></z>
</gp>

<gp id="sz" vV="_Size" refTag="Gen1">
<z id="ht" vV="_Height" refTag="munItmSzHt1" cssSelectorName="c"></z>
<z id="wd" vV="_Width" refTag="munItmSzWd1" cssSelectorName="c"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="algnH" vV="_AlignHorizontal" refTag="txAlignH1" cssSelectorName="c"></z>
<z id="algnV" vV="_AlignVertical" refTag="txAlignV1" cssSelectorName="c"></z>
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="c"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="c"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="c"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="c"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="c"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="c"></z>
<z id="wrap" vV="_Wrap" refTag="txWrap1" cssSelectorName="c"></z>
</gp>

</cat>

<cat id="pth" vV="_onPath" refTag="Gen1">

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="cp"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="cp" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="cp" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="cp" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="cp" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="cp" cssProperty="border-left"></z>
</gp>

<gp id="bdc" vV="_BorderCorners" refTag="BdcTL" cssSelectorName="cp" cssProperty="border-radius">
<z id="tl" vV="_TopLeft" refTag="BdcTL" cssSelectorName="cp" cssProperty="border-top-left-radius"></z>
<z id="tr" vV="_TopRight" refTag="BdcTL" cssSelectorName="cp" cssProperty="border-top-right-radius"></z>
<z id="br" vV="_BottomRight" refTag="BdcTL" cssSelectorName="cp" cssProperty="border-bottom-right-radius"></z>
<z id="bl" vV="_BottomLeft" refTag="BdcTL" cssSelectorName="cp" cssProperty="border-bottom-left-radius"></z>
</gp>

<gp id="bdi" vV="_BorderImage" refTag="0" cssSelectorName="cp" vDPV="8" vDV="0" oSel="valqbdi" oOpts="valqbdi|addq0" vOPT="" pIDAN="C" cssProperty="border-image"></gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="cp" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="cp" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="cp" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="cp" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="cp" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="cp" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="cp" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="cp" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="cp" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="cp" cssProperty="padding-left"></z>
</gp>

<gp id="sz" vV="_Size" refTag="Gen1">
<z id="ht" vV="_Height" refTag="munItmSzHt1" cssSelectorName="cp"></z>
<z id="wd" vV="_Width" refTag="munItmSzWd1" cssSelectorName="cp"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="algnH" vV="_AlignHorizontal" refTag="txAlignH1" cssSelectorName="cp"></z>
<z id="algnV" vV="_AlignVertical" refTag="txAlignV1" cssSelectorName="cp"></z>
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="cp"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="cp"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="cp"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="cp"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="cp"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="cp"></z>
<z id="wrap" vV="_Wrap" refTag="txWrap1" cssSelectorName="cp"></z>
</gp>
</cat>

<cat id="hov" vV="_onHover" refTag="Gen1">

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="c:hover"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="c:hover" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="c:hover" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="c:hover" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="c:hover" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="c:hover" cssProperty="border-left"></z>
</gp>

<gp id="bdc" vV="_BorderCorners" refTag="BdcTL" cssSelectorName="c:hover" cssProperty="border-radius">
<z id="tl" vV="_TopLeft" refTag="BdcTL" cssSelectorName="c:hover" cssProperty="border-top-left-radius"></z>
<z id="tr" vV="_TopRight" refTag="BdcTL" cssSelectorName="c:hover" cssProperty="border-top-right-radius"></z>
<z id="br" vV="_BottomRight" refTag="BdcTL" cssSelectorName="c:hover" cssProperty="border-bottom-right-radius"></z>
<z id="bl" vV="_BottomLeft" refTag="BdcTL" cssSelectorName="c:hover" cssProperty="border-bottom-left-radius"></z>
</gp>

<gp id="bdi" vV="_BorderImage" refTag="0" cssSelectorName="c:hover" vDPV="8" vDV="0" oSel="valqbdi" oOpts="valqbdi|addq0" vOPT="" pIDAN="C" cssProperty="border-image"></gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="c:hover" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="c:hover" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="c:hover" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="c:hover" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="c:hover" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="c:hover" cssProperty="padding-left"></z>
</gp>

<gp id="sz" vV="_Size" refTag="Gen1">
<z id="ht" vV="_Height" refTag="munItmSzHt1" cssSelectorName="c:hover"></z>
<z id="wd" vV="_Width" refTag="munItmSzWd1" cssSelectorName="c:hover"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="algnH" vV="_AlignHorizontal" refTag="txAlignH1" cssSelectorName="c:hover"></z>
<z id="algnV" vV="_AlignVertical" refTag="txAlignV1" cssSelectorName="c:hover"></z>
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="c:hover"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="c:hover"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="c:hover"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="c:hover"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="c:hover"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="c:hover"></z>
<z id="wrap" vV="_Wrap" refTag="txWrap1" cssSelectorName="c:hover"></z>
</gp>
</cat>

</visual>
<hidden id="h">
<gp id="gen" vV="_General" refTag="Gen1">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
</gp>
</hidden>
</set>


<set id="drpMuSclBtn">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1">

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="cScrollBtn"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="cScrollBtn" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="cScrollBtn" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="cScrollBtn" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="cScrollBtn" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="cScrollBtn" cssProperty="border-left"></z>
</gp>

<gp id="marpad" vV="_MarginPadding" refTag="marPadT" cssSelectorName="cScrollBtn" cssProperty="padding">
<z id="t" vV="_Top" refTag="marPadT" cssSelectorName="cScrollBtn" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="marPadT" cssSelectorName="cScrollBtn" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="marPadT" cssSelectorName="cScrollBtn" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="marPadT" cssSelectorName="cScrollBtn" cssProperty="padding-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="cScrollBtn" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="cScrollBtn" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="cScrollBtn" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="cScrollBtn" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="cScrollBtn" cssProperty="padding-left"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="algnH" vV="_AlignHorizontal" refTag="txAlignH1" cssSelectorName="cScrollBtn"></z>
<z id="algnV" vV="_AlignVertical" refTag="txAlignV1" cssSelectorName="cScrollBtn"></z>
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="cScrollBtn"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="cScrollBtn"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="cScrollBtn"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="cScrollBtn"></z>
</gp>
</cat>

</visual>
<hidden id="h">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
<z id="type" vV="_Type" refTag="Elm1"></z>
</hidden>
</set>


<set id="crumbMuItm">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1">

<gp id="set" vV="_Settings" refTag="Gen1">
<z id="type" vV="_Type" refTag="type2" vOPT="['_Horizontal',0,0],['_Vertical',1,0]"></z>
<z id="nd" vV="_NavDirectory" refTag="0" wgtSelectorName="n_nav_dir" cssSelectorName="" vDPV="1" vDV="1" pIDAN="10" oSel="valqid" oOpts="valqid|addq0" vOPT="['_None',0,0,],['_Site',1,1],['_Custom',2,1]" cssProperty=""></z>
<z id="nsl" vV="_NavStartLevel" refTag="0" wgtSelectorName="n_nav_srt_lev" cssSelectorName="" vDPV="1" vDV="1" pIDAN="11" oSel="valqid" oOpts="valqid|addq0" vOPT="['','',0],[1,1,1],[2,2,2],[3,3,3],[4,4,4],[5,5,5],[6,6,6],[7,7,7],[8,8,8],[9,9,9]"></z>
</gp>

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="c"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="c" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="c" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="c" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="c" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="c" cssProperty="border-left"></z>
</gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="c" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="c" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="c" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="c" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="c" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="c" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="c" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="c" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="c" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="c" cssProperty="padding-left"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="c"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="c"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="c"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="c"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="c"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="c"></z>
</gp>
</cat>

<cat id="bef" vV="_BeforeCrumbs" refTag="Gen1">

<gp id="set" vV="_Settings" refTag="Gen1">
<z id="strtWd" vV="_StartingWord" refTag="0" wgtSelectorName="" cssSelectorName="cb:before" vDPV="0" vDV="0" pIDAN="C2" adQty="0" mvValue="0" oSel="valqwrd" oOpts="valqwrd|addq0" vCT="0" vOPT="['_LocationWithColon','_LocationWithColon',0],['_YouAreHere','_YouAreHere',0]" cssProperty="content" wordReplace="['I','|',0]"></z>
</gp>

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="cb"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="cb" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="cb" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="cb" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="cb" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="cb" cssProperty="border-left"></z>
</gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="cb" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="cb" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="cb" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="cb" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="cb" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="cb" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="cb" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="cb" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="cb" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="cb" cssProperty="padding-left"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="cb"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="cb"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="cb"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="cb"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="cb"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="cb"></z>
</gp>
</cat>


<cat id="lst" vV="_LastCrumb" refTag="Gen1">

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="cl"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="cl" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="cl" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="cl" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="cl" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="cl" cssProperty="border-left"></z>
</gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="cl" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="cl" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="cl" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="cl" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="cl" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="cl" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="cl" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="cl" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="cl" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="cl" cssProperty="padding-left"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="cl"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="cl"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="cl"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="cl"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="cl"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="cl"></z>
</gp>
</cat>


<cat id="act" vV="_onClick" refTag="Gen1">
<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="ca:active"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="ca:active" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="ca:active" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="ca:active" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="ca:active" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="ca:active" cssProperty="border-left"></z>
</gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="ca:active" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="ca:active" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="ca:active" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="ca:active" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="ca:active" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="ca:active" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="ca:active" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="ca:active" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="ca:active" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="ca:active" cssProperty="padding-left"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="ca:active"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="ca:active"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="ca:active"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="ca:active"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="ca:active"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="ca:active"></z>
</gp>
</cat>


<cat id="hov" vV="_onHover" refTag="Gen1">
<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="ca:hover"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="ca:hover" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="ca:hover" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="ca:hover" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="ca:hover" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="ca:hover" cssProperty="border-left"></z>
</gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="c:hover" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="c:hover" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="ca:hover" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="ca:hover" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="ca:hover" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="ca:hover" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="ca:hover" cssProperty="padding-left"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="ca:hover"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="ca:hover"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="ca:hover"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="ca:hover"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="ca:hover"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="ca:hover"></z>
</gp>
</cat>

<cat id="sep" vV="_Seperator" refTag="Gen1">

<gp id="set" vV="_Settings" refTag="Gen1">
<z id="div" vV="_Divider" refTag="0" wgtSelectorName="" cssSelectorName="cs:before" vDPV="0" vDV="0" pIDAN="C2" adQty="0" mvValue="0" oSel="valqdvr" oOpts="valqdvr|addq0" vCT="0" vOPT="[':',':',0],['>','>',0],['<','<',0],['/','/',0],['\\','\\',0],['I','|',0],['»','»',0],['«','«',0]" cssProperty="content" wordReplace="['I','|',0]"></z>
</gp>

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="cs"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="cs" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="cs" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="cs" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="cs" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="cs" cssProperty="border-left"></z>
</gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="cs" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="cs" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="cs" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="cs" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="cs" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="cs" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="cs" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="cs" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="cs" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="cs" cssProperty="padding-left"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="cs"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="cs"></z>
<z id="dec" vV="_Decoration" refTag="txDec1" cssSelectorName="cs"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="cs"></z>
<z id="lh" vV="_lineHeight" refTag="lineHt1" cssSelectorName="cs"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="cs"></z>
</gp>
</cat>

</visual>
<hidden id="h">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
</hidden>
</set>


<set id="snipitBx">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1">

<gp id="algn" vV="_AlignContent" refTag="Gen1">
<z id="h" vV="_Horizontal" refTag="txAlignH1" refTagIncludes="MozAlign" cssSelectorName="c"></z>
<z id="v" vV="_Vertical" refTag="txAlignV1" refTagIncludes="MozAlign" cssSelectorName="c"></z>
</gp>

<gp id="bg" vV="_Background" refTag="Gen1">
<z id="c" vV="_Color" refTag="1bgc" cssSelectorName="c"></z>
</gp>

<gp id="bdr" vV="_Borders" refTag="BdrT" cssSelectorName="c" cssProperty="border">
<z id="t" vV="_Top" refTag="BdrT" cssSelectorName="c" cssProperty="border-top"></z>
<z id="b" vV="_Bottom" refTag="BdrT" cssSelectorName="c" cssProperty="border-bottom"></z>
<z id="r" vV="_Right" refTag="BdrT" cssSelectorName="c" cssProperty="border-right"></z>
<z id="l" vV="_Left" refTag="BdrT" cssSelectorName="c" cssProperty="border-left"></z>
</gp>

<gp id="bdc" vV="_BorderCorners" refTag="BdcTL" cssSelectorName="c" cssProperty="border-radius">
<z id="tl" vV="_TopLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-left-radius"></z>
<z id="tr" vV="_TopRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-top-right-radius"></z>
<z id="br" vV="_BottomRight" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-right-radius"></z>
<z id="bl" vV="_BottomLeft" refTag="BdcTL" cssSelectorName="c" cssProperty="border-bottom-left-radius"></z>
</gp>

<gp id="bdi" vV="_BorderImage" refTag="0" cssSelectorName="c" vDPV="8" vDV="0" oSel="valqbdi" oOpts="valqbdi|addq0" vOPT="" pIDAN="C" cssProperty="border-image"></gp>

<gp id="mar" vV="_Margin" refTag="marT" cssSelectorName="c" cssProperty="margin">
<z id="t" vV="_Top" refTag="marT" cssSelectorName="c" cssProperty="margin-top"></z>
<z id="r" vV="_Right" refTag="marT" cssSelectorName="c" cssProperty="margin-right"></z>
<z id="b" vV="_Bottom" refTag="marT" cssSelectorName="c" cssProperty="margin-bottom"></z>
<z id="l" vV="_Left" refTag="marT" cssSelectorName="c" cssProperty="margin-left"></z>
</gp>

<gp id="pad" vV="_Padding" refTag="padT" cssSelectorName="c" cssProperty="padding">
<z id="t" vV="_Top" refTag="padT" cssSelectorName="c" cssProperty="padding-top"></z>
<z id="r" vV="_Right" refTag="padT" cssSelectorName="c" cssProperty="padding-right"></z>
<z id="b" vV="_Bottom" refTag="padT" cssSelectorName="c" cssProperty="padding-bottom"></z>
<z id="l" vV="_Left" refTag="padT" cssSelectorName="c" cssProperty="padding-left"></z>
</gp>

<gp id="sz" vV="_Size" refTag="Gen1">
<z id="ht" vV="_Height" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="height"></z>
<z id="wd" vV="_Width" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="width"></z>
<z id="minht" vV="_minHeight" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="min-height"></z>
<z id="minwd" vV="_minWidth" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="min-width"></z>
<z id="maxht" vV="_maxHeight" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="max-height"></z>
<z id="maxwd" vV="_maxWidth" refTag="bxSzeWd1" cssSelectorName="c" cssProperty="max-width"></z>

<z id="liWd" vV="_liquidWidth" refTag="liqSzWd" pIDAN="8" wgtSelectorName="liq_width"></z>
<z id="liHt" vV="_liquidHeight" refTag="liqSzWd" pIDAN="9" wgtSelectorName="liq_height"></z>
</gp>

<gp id="tx" vV="_Text" refTag="Gen1">
<z id="fc" vV="_Color" refTag="2fc" cssSelectorName="c"></z>
<z id="ff" vV="_Fonts" refTag="2ff" cssSelectorName="c"></z>
<z id="fs" vV="_Size" refTag="2fs" cssSelectorName="c"></z>
<z id="dc" vV="_Direction" refTag="2dc" cssSelectorName="c"></z>
</gp>
</cat>

</visual>
<hidden id="h">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
<z id="type" vV="_Type" refTag="Elm1"></z>
<z id="BBstyle" vV="_Style" refTag="BgBdrstyle1"></z>
</hidden>
</set>

<set id="snipitItm">
<visual id="v">
<cat id="gen" vV="_General" refTag="Gen1">

<gp id="set" vV="_Settings" refTag="Gen1">
<z id="use" vV="_UseSnipit" refTag="0" wgtSelectorName="uni_use_2" cssSelectorName="" vDPV="5" vDV="" pIDAN="4" oSel="valqsnn" oOpts="valqsnn|addq0" vOPT="" cssProperty=""></z>
</gp>
<gp id="algn" vV="_Align" refTag="Gen1">
<z id="HV" vV="_SnipitItem" refTag="0" cssSelectorName="cta" refTagIncludes="MarginAlignHV" refSelectorPropName="ctd" vDPV="8" vDV="0" oSel="valqdc" oOpts="valqdc|addq0" vOPT="['_TopLeft','0px auto 0px 0px',0],['_TopCenter','0px auto 0px auto',1],['_TopRight','0px 0px 0px auto',2],['_MiddleLeft','auto auto auto 0px',3],['_MiddleCenter','auto auto auto auto',4],['_MiddleRight','auto 0px auto auto',5],['_BottomLeft','auto auto 0px 0px',6],['_BottomCenter','auto auto 0px auto',7],['_BottomRight','auto 0px 0px auto',8]" pIDAN="C1" cssProperty="margin"></z>
</gp>

</cat>
</visual>
<hidden id="h">
<z id="on" vV="_On" refTag="On1"></z>
<z id="kind" vV="_Kind" refTag="Kind1"></z>
</hidden>
</set>

</nodes>
<optcol id="wpo" vV="Wui Properties Options (wpo)" colNames="_All|_Properties" colNvs="node.@n_name|node.@viewable_value" eElms="">
<z id="addq0" vV="_Add" colNames="~parent" colNvs="~parent" eElms="empty20|sel0"></z>
<z id="onoq0" vV="_OnOff" colNames="_All|_OnOff" colNvs="node.@n_name|node.@n_on_off" eElms="empty20"></z>
<z id="valq0" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20"></z>
<z id="valqid" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|sel7"></z>
<z id="valqbgc" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|elmBr|inp5|inp6|elmBr|inp18|inp7"></z>
<z id="valqdc" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|sel9"></z>
<z id="valqff" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|elmBr|sel10|elmBr|inp19|inp12"></z>
<z id="valqfs" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|elmBr|inp10|elmBr|inp20|inp11"></z>
<z id="valqbdc" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|bdrcorner|elmBr|inp17|inp22"></z>
<z id="valqma" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|mix1|inp8|inp9"></z>
<z id="valqsnn" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|selsnn"></z>
<z id="valqbdi" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|mixbdi"></z>
<z id="valqbdr" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|mixbdr|elmBr|inp24|inp25"></z>
<z id="valqbbi" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|mixbbi"></z>
<z id="valqdvr" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|seldvdr"></z>
<z id="valqwrd" vV="_Value" colNames="~parent" colNvs="~parent" eElms="empty20|elmBr|sel15|elmBr|inp21|inp16"></z>
</optcol>

<elements id="wpe" vV="Wui Properties Elements (wpe)" eBF="__" eID="" pIH="__" eFN="" eSZ="" dataSource="" vOPT="">
<z id="sel0" vV="addNode" eBF="Select3" eID="wpnSubType" pIH="wpnTd4" eFN="wpn|wpnSubType" dataSource="" vOPT=""></z>
<z id="elmBr" vV="elmBr" eBF="OpenElm" eID="" pIH="~sel0" eFN="" dataSource="" vOPT="['br',0,0]"></z>
<z id="sel7" vV="Type" eBF="Select7" eID="selMenu0" pIH="~sel0" eFN="wpn|saveWpn|2,0,0,1" dataSource="" vOPT=""></z>
<z id="sel8" vV="Type" eBF="Select8" eID="selMenu0" pIH="~sel0" eFN="wpn|saveWpn|2,0,0,1" dataSource="" vOPT=""></z>
<z id="sel9" vV="Dc" eBF="Select9" eID="selMenu0" pIH="~sel0" eFN="wpn|saveWpn|1,0,0,1" dataSource="" vOPT=""></z>
<z id="sel10" vV="Ff" eBF="SelectFf" eID="selMenu0" pIH="~sel0" eFN="wpn|saveWpn|4,0,1,1" dataSource="" vOPT=""></z>
<z id="inp5" vV="colorSwatch" eBF="InputColorCss" eID="colorswatch0" pIH="~sel0" eFN="wpn|saveWpn|3,1,1,0" dataSource="" eSZ="auto" vOPT=""></z>
<z id="inp6" vV="textField0" eBF="InputTextCss" eID="textfield0" pIH="~sel0" eFN="" dataSource="" eSZ="10" vOPT=""></z>
<z id="inp7" vV="btnField0" eBF="InputBtn" eID="btnfield0" pIH="~sel0" eFN="wpn|saveWpn|3,1,1,0" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp8" vV="btnClearMa" eBF="InputBtn" eID="btn0" pIH="~sel0" eFN="wpn|saveWpn|9,0,4,4" dataSource="" vOPT="['_Clear',0,0]"></z>
<z id="inp9" vV="btnField0" eBF="InputBtn" eID="btnfield0" pIH="~sel0" eFN="wpn|saveWpn|9,0,4,4" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp10" vV="MixedFs" eBF="MixedFsCss" eID="" pIH="~sel0" eFN="" dataSource="" vOPT="" eSZ=""></z>
<z id="inp11" vV="btnField0" eBF="InputBtn" eID="btnfield0" pIH="~sel0" eFN="wpn|saveWpn|5,0,1,1" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp12" vV="btnField0Ff" eBF="InputBtn" eID="btnfield0" pIH="~sel0" eFN="wpn|saveWpn|4,0,1,1" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="mix1" vV="MixedMa" eBF="MixedMaCss" eID="" pIH="~sel0" eFN="" dataSource="" vOPT=""></z>

<z id="bdrcorner" vV="MixedCorner" eBF="MixedCornerRadCss" eID="" pIH="~sel0" eFN="wpn|saveWpn|10,0,2,2" dataSource="" vOPT=""></z>

<z id="selsnn" vV="SnipBdrImgMnuArrays" eBF="SelectNameSet" eID="selMenu0" pIH="~sel0" eFN="wpn|saveWpn|7,0,0,1" dataSource="" vOPT=""></z>

<z id="mixbbi" vV="MixedBbi" eBF="SelectBGB" eID="selMenu0" pIH="~sel0" eFN="wpn|saveWpn|12,0,0,1" dataSource="" vOPT=""></z>

<z id="mixbdi" vV="MixedBdi" eBF="SelectBdi" eID="" pIH="~sel0" eFN="wpn|saveWpn|0,1,2,3" dataSource="" vOPT=""></z>

<z id="mixbdr" vV="MixedBdr" eBF="SelectBdr" eID="" pIH="~sel0" eFN="wpn|saveWpn|8,1,2,2" dataSource="" vOPT=""></z>

<z id="seldvdr" vV="Divider" eBF="SelectDvdr" eID="selMenu0" pIH="~sel0" eFN="wpn|saveWpn|14,0,0,1" dataSource="" vOPT=""></z>

<z id="sel15" vV="EditableSelect" eBF="Select15" eID="selMenu0" pIH="~sel0" eFN="wpn|saveWpn|14,0,1,1" dataSource="" vOPT=""></z>

<z id="inp16" vV="btnEditableSelect" eBF="InputBtn" eID="btnfield0" pIH="~sel0" eFN="wpn|saveWpn|14,0,1,1" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp17" vV="btnClearBdrcorner" eBF="InputBtn" eID="btn0" pIH="~sel0" eFN="wpn|saveWpn|10,0,2,2" dataSource="" vOPT="['_Clear',0,0]"></z>
<z id="inp18" vV="btnClearColor" eBF="InputBtn" eID="btn0" pIH="~sel0" eFN="wpn|saveWpn|3,1,1,0" dataSource="" vOPT="['_Clear',0,0]"></z>
<z id="inp19" vV="btnClearFont" eBF="InputBtn" eID="btn0" pIH="~sel0" eFN="wpn|saveWpn|4,0,1,1" dataSource="" vOPT="['_Clear',0,0]"></z>
<z id="inp20" vV="btnClearSize" eBF="InputBtn" eID="btn0" pIH="~sel0" eFN="wpn|saveWpn|5,0,1,1" dataSource="" vOPT="['_Clear',0,0]"></z>
<z id="inp21" vV="befCrmbWrd" eBF="InputBtn" eID="btn0" pIH="~sel0" eFN="wpn|saveWpn|14,0,1,1" dataSource="" vOPT="['_Clear',0,0]"></z>
<z id="inp22" vV="btnOkBdrcorner" eBF="InputBtn" eID="btnfield0" pIH="~sel0" eFN="wpn|saveWpn|10,0,2,2" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="inp24" vV="btnClearBdr" eBF="InputBtn" eID="btn0" pIH="~sel0" eFN="wpn|saveWpn|8,1,2,2" dataSource="" vOPT="['_Clear',0,0]"></z>
<z id="inp25" vV="btnOkBdr" eBF="InputBtn" eID="btnfield0" pIH="~sel0" eFN="wpn|saveWpn|8,1,2,2" dataSource="" vOPT="['_Ok',0,0]"></z>
<z id="empty19" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="wmbTd2" eFN="" dataSource="" vOPT=""></z>
<z id="empty20" vV="EmptyLocation" eBF="EmptyLocation" eID="" pIH="wpnTd4" eFN="" dataSource="" vOPT=""></z>
<z id="sel25" vV="treeOptionMenu" eBF="TreeOptionMenu" eID="wpnOptMnuElm" pIH="~sel0" eFN="wpn|optMnuWPN" dataSource="" vOPT=""></z>

</elements>

</tree>
</lib>
</float>
</ss>
;

function catg_InFo(){}//this is here so I can just jump to it 
const catg ={
bdn:{a:"b",b:"d",c:"n",pF:"bdn",pE:"bde",pO:"bdo",pM:"bmb"},
bln:{a:"b",b:"l",c:"n",pF:"bln",pE:"ble",pO:"blo"},
bpn:{a:"b",b:"p",c:"n",pF:"bpn",pE:"bpe",pO:"bpo"},
idn:{ a:"i",b:"d",c:"n",pF:"idn",pE:"ide",pO:"ido",pM:"imb"},
jdn:{ a:"j",b:"d",c:"n",pF:"jdn",pE:"jde",pO:"jdo",pM:"jmb"},
mdn:{a:"m",b:"d",c:"n",pF:"mdn",pE:"mde",pO:"mdo",pM:"mmb"},
ndn:{a:"n",b:"d",c:"n",pF:"ndn",pE:"nde",pO:"ndo",pM:"nmb"},
pdn:{a:"p",b:"d",c:"n",pF:"pdn",pE:"pde",pO:"pdo",pM:"pmb"},
sdn:{a:"s",b:"d",c:"n",pF:"sdn",pE:"sde",pO:"sdo",pM:"smb"},
tdn:{a:"t",b:"d",c:"n",pF:"tdn",pE:"tde",pO:"tdo",pM:"tmb"},
/*video*/
vdn:{a:"v",b:"d",c:"n",pF:"vdn",pE:"vde",pO:"vdo",pM:"vmb"},
vln:{a:"v",b:"l",c:"n",pF:"vln",pE:"vle",pO:"vlo"},
vpn:{a:"v",b:"p",c:"n",pF:"vpn",pE:"vpe",pO:"vpo"},
/*pages*/
wdf:{a:"w",b:"d",c:"f",pF:"wdf",pE:"",pO:"",pM:"wmb"}, // this is a tree that gets added when adding a page to wdn
wdn:{a:"w",b:"d",c:"n",pF:"wdn",pE:"wde",pO:"wdo",pM:"wmb"},
wln:{a:"w",b:"l",c:"n",pF:"wln",pE:"wle",pO:"wlo"},
wpn:{a:"w",b:"p",c:"n",pF:"wpn",pE:"wpe",pO:"wpo"},
zdn:{a:"z",b:"d",c:"n",pF:"zdn",pE:"zde",pO:"zdo",pM:"zmb"},
//gfn:{a:"g",b:"f",c:"n",pF:"gfn",pE:"gfe",pO:"gfo",pM:"wmb"}, maybe this can be used for the sitefolders when adding a new page to wdn
}
function bLang_InFo(){}//this is here so I can just jump to it


/*
var langX =<x>
<_AddяMe needsTranslation="yes" english="Add" translation="Add"/>
</x>
;
//
alert(langX._AddяMe.@needsTranslation);
*/
var bLang = {
en_US:{
//_carяtech:<_Add_  type="text" needsTranslation="yes" english="Add" translation="Add"/>,
__:"_",
_n_:"",
_s_:" ",
_Add:"Add",
_About:"About",
_alert0001:"This operation has been canceled. Please try again.",
_alert0002:"You forgot to put in a Name",
_alert0003:"illegal Characters! Please Try Again, and use only Letters(a-Z), Numbers(0-9), or Underscores(_) for characters.",
_alert0004:"This name is currently being used. Please retry using a different Name",
_Align:"Align",
_AlignContent:"Align-Content",
_AlignHorizontal:"Align-Horizontal",
_AlignMenuItems:"Align-Menu-Items",
_AlignVertical:"Align-Vertical",
_All:"All",
_Albums:"Albums",
_ArrowDown:"v",
_ArrowLeft:"<",
_ArrowRight:">",
_ArrowUp:"^",
_ArrowV:"v",
_Arrow01Down:"▼",
_Arrow01Left:"◀",
_Arrow01Right:"▶",
_Arrow01Up:"▲",
_Arrow01DownLT:"◣",
_Arrow01DownRH:"◢",
_Arrow01UpLT:"◤",
_Arrow01UpRT:"◥",
_Arrow02Down:"↓",
_Arrow02Left:"←",
_Arrow02Right:"→",
_Arrow02Up:"↑",
_Arrow02DownLT:"↙",
_Arrow02DownRH:"↘",
_Arrow02UpLT:"↖",
_Arrow02UpRT:"↗",
_auto:"auto",
_Auto:"Auto",
_Background:"Background",
_BeforeCrumbs:"Before-Crumbs",
_bottom:"bottom",
_BorderCorners:"Border-Corners",
_BorderImage:"Border-Image",
_Borders:"Borders",
_Bot:"Bot",
_Bottom:"Bottom",
_BottomCenter:"Bottom-Center",
_BottomLeft:"Bottom-Left",
_BottomRight:"Bottom-Right",
_Browse:"Browse",
_BtnIcons:"Btn Icons",
_Cancel:"Cancel",
_center:"center",
_Class:"Class",
_Clear:"Clear",
_ClearWbrakets:"[Clear]",
_Color:"Color",
_Copy:"Copy",
_Corners:"Corners",
_couldNotBeFound:"could not be found",
_Custom:"Custom",
_dashed:"dashed",
_Decoration:"Decoration",
_Default:"Default",
_Delete:"Delete",
_Description:"Description",
_Direction:"Direction",
_Divider:"Divider",
_Document:"Document",
_dotted:"dotted",
_double:"double",
_Dreamweaver:"Dreamweaver",
_Duplicate:"Duplicate",
_DW:"DW",
_Edit:"Edit",
_EditName:"EditName",
_Error:"Error",
_ERROR:"ERROR!", // all caps
_Export:"Export",
_File:"File",
_Folder:"Folder",
_FolderName:"Folder Name",
_Fonts:"Fonts",
_full:"full",
_General:"General",
_Get:"Get",
_gif:"gif", //file format is the same in all Langs
_groove:"groove",
_Height:"Height",
_hidden:"hidden",
_hLnk:"hLnk",
_home_s_:"home ",// always allow 5 chars
_Horizontal:"Horizontal",
_HorizontalOneLetter:"H",
_hSnp:"hSnp",// it's a abbreviation for html(h) Snipit(Snp). 
_html:"html ",// always allow 5 chars
_html_s_:"html ",// always allow 5 chars
_htm5_s_:"html ",// always allow 5 chars
_htmlSnipit:"htmlSnipit",
_hyperLink:"hyper Lnk",
_Image:"Image",
_Images:"Images",
_Import:"Import",
_inset:"inset",
_InUseQty:"InUseQty",
_JavaScripts:"JavaScripts",
_Kind:"Kind",
_LastCrumb:"Last-Crumb",
_Layout:"Layout",
_left:"left",
_Left:"Left",
_LT:"LT",
_ltr:"Left-To-Right",
_Line:"Line",
_lineHeight:"line-Height",
_lineThrough:"line-through",
_Link:"Link",
_ImageFolder:"Image-Folder",
_liquidHeight:"liquid-Height",
_liquidWidth:"liquid-Width",
_loadingPreview:"loading... Preview",
_LocationWithColon:"Location:",
_Margin:"Margin",
_MarginPadding:"Margin-Padding",
_Max:"Max",
_maxHeight:"max-Height",
_maxWidth:"max-Width",
_Menu:"Menu",
_MenuArray:"Menu Array",
_MenuArrays:"MenuArrays",
_MenuItems:"Menu-Items",
_MenuName:"Menu Name",
_message4holdPage:"Please make a selection from the Wui tools to continue. Thanks for using StackSite",
_messagepage:"messagepage",
_messagePleaseWait:"Please Wait.....",
_middle:"middle",
_MiddleCenter:"Middle-Center",
_MiddleLeft:"Middle-Left",
_MiddleRight:"Middle-Right",
_Min:"Min",
_minHeight:"min-Height",
_minWidth:"min-Width",
_Move:"Move",
_Name:"Name",
_NavDirectory:"Nav-Directory",
_NavStartLevel:"Nav-Start-Level",
_Navigation:"Navigation",
_New:"New",
_NewCustom:"New Custom", //mdn
_NewSite:"New Site", //mdn
_none:"none",
_None:"None",
_NonNumbersAreNotAllowInSizeField:"Non-Numbers are not allowed in the Size field.",
_NoneSelected:" *None Selected",
_NoneWbrakets:"[None]",
_nowrap:"No Wrap",
_Object:"Object",
_On:"On",
_onClick:"onClick",
_onHover:"onHover",
_OnOff:"OnOff",
_onPath:"onPath",
_Ok:"Ok",
_outset:"outset",
_overline:"overline",
_Padding:"Padding",
_Page:"Page",
_Pages:"Pages",
_Photos:"Photos",
_PleaseSelectAFolderToPlaceNewDuplicateIn:"Please select a folder to place new Duplicate page in:",
_PleaseSelectAFolderToPlaceNewPageIn:"Please select a folder to place new Page in:",
_Pref:"Pref",
_Pref:"Pref",
_Preview:"Preview",
_PreviewCol:"Preview:",
_Properties:"Properties",
_ReDo:"ReDo",
_reFresh:"reFresh",
_Repair:"Repair",
_Replace:"Replace",
_ridge:"ridge",
_right:"right",
_Right:"Right",
_RT:"RT",
_rtl:"Right-To-Left",
_Save:"Save",
_Scripts:"Scripts",
_sCs:" : ",
_Seperator:"Seperator",
_Settings:"Settings",
_Site:"Site",
_Sites:"Sites",
_Size:"Size",
_Snipit:"Snipit",
_SnipitItem:"Snipit-Item",
_Snipits:"Snipits",
_solid:"solid",
_SS:"SS",
_StackSite:"StackSite",
_StartingWord:"Starting-Word",
_StartMenuAtLevel:"Start-Menu-At-Level",
_Style:"Style",
_tab:"tab",
_temp:"temp",
_Templete:"Templete",
_Templetes:"Templetes",
_Text:"Text",
_ToArchive:"To Archive",
_top:"top",
_Top:"Top",
_TopCenter:"Top-Center",
_TopLeft:"Top-Left",
_TopRight:"Top-Right",
_ToTrash:"To Trash",
_transparent:"transparent",
_tubed:"tubed",
_Type:"Type",
_TypeSize:"Type: Size",
_TypeInUseQty:"Type: InUseQty",
_TypeOnOff:"Type: OnOff",
_TypeDescription:"Type: Description",
_underline:"underline",
_Underscore:"_",
_UnDo:"UnDo",
_unNamed:"unNamed",
_UntitledDocument:"Untitled Document",
_URL:"URL",
_UseMenuArray:"Use-Menu-Array",
_UseSnipit:"Use-Snipit",
_Value:"Value",
_View:"View",
_Vertical:"Vertical",
_VerticalOneLetter:"V",
_wColumns:"w/Columns",
_Width:"Width",
_Wrap:"Wrap",
_wRows:"w/Rows",
_YouAreHere:"You Are Here:",
_charArrowRht:">",
_charArrowLht:"<",
_charBlankSpace:" ", //not used
_charColon:":",
_charFwdSlash:"/",
_charPipe:"|", // not use- bc dw elements and my lib xml item use this to divide attributes
_cFile:"c.js",
_gFile:"g.css",
_iFile:"i.html",// file names will need work
_mFile:"m.html",
_nFile:"n.text",
_sFile:"s.js",
_snFile:"snipit.html",
_uFile:"u.js",
_nLink:"index.html",
//########## the follow R not used and can be removed or used for something else
// Basically I'm keeping here so I can remove them from lib node and code later.
//00001  _BackgroundBorders:"Background-Borders",
_hFile:"h.js", //not used // removing soon this was some old way of getting the hyperlink

}
};

function attribLibSettings_InFo(){}//this is here so I can just jump to it
// attributeName:["attribType","attribRtnAction","attribMissingAction","splitWith"],
var attribLibSettings = {
adNds:["string","boolean","error"],
// * adNds = "addableNodes"
// Attribute and Argument is reqiured.
//  " "= no addableNodes.
// "c"= children addableNodes only.
// "p"= parent sibling addableNodes only. In some cases siblings can also be put into a selected node as a child.
adQty:["string","error","error"],
// * adQty = "addableQty"
// Attribute and Argument is reqiured.
// "0"= It can not be added.
// "1"= It can only be added once in it's parent.
// "2"= It can be added muiltable times in it's parent.
// "u"= It can be added unlimited times as a child or a sibling to their parent.
colNvs:["array","boolean","boolean","|"],
// * colNv: Colum Values.
// " "=false
// anyvalue=[array]
colNames:["array","boolean","boolean","|"],
// * colNames: Colum Names.
// " "=false
// anyvalue=[array]
cssDefault0:["array","boolean","boolean","|"],
// * cssDefault0
//  for each cssSelectorName in an array. If blank or has the cssSelectorNames then it has none
cssProperty:["string","boolean","boolean"],//wpn
// needs to be explained
cssRequiredDefault:["string","boolean","boolean"],//wpn
// may need to be blank blank or blank boolean
cssSelectorNames:["array","boolean","boolean","|"],//wln
// * cssSelectorNames.
// These are the possible css Selector classes(.) id(#) and id(#) class(,) combinations 
cssSelectorName:["string","boolean","boolean"],//wpn
// needs to be explained
cssSelectorType:["string","blank","error","|"],//wln
// * cssSelectorType.
// "" = false, and item has no cssSelectors
// 0 = 0 (i.e. this would be the actually number 0)
// tagName = this is the name of it's tagname, and uses the cssSelectorName which is the items tagname
// namElmNum = uses the cssSelectorName + useCurrentElementNumber
// namElmParNum = useCurrentElementParentNumber
// namElmParNum+1 = useCurrentElementParent + 1
// tagNam = "" (this means it will not have a selector number, and the number will be blank, and use the elements tagname, which is in the cssSelectorNames.
dataSource:["string","blank","error"],
// * dataSource = Is where to find data on the node to get a value if needed.
dName:["string","error","blank"],
// * dName = "defaultName" Attribute and Argument is reqiured.  "_" = " "(is a blank space)
eBF:["string","error","error"],
// * eBF = element Build Function // the function used to build the element
eElms:["array","boolean","boolean","|"],
// * eElms = library elements to be used.  blank=false anyvalue=[array] 
eFN:["array","boolean","error","|"],
// it could be boolean boolean, if need be
// * eFN = element Function Name // for the new element's event
eID:["string","blank","blank"],
// * eID = element ID for the new element
// the id needs to be crafted, in a way, which allows Save Ftns to understand and use them in a name and location order type
// needs to be explained more
eSZ:["string","blank","blank"],
// Note it maybe better to use a css class or make a new attribute which adds a class attribute to the new element,
// which can apply css rules to it.
// * eSZ = element Size. The Size of the element, which depends on the type of element.
fileDups:["array","boolean","boolean","|"],
// * fileDups: when Duplicating these R the files that need to be copied. blank=false anyvalue =true
fileNames:["array","boolean","boolean","|"],
// * fileNames = ["fileNames"]  Is the names of the needed files to add this object. Attribute and Argument is not reqiured. ""=none "attribName|attribName"= [attribName,attribName] (pipe should be used for more than one.) 
fileNameTypes:["array","boolean","boolean","|"],
// * fileNameTypes:  rvw=Read,eVal and Write|rwm= Read, Write, Missing file|sge=Snipit & Get and replace code from the iFile, then Eval the sFile
id:["string","error","error"],
// * id = is the type number but on wpn and perhaps others, it gets replaced or removed when compiled.
itemCatagory:["string","blank","boolean"], // wpn // could be called itemKind
// * For wpn the choices R = page, link
mvValue:["number","error","error"], //wdn, wln
// Attribute and Argument is reqiured.
// * mvValue = moveable
// 0= it can not be moved, nor can anything move into it.
// 1= it can be moved but only into or above or below other objects with a value of 1.
// 2= it can be moved but nothing can be moved into it.
// 3 = it can only be moved up or down in it's parent's only.
nLink:["string","boolean","boolean"],//bln
// * nLink = this is the file to open in the browser. Leaving it blank would mean to open a blank
oOpts:["array","boolean","boolean","|"],
// * oOpts = ["optionLibNodes"] Is the options libray node ids, and options for the currently selected Node. Attribute and Argument is not reqiured. ""=none "id|id"= ["id"|"id"](pipe should be used for more than one.)
oSel:["string","error","error"],
// * oSel = "optionLibNodeDefault" Is the option libray node default id, and option for the currently selected Node. Attribute and Argument is reqiured. It needs to be the beginning of the option libray node's id before the q. 
pIDAN:["array","boolean","error","_"],
// I think it needs to be called something else. Maybe itemType.
// * pIDAN = property ID and number // when the var string is an array it is the array number used to find the value ie: 1_  , C= CSS straight  , C1 = uses the css value, but display a cssLang value for properties, C2= is css for content which requires quotes("") 
pIH:["string","error","error"],
// * pIH = put It Here // put the new element in this element
refSelectorPropName:["string","blank","blank"], //wpn
// I think this needs to be blank or false
refTag:["string","boolean","boolean"],
// * refTag is a way to say, use this refTag instead.  It's basically to make the libary smaller, easier, and faster to work with. Gets removed on compile.
refTagIncludes:["string","boolean","boolean"], //wpn
// * refTagIncludes = this is any additional coding and/or actions needed. The value is a function's name that needs tobe called when the property is being updated and/or resetted 
siblingIndex:["number","error","error"],//wln
sortChildren:["string","boolean","boolean"], //compile ftn
// gets removed after compile
// * sortChildren
// Attribute and Argument is optional.
// omitting the attribute or it's value will default to true.
// false= will will force this node's children not to sort.
// true= or any value will force this node's children to sort by the sortChildrenBy attribute on this node.
sortChildrenBy:["array","boolean","boolean"], //compile ftn
// gets removed after compile
// Attribute and Argument is optional.
// * sortChildrenBy = All lib Items are sorted by default, which is pre-determined by it's XML tag name. Some tag names do not get sorted by default, and this attribute would force it's children XML nodes to be sorted. It requires a value of the child attribute names in which you want them to be sorted. It sorts by the order of the attribute names you supply. More than one name needs to be divided by a pipe(|) char.
sortOrder:["number","blank","blank"], //compile ftn
// gets removed after compile
// Attribute and Argument is optional.
// * sortOrder = It's Value requires a number of 1 or higher. No 0 or negative numbers are allowed. The sort Order of numbers, is used to sort the importance of XML nodes in the lib. It can be used to make less used Lib Items to go to the bottom of a Menu or move more used Lib Items to go to the top of a Menu. The Lower the number the higher it will show in the a menu. The higher the number the lower it will show in the menu. Same numbers will sort to according to their position within the nesting.
tyDes:["string","blank","error"],
// * tyDes = "_typeDescription" Attribute and Argument is reqiured. "_" = " "(is a blank space)
tyNme:["string","error","error"],
// * tyNme = "_typeName" Attribute and Argument is reqiured.  "_" = " "(is a blank space) 
//0310 uFile:["string","boolean","boolean"],//bln //removing soon
uScripts:["array","boolean","boolean","|"],//wdn
// * uScripts = this is the scripts needed for this node object
vDPV:["number","blank","blank"],//wpn // may need to use blank here
// * vDPV= Use property values 0:Don't display but use default | 1:yes but like a option | 2:yes as a text value | 3: Display but use value | 4:borderImage Folder | 5: snipitFile | 6:yes but like a option for border images  | 7:display node but without propVal |  8:css value only | 9: Display as a word value but replace pipe(|) chars with a small L char  | 10: menuItem menuArray Folder number 
vOPT:["arrayEval","boolean","boolean",""],
// * vOPT = [a,b,c,] or [a,b,c,],[a,b,c,] is options for select menus or a button label name. For wpn it's the Proprety display values
// a= it should hold a value witch the user will see, and in many cases a value witch will references to a lang value(ie: '_Add'). 
// b= For CSS this would be the CSS property value(ie:'none'). For WGT it would likely be the wgt property value number(ie:3). For input elms this will most likely be blank or have 0;
// c= This is the sort order of importance, and requires a number. All sorting of vOPT will sort "a" first and then sort "c".
//returns:
// if blank: it will return this array: [false,0,0]
// otherwise it will return an array like this: [[a,b,c,]] or [[a,b,c,],[a,b,c,]] and etc
vOPT2:["arrayEval","boolean","boolean",""],
// Some items require a second vOPT. For example, css borders have a line type(ie solid) and size type(ie px).
// It works just like the vOPT attribute
// * vOPT2 = [a,b,c,] or [a,b,c,],[a,b,c,] is options for select menus or a button label name. For wpn it's the Proprety display values
// a= it should hold a value which the user will see, and in many cases a value witch will references to a lang value(ie: '_Add'). 
// b= For CSS this would be the CSS property value(ie:'none'). For WGT it would likely be the wgt property value number(ie:3). For input elms this will most likely be blank or have 0;
// c= This is the sort order of importance, and requires a number. All sorting of vOPT will sort "a" first and then sort "c".
//returns:
// if blank: it will return a bolean false this array: [false,0,0]
// otherwise it will return an array like this: [[a,b,c,]] or [[a,b,c,],[a,b,c,]] and etc

wordReplace:["arrayEval","boolean","boolean",""],
// So far I'm only using this on wpn css, it might be cool to use it else where.
// * wordsReplace = [a,b,c,] or [a,b,c,],[a,b,c,] is words which need to be replaced in viewiable values. In wpn this would be the correct user lang words used in css values. For example, a css border value of #CCC solid 4px would need this ['_solid','solid',0]  in it's wordReplace so it has the correct users lang when it is display to the user.
// a= it should hold a value witch the user will see, and in many cases a value witch will references to a lang value(ie: '_none'). 
// b= For CSS this would be the actually CSS property value(ie:'none').
// c= This should always be set to 0 . 
//returns:
// if blank: it will return this array: [false,0,0]
// otherwise it will return an array like this: [[a,b,c,]] or [[a,b,c,],[a,b,c,]] and etc

subTypeChildNames:["array","blank","blank","|"],//wln
// * subTypeChildNames = Name of the visual sub type Child names. Needs more explaining.
//Note: a better name maybe vSubTypeChildPreName
// In the update ftn, some treenodes will grab this info to add to the front of item names.
// For example, Row or Column will be added to the front of the name because it's parent
// node is a page item with rows. This lets all the child nodes of the page item know it's a row. The parents
// name would display page w/rows and it's children names would be row w/? Where the "?" is what ever
//  the child is, which could be a menu or row or column or content and etc. 
// If the the parent has no pre child name to use, then it will use no pre child name
// "" = ""
//_preChildName = the lang version of this preChildName
subTypeNames:["array","boolean","boolean","|"],//wln
// * subTypeNames = Name of the visual types. Needs more explaining.
vV:["string","blank","error"],
// * vV = (string) A Name, or a Add Name. Many uses.  

wgtSelectorName:["string","boolean","boolean"],//wpn
// * wgtSelectorName = It's used to find the attribute name holding the wgt value where it's value needs to go in the wln node. Basically it's the name of the Attribute on the WLN treeNode that holds the value for this wgt.
wgtSelectorNames:["array","error","error","|"],//wln
// * wgtSelectorNames = the following is the breakdown and uses for the names:
// (0)    wgtBrand  = q (this always goes in the front and must start with letters
// (1)   q1=on/off
// (2)   q1=type
// (3)   q1=objSubType
// objSubType= object sub type
// it will always start with a number which matches one of the wgtDefault attribute names. e.g.  if U put in a value of "0", it means, it's sub type is the wgtDefault0 attribute. If you use "1", and a wgtDefault1 attribute exist, then it's subtype is wgtDefault1. 
// (4)   q0= cssSectortors these will be separated by a _ underscore when it needs more then one. (NOTE no longer uniUse1 and I removed uniUse3, and shifted everything down to fill into uniUse3.) univerisalUse for the following: //NOTE maybe some uni's should be for numbers and others for textOnly
// (5)   q0= uniUse1 univerisalUse for the following:
//        q0= snipitName (actually it's the snipit folder number)
//        q0= contentName (actually it's the id number of the div on the page holding the content)

//        q0=breadcrumb menu separatorChar (> < : | ) // not used
// (6)   q0= would be the tagName ie "nav" and "a" and so on
// (7)   qborderType_11111111=borderImageSwitches_borderImageName
// (8)   q1=isItaCenterForHeightorWidth liqWidth
// (9)   q1=centerMenuObj liqHeight
// (10) q1=use menuArray 1 nArray
// (11) 1=start from menuArrayLevel at 1 nArrayLevStart
// (4 and up) q1= wgtName this is always at the end//errorhanding. Can be removed on production
wgtDefault0:["array","boolean","boolean","|"],
// * wgtDefault0= default wgt values for wgtSelectorNames the 0 is set the wgt sub_type_num 
wgtDefault1:["array","boolean","boolean","|"],
// * wgtDefault0= default wgt values for wgtSelectorNames the 1 is set the wgt sub_type_num 
wgtRuleTypes: ["array","boolean","boolean","|"],
// wgtRuleTypes = wgtTypes
// 0 =  means not to use the wgtDefault property, and use the wgtName attribute value on the node, if no value then it will be blank
// 1 = means to use the wgtDefault property 
wpnSetElm:["string","boolean","error"],//wln
// * wpnSetElm = List of all wuiPropertyNodes which can be used with this wui Layout Node. Basically it the id of the wpn lib element with a "set" tagname

//########## the follow R not used and can be removed or used for something else
// Basically I'm keeping here so I can add a attrib quickly if needed.
fileDelTypes:["array","boolean","boolean","|"],
// not used, but it could have a fileDelType trash and etc , which would makes this a string
iFile:["string","boolean","boolean"],
iUd:["number","error","error"],
nPath:["string","boolean","boolean"], // Note I think snipits can get this info from zLang needs looking into then it can be removed, but check if anything else uses it 
// * nPath =  currently it's used for snipits, Leaving it blank would means don't use.
statusNames:["array","boolean","boolean","|"],
statusNum:["array","boolean","boolean","|"],
vC:["array","boolean","boolean","|"],//wln
// * vC =  (vC is not in use anymore, but it does show what classes and events R used in wln, can be removed after development)
vCT:["string","error","error"],//wpn not being used
vI:["string","boolean","error"],//wln is used for development, which can be remove soon.
// * vI = List of all it Propreties // not being used at the moment
vDV:["string","boolean","boolean"],//wpn it's currently not being used.
// * vDV= Default value
};

function attribNodeSettings_InFo(){}//this is here so I can just jump to it 
// these R attributes that get set in element nodes. Some exist in the xml Libary without the underscores or n_ 
var attribNodeSettings = {
cat_id:["string","blank","error"],// treecontrols
css_selector_number:["number","error","error"], // I think it could use elm_num instead, but if I start using lifeTime numbers, then this will be needed
css_value:["number","error","error"],//wpn
css_selector:["string","blank","blank"],
elm_num:["number","error","error"],
error_msgs:["string","blank","blank"],//wln
hash_val:["number","error","error"],
id:["string","error","error"],
// * in_use_qty is set when selecting a site, it keep track of how many things need this in the site
in_use_qty:["number","error","error"],
dn_layouts:["string","blank","error"],
label_name:["string","blank","error"],
liq_height:["string","blank","error"],//wln
liq_width:["string","blank","error"],//wln
n_bg_border:["string","blank","error"],//wln
n_link:["string","blank","error"],
n_menus:["array","blank","error","-"],// array with a "-" spilt
n_menu_pg_num:["number","boolean","boolean"],// 
n_name:["string","blank","error"],
n_nav_dir:["string","blank","error"],//wln
n_nav_srt_lev:["string","blank","error"],//wln
n_num:["string","error","error"],
n_on_off:["string","boolean","boolean"],
rule_type:["number","error","error"],//wpn
n_scripts:["array","blank","error","-"], // array with a "-" spilt 
n_snipits:["array","blank","error","-"],  // array with a "-" spilt 
n_sub_type:["number","error","error"],
n_type_description:["string","error","error"],
n_type_name:["string","error","error"],
n_type_num:["string","blank","error"],
n_type_num_sub:["string","blank","error"],
n_type_size:["number","error","error"],
n_version:["number","error","error"],
o_sel:["string","error","error"],//treecontrols
state:["string","blank","error"],
sub_type_child_name:["string","blank","error"],//wln sub_type_name
sub_type_name:["string","blank","error"],//wln
tdn_name:["string","blank","error"],
tdn_num:["string","blank","error"],
unclicked:["string","blank","error"],//treecontrols
uni_use_1:["string","blank","error"],//wln
uni_use_2:["string","blank","error"],//wln
uni_use_3:["string","blank","error"],//wln
value:["array","boolean","boolean","|"],
viewable_value:["string","error","error"],
wgt_brand:["string","error","error"],//wln
wgt_name:["string","blank","error"],//wln
wgt_value:["number","error","error"],//wpn it has numbers but could end up having chars too. So it could end up being a string
wpn_set_elm:["string","blank","error"],//wln maybe it should be called wpn_set_elm_id
}

</script>

<script language="JavaScript" src="wuiV004/lang/en_US/index.js"></script>

</head>
<body style="display:block; margin-top:-30px; width:100%;height:100%"> 
<div style="white-space:nowrap;margin-top:0px;padding-bottom:5px;vertical-align:center">
<INPUT type="button" id="wuireload" value="reLoad" onClick="dwReload()" />
<INPUT type="button" id="wuitest1" value="compile" onClick="dwReload('compile')" />
LogFtn:<INPUT type="checkbox" id="LogFtnOverRideBtn" />
LogErr:<INPUT type="checkbox" id="LogErrOverRideBtn" checked="checked" />
<select id="openTestFileElm" onChange="openTestFile()">
<option value="" selected>V</option>
<option value="saveWuiAsBuild">saveWuiAsBuild</option>
<option value="runTestFtn">runTestFtn</option>
<option value="logfileAll">Logs(all)</option>
<option value="logfile">Logs(last)</option>
<option value="saveFileAsBuild">saveFileAsBuild</option>

</select>
</div>
<div id="vForm">
</div>
<div style="display:none" id="flushHolder"></div>
<script>
//DECRIPTION
//• this script is setUp for developing StackSite only. All code put in it gets removed from All Beta
// and public releases. All development is done first in it's english US version first. On beta and final builds
// it will create a build for each lang, and place these builds in a seprate folder.
//NOTES
//• For now I'm only building from the single file, it's to much of a pain to keep everything in a seprate files, I'll break it up, and finish this up when stacksite is almost finished. Or I'll figure something else out, which can make developing stacksite better.

//LANG FOR DEVELOPMENT OF STACKSITE 
var compileLangs = ["en_US"];

//LANG FOR DEVELOPMENT OF STACKSITE BETA AND PUBLIC VERSIONS 
// var compileLangs = ["en_US"];

var wuiShouldCompileUrl = wui.configpath+wui.versionName+"ShouldCompile.html";
//COMPILE
if(dwFileExist(wuiShouldCompileUrl)){//if1
for each(var lang in compileLangs){
if(!compileWui(lang)){logError(new Error());break;}
}
// this file is removed so it does not trigger a compile on reload If no errors ocurred during compling
if(dwFileExist(wuiShouldCompileUrl)){DWfile.remove(wuiShouldCompileUrl);}
}//if1
//LOAD PROGRAM
else{
//alert("loadProgram");
loadProgram();
}
</script>

<script>
const cssRuleSets = {
boOrHo:"*[zs*=_boOrHo]{-icab-box-orient: horizontal;-khtml-box-orient: horizontal;-moz-box-orient: horizontal;-o-box-orient: horizontal;-webkit-box-orient: horizontal;-Xbox-box-orient: horizontal;box-orient: horizontal;}",
boOrVe:"*[zs*=_boOrVe]{-icab-box-orient: vertical;-khtml-box-orient: vertical;-moz-box-orient: vertical;-o-box-orient: vertical;-webkit-box-orient: vertical;-Xbox-box-orient: vertical;box-orient: vertical;}",
boSiBo:"*[zs*=_boSiBo]{-icab-box-sizing: border-box;-khtml-box-sizing: border-box;-moz-box-sizing: border-box;-o-box-sizing: border-box;-webkit-box-sizing: border-box;Xbox-sizing: border-box;box-sizing: border-box;}",
diBo:"*[zs*=_diBo]{display: -icab-box;display: -khtml-box;display: -moz-box;display: -o-box;display: -webkit-box;display: -Xbox-box;display: box;}",
diBl:"*[zs*=_diBl]{display:block;}",
diNo:"*[zs*=_diBl]{display:none;}",
ovHi:"*[zs*=_ovHi]{overflow:hidden;}",
poAb:"*[zs*=_poAb]{position:absolute;}",
poRe:"*[zs*=_poRe]{position:relative;}",
Le0TopNeg10000:"*[zs*=Le0TopNeg10000]{left:0px;top:-10000px}",
HtWd100pcMaPaBd0:"html,body,*[zs*=_HtWd100pcMaPaBd0]{height:100%;width:100%;margin:0px;border:0px;padding:0px;}",
cuDe:"*[zs*=_cuDe]{cursor:default;}",
cuPo:"*[zs*=_cuPo]{cursor:pointer;}",
allSizesAuto:"*[zs*=_allSizesAuto]{min-height:auto;height:auto;max-height:auto;min-width:auto;width:auto;max-width:auto;}",
LeRiBo0px:"*[zs*=_LeRiBo0px]{left:0px;right:0px;bottom:0px;}",
LeRiTo0px:"*[zs*=_LeRiTo0px]{left:0px;right:0px;top:0px;}",
}

const SCHEMES = {
	http:"http://",
	https:"https://",
	file: "file://",
	ftp: "ftp://",
	gopher: "gopher://",
	mailto: "mailto://",
	news: "news://",
	nntp: "nntp://",
	rlogin: "rlogin://",
	telnet: "telnet://",
	tn3270: "tn3270://",
	wais: "wais://"
	};

</script>

<div id="qss" style="display:none">

<!-- ******************************* Library  Information ******************************* -->


<!-- ********************************************Gobal Attribute Values
* ~ = is a reference to use the value from another object. This is meant to cut down on coding. ie ~2 would mean to use object 2's value. also ~parent would mean to use the value found in the parent's attibute with the same name.
* _ = adding a underscore in front of any value in a lib attribute, will be replaced with the langauge used for this value found in bLang array.
-->
<!-- ********************************************Misc
* fileFolderName: b= border |  j= javascript | m= menu | s= snipit | t= templete | w= pages | *= user defined
* fileFolderLocal: z=stacksite folder | u=user selected above the site root folder | 0orblank= not allowed anywhere
* refLibElm is a group of single reference elements. It's basically to make the libary smaller, easier. and faster to work. 
* oEvents = is for classes that use a:hover and etc (does not work in many browsers but maybe it should be worked in someday) 
-->

<!-- ********************************************TreeControls
*********Border Directory Nodes (bdn)
q(Type)
*********Border Directory Options (bdo)
q(Type)q(Version)
*********Border Directory Elements (bde)
q(Type)
*********Border Layout Nodes (bln)
q(Type)
*********Border Layout Options (blo)
q(Type)q(Version)
*********Border Layout Elements (ble)
q(Type)
*********Scripts Directory Nodes (jdn)
q(Type)
*********JavaScripts Directory Options (jdo)
q(Type)q(Version)
*********JavaScripts Directory Elements (jde)
q(Type)
*********Menu Directory Nodes (mdn)
q(Type)
*********Menu Directory Options (mdo)
q(Type)q(Version)
*********Menu Directory Elements (mde)
q(Type)
*********Main Menu Node (mmn)
q(Type)
*********Main Menu Options (mmo)
q(Type)q(Version)
*********Main Menu Elements (mme)
q(Type)q(Version)
*********Snipit Directory Nodes (ndn)
q(Type)
*********Snipit Directory Options (ndo)
q(Type)q(Version)
*********Snipit Directory Elements (nde)
q(Type)
*********Site Directory Nodes (sdn)
q(Type)
*********Site Directory Options (sdo)
q(Type)q(Version)
*********Site Directory Elements (sde)
q(Type)
*********Templete Directory Nodes (tdn)
q(Type)
*********Templete Directory Options (tdo)
q(Type)q(Version)
*********Templete Directory Elements (tde)
q(Type)
*********Wui Directory Elements (wdn)
q(Type)
*********Wui Directory Options (wdo)
q(Type)q(Version)
*********Wui Directory Elements (wde)
q(Type)
*********Wui Layout Nodes (wln)
(q)type
*********Wui Layout Options (wlo)
q(Type)q(Version)
*********Wui Layout Elements (wle)
q(Type)
*********Wui Properties Nodes (wpn)
q(id)q(type)
*********Wui Properties Options (wpo)
q(Type)q(Version)
*********Wui Properties Elements (wpe)
q(Type)
*********User Menu Node (umn)
q(Type)q(Version)
<z id="umnq1" vV="User" tyNme="admin"  tyDes="_" mvValue="0" adQty="0" iUd="0" adNds="" oSel="0" oOpts="0q0" vI=""></z>

*********Video Directory Nodes (vdn)
q(Type)
*********Video Directory Options (vdo)
q(Type)q(Version)
*********Video Directory Elements (vde)
q(Type)
*********Video Layout Nodes (vln)
q(Type)
*********Video Layout Options (vlo)
q(Type)q(Version)
*********Video Layout Elements (vle)

-->
<!-- dreamweaver undocumented apis for cs5
//• dom.browser.getHomePage()
//• dom.browser.getURL()
//• dom.browser.getURL().isValidURI()
//• dom.browser.getWindow()
//• dom.browser.getWindow().eval(jsCode);
//• dom.browser.getWindowObj().dw = dw;
//• dom.browser.interactivityPaused
//• dom.browser.javaScriptEnabled
//•	dom.browser.openURL(newAddress);
//• dom.browser.refreshPage();
//• dom.documentType // If the user's page is dynamic (i.e., PHP, ColdFusion, ASP, JSP, etc.), 
//• dom.getDesignViewMode() it returns "editable", "live",
//* dom.getFocus() it returns 'none', html, textView, document, browser, site
//• dom.getLiveCodeEnabled()
//• dom.getLiveCodeHighlightsChanges()
//• dom.getLiveViewAutoSyncFilesOnServer()
//• dom.getLiveViewDependentsUsingServer()
//• dom.getLiveViewInspectMode() // !dom.getLiveViewInspectMode());     //not in Inspect Mode, returns live if it is on
//• dom.getLiveViewUsingServer()
//• dom.getParseMode() it returns  "html", "xml", "css", or "text" could be useful here 
// 	var docList = dw.getRelatedFiles(UseMenuNames);
//• dom.getView() it returns 'browse' 'code' 'split' 'design'
//• dom.isDesignViewUpdated()
//• dom.isLiveViewBrowsingHomeURI()
//•	dom.setDesignViewMode('live');
//• dom.setLiveViewFollowsTheNextLink(!dom.getLiveViewFollowsTheNextLink())
//• dom.showLiveViewParamatersDialog()
//• dom.synchronizeDocument()
//• dw.canSaveAllRelatedFiles()
//• dw.canShowLiveView(dom)
//• dw.closeOtherFiles()
//• dw.getActiveWindow(true).allowsEdits()
//• dw.getActiveRelatedFilePath();
//• dw.getBrowser(); // NOT sure what gets this.
//• dw.getLiveDataMode() 
//• dw.openRelatedFile(absoluteURL);
//• dw.preBL();
//• dw.refreshRelatedFiles(activeRelatedFileURL);
//• dw.setPrimaryView()
//• dw.setSplitViewOrientation();
//• dwscripts.getFileExtension(aDocURI);
//• dwscripts.getSiteRelativePath(dw.getActiveWindow().URL)
//• site.getAppURLPrefixForSite()
//• site.getCurrentServerSite()
//• site.getSiteForURL(aDocURI);
//• dw.getDocumentPath("document")
-->

<!--

function getElementAttributes(elmObj,elmAttributeNames){
// FUNCTION:
//• getElementAttributes- It gets all the element's attribute values and test if they are blank in a Document Object Model structure.
// DESCRIPTION:
//• Creates and returned an array with the element's attributes.
// ARGUMENTS:
//• elmObj(object <elemnet />)[required] Is the element object.
// RETURNS:
//• array- The array returns a list of the elmAttributeNames argument. Sample . r.id

//CREATE THE RETURN
// r is for return
// n is for node
// a is attributes
// al is for attributes length
var r = {}, n; 
r.node = n = elmObj || false;
var a = elmAttributeName;
var L = a.length;
for(var i = 0; i<al;i++){
var nme = a[i];
r[nme] = n && n.getAttribute(nme) || "";
r[nme+"IsBlank"] = notBlank(a[nme]) && true || false;
}
return r;
}

function friendly(url) {
	return url.toLowerCase() // 
	.replace(/^\s+|\s+$/g, "") // trim leading and trailing spaces
	.replace(/[_|\s]+/g, "-") // change all spaces and underscores to a hyphen
	.replace(/[^a-zF0-9-\/]+/g, "") // remove non alpha, digit, '-', '/' chars
	.replace(/[-]+/g, "-") // replace multiple hyphens with one
	.replace(/^-+|-+$/g, ""); // trim leading and trailing hyphens
}

-->
</div>
</body>
</html>